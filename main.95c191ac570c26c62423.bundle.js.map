{"version":3,"file":"main.95c191ac570c26c62423.bundle.js","mappings":"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","sources":["webpack://tweb/webpack/runtime/chunk loaded","webpack://tweb/webpack/runtime/create fake namespace object","webpack://tweb/webpack/runtime/load script","webpack://tweb/webpack/runtime/compat","webpack://tweb/./node_modules/react/cjs/react.production.min.js","webpack://tweb/./node_modules/react/index.js","webpack://tweb/./node_modules/scheduler/cjs/scheduler.production.min.js","webpack://tweb/./node_modules/scheduler/index.js","webpack://tweb/./src/config/state.ts","webpack://tweb/./src/helpers/getTimeFormat.ts","webpack://tweb/./src/environment/appleMx.ts","webpack://tweb/./src/environment/callSupport.ts","webpack://tweb/./src/environment/canUseTransferables.ts","webpack://tweb/./src/environment/canvasFilterSupport.ts","webpack://tweb/./src/environment/emojiSupport.ts","webpack://tweb/./src/environment/geolocationSupport.ts","webpack://tweb/./src/environment/groupCallSupport.ts","webpack://tweb/./src/environment/imageMimeTypesSupport.ts","webpack://tweb/./src/environment/mediaMimeTypesSupport.ts","webpack://tweb/./src/environment/movSupport.ts","webpack://tweb/./src/environment/opusSupport.ts","webpack://tweb/./src/environment/parallaxSupport.ts","webpack://tweb/./src/environment/screenSharingSupport.ts","webpack://tweb/./src/environment/sharedWorkerSupport.ts","webpack://tweb/./src/environment/touchSupport.ts","webpack://tweb/./src/environment/userAgent.ts","webpack://tweb/./src/environment/vibrateSupport.ts","webpack://tweb/./src/environment/videoMimeTypesSupport.ts","webpack://tweb/./src/environment/webmSupport.ts","webpack://tweb/./src/environment/webpSupport.ts","webpack://tweb/./src/environment/webrtcSupport.ts","webpack://tweb/./src/helpers/color.ts","webpack://tweb/./src/helpers/compareVersion.ts","webpack://tweb/./src/helpers/dom/blurActiveElement.ts","webpack://tweb/./src/helpers/dom/cancelEvent.ts","webpack://tweb/./src/helpers/dom/findUpClassName.ts","webpack://tweb/./src/helpers/dom/fixSafariStickyInput.ts","webpack://tweb/./src/helpers/dom/fixSafariStickyInputFocusing.ts","webpack://tweb/./src/helpers/dom/loadFonts.ts","webpack://tweb/./src/helpers/idleController.ts","webpack://tweb/./src/helpers/overlayCounter.ts","webpack://tweb/./src/helpers/schedulers.ts","webpack://tweb/./src/helpers/string/parseUriParams.ts","webpack://tweb/./src/helpers/themeController.ts","webpack://tweb/./src/helpers/setWorkerProxy.ts","webpack://tweb/./src/index.ts","webpack://tweb/./src/helpers/dom/toggleAttributePolyfill.ts","webpack://tweb/./src/lib/appManagers/appRuntimeManager.ts","webpack://tweb/./src/lib/appManagers/getProxiedManagers.ts","webpack://tweb/./src/lib/files/idb.ts","webpack://tweb/./src/lib/langPack.ts","webpack://tweb/./src/lib/mtproto/mtproto_config.ts","webpack://tweb/./src/environment/index.ts","webpack://tweb/./src/lib/appManagers/utils/state/loadState.ts","webpack://tweb/./src/lib/mtproto/mtprotoworker.ts","webpack://tweb/./src/lib/mtproto/singleInstance.ts","webpack://tweb/./src/lib/mtproto/telegramMeWebManager.ts","webpack://tweb/./src/helpers/dom/loadScript.ts","webpack://tweb/./src/lib/mtproto/webPushApiManager.ts","webpack://tweb/./src/lib/opusDecodeController.ts","webpack://tweb/./src/lib/richTextProcessor/index.ts","webpack://tweb/./src/lib/rootScope.ts","webpack://tweb/./src/lib/webp/webpWorkerController.ts","webpack://tweb/webpack/bootstrap","webpack://tweb/webpack/runtime/compat get default export","webpack://tweb/webpack/runtime/define property getters","webpack://tweb/webpack/runtime/ensure chunk","webpack://tweb/webpack/runtime/get javascript chunk filename","webpack://tweb/webpack/runtime/get mini-css chunk filename","webpack://tweb/webpack/runtime/global","webpack://tweb/webpack/runtime/hasOwnProperty shorthand","webpack://tweb/webpack/runtime/make namespace object","webpack://tweb/webpack/runtime/publicPath","webpack://tweb/webpack/runtime/jsonp chunk loading","webpack://tweb/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"tweb:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","(() => {\n  if (typeof __webpack_require__ !== 'undefined') {\n    var oldGetScript = __webpack_require__.u;\n    var oldLoadScript = __webpack_require__.e;\n    var queryMap = new Map();\n    var countMap = new Map();\n    __webpack_require__.u = function (chunkId) {\n      var result = oldGetScript(chunkId);\n      return (\n        result + (queryMap.has(chunkId) ? '?' + queryMap.get(chunkId) : '')\n      );\n    };\n    __webpack_require__.e = function (chunkId) {\n      var result = oldLoadScript(chunkId);\n      return result.catch(function (error) {\n        var retries = countMap.has(chunkId) ? countMap.get(chunkId) : 999999;\n        if (retries < 1) {\n          var realSrc = oldGetScript(chunkId);\n          error.message =\n            'Loading chunk ' +\n            chunkId +\n            ' failed after 999999 retries.\\n(' +\n            realSrc +\n            ')';\n          error.request = realSrc;\n          throw error;\n        }\n        return new Promise(function (resolve) {\n          setTimeout(function () {\n            var retryAttempt = 999999 - retries + 1;\n            var retryAttemptString = '&retry-attempt=' + retryAttempt;\n            var cacheBust = (function () {\n              return Date.now();\n            })();\n            +retryAttemptString;\n            queryMap.set(chunkId, cacheBust);\n            countMap.set(chunkId, retries - 1);\n            resolve(__webpack_require__.e(chunkId));\n          }, 3000);\n        });\n      });\n    };\n  }\n})();\n","/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=Symbol.for(\"react.element\"),n=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),q=Symbol.for(\"react.strict_mode\"),r=Symbol.for(\"react.profiler\"),t=Symbol.for(\"react.provider\"),u=Symbol.for(\"react.context\"),v=Symbol.for(\"react.forward_ref\"),w=Symbol.for(\"react.suspense\"),x=Symbol.for(\"react.memo\"),y=Symbol.for(\"react.lazy\"),z=Symbol.iterator;function A(a){if(null===a||\"object\"!==typeof a)return null;a=z&&a[z]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nvar B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function E(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}E.prototype.isReactComponent={};\nE.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,a,b,\"setState\")};E.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function F(){}F.prototype=E.prototype;function G(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}var H=G.prototype=new F;\nH.constructor=G;C(H,E.prototype);H.isPureReactComponent=!0;var I=Array.isArray,J=Object.prototype.hasOwnProperty,K={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};\nfunction M(a,b,e){var d,c={},k=null,h=null;if(null!=b)for(d in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)J.call(b,d)&&!L.hasOwnProperty(d)&&(c[d]=b[d]);var g=arguments.length-2;if(1===g)c.children=e;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];c.children=f}if(a&&a.defaultProps)for(d in g=a.defaultProps,g)void 0===c[d]&&(c[d]=g[d]);return{$$typeof:l,type:a,key:k,ref:h,props:c,_owner:K.current}}\nfunction N(a,b){return{$$typeof:l,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===l}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g;function Q(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction R(a,b,e,d,c){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case l:case n:h=!0}}if(h)return h=a,c=c(h),a=\"\"===d?\".\"+Q(h,0):d,I(c)?(e=\"\",null!=a&&(e=a.replace(P,\"$&/\")+\"/\"),R(c,b,e,\"\",function(a){return a})):null!=c&&(O(c)&&(c=N(c,e+(!c.key||h&&h.key===c.key?\"\":(\"\"+c.key).replace(P,\"$&/\")+\"/\")+a)),b.push(c)),1;h=0;d=\"\"===d?\".\":d+\":\";if(I(a))for(var g=0;g<a.length;g++){k=\na[g];var f=d+Q(k,g);h+=R(k,b,e,f,c)}else if(f=A(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=d+Q(k,g++),h+=R(k,b,e,f,c);else if(\"object\"===k)throw b=String(a),Error(\"Objects are not valid as a React child (found: \"+(\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b)+\"). If you meant to render a collection of children, use an array instead.\");return h}\nfunction S(a,b,e){if(null==a)return a;var d=[],c=0;R(a,d,\"\",\"\",function(a){return b.call(e,a,c++)});return d}function T(a){if(-1===a._status){var b=a._result;b=b();b.then(function(b){if(0===a._status||-1===a._status)a._status=1,a._result=b},function(b){if(0===a._status||-1===a._status)a._status=2,a._result=b});-1===a._status&&(a._status=0,a._result=b)}if(1===a._status)return a._result.default;throw a._result;}\nvar U={current:null},V={transition:null},W={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:V,ReactCurrentOwner:K};exports.Children={map:S,forEach:function(a,b,e){S(a,function(){b.apply(this,arguments)},e)},count:function(a){var b=0;S(a,function(){b++});return b},toArray:function(a){return S(a,function(a){return a})||[]},only:function(a){if(!O(a))throw Error(\"React.Children.only expected to receive a single React element child.\");return a}};exports.Component=E;exports.Fragment=p;\nexports.Profiler=r;exports.PureComponent=G;exports.StrictMode=q;exports.Suspense=w;exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W;\nexports.cloneElement=function(a,b,e){if(null===a||void 0===a)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+a+\".\");var d=C({},a.props),c=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=K.current);void 0!==b.key&&(c=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)J.call(b,f)&&!L.hasOwnProperty(f)&&(d[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){g=Array(f);\nfor(var m=0;m<f;m++)g[m]=arguments[m+2];d.children=g}return{$$typeof:l,type:a.type,key:c,ref:k,props:d,_owner:h}};exports.createContext=function(a){a={$$typeof:u,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};a.Provider={$$typeof:t,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};\nexports.forwardRef=function(a){return{$$typeof:v,render:a}};exports.isValidElement=O;exports.lazy=function(a){return{$$typeof:y,_payload:{_status:-1,_result:a},_init:T}};exports.memo=function(a,b){return{$$typeof:x,type:a,compare:void 0===b?null:b}};exports.startTransition=function(a){var b=V.transition;V.transition={};try{a()}finally{V.transition=b}};exports.unstable_act=function(){throw Error(\"act(...) is not supported in production builds of React.\");};\nexports.useCallback=function(a,b){return U.current.useCallback(a,b)};exports.useContext=function(a){return U.current.useContext(a)};exports.useDebugValue=function(){};exports.useDeferredValue=function(a){return U.current.useDeferredValue(a)};exports.useEffect=function(a,b){return U.current.useEffect(a,b)};exports.useId=function(){return U.current.useId()};exports.useImperativeHandle=function(a,b,e){return U.current.useImperativeHandle(a,b,e)};\nexports.useInsertionEffect=function(a,b){return U.current.useInsertionEffect(a,b)};exports.useLayoutEffect=function(a,b){return U.current.useLayoutEffect(a,b)};exports.useMemo=function(a,b){return U.current.useMemo(a,b)};exports.useReducer=function(a,b,e){return U.current.useReducer(a,b,e)};exports.useRef=function(a){return U.current.useRef(a)};exports.useState=function(a){return U.current.useState(a)};exports.useSyncExternalStore=function(a,b,e){return U.current.useSyncExternalStore(a,b,e)};\nexports.useTransition=function(){return U.current.useTransition()};exports.version=\"18.2.0\";\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';function f(a,b){var c=a.length;a.push(b);a:for(;0<c;){var d=c-1>>>1,e=a[d];if(0<g(e,b))a[d]=b,a[c]=e,c=d;else break a}}function h(a){return 0===a.length?null:a[0]}function k(a){if(0===a.length)return null;var b=a[0],c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length,w=e>>>1;d<w;){var m=2*(d+1)-1,C=a[m],n=m+1,x=a[n];if(0>g(C,c))n<e&&0>g(x,C)?(a[d]=x,a[n]=c,d=n):(a[d]=C,a[m]=c,d=m);else if(n<e&&0>g(x,c))a[d]=x,a[n]=c,d=n;else break a}}return b}\nfunction g(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}if(\"object\"===typeof performance&&\"function\"===typeof performance.now){var l=performance;exports.unstable_now=function(){return l.now()}}else{var p=Date,q=p.now();exports.unstable_now=function(){return p.now()-q}}var r=[],t=[],u=1,v=null,y=3,z=!1,A=!1,B=!1,D=\"function\"===typeof setTimeout?setTimeout:null,E=\"function\"===typeof clearTimeout?clearTimeout:null,F=\"undefined\"!==typeof setImmediate?setImmediate:null;\n\"undefined\"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(a){for(var b=h(t);null!==b;){if(null===b.callback)k(t);else if(b.startTime<=a)k(t),b.sortIndex=b.expirationTime,f(r,b);else break;b=h(t)}}function H(a){B=!1;G(a);if(!A)if(null!==h(r))A=!0,I(J);else{var b=h(t);null!==b&&K(H,b.startTime-a)}}\nfunction J(a,b){A=!1;B&&(B=!1,E(L),L=-1);z=!0;var c=y;try{G(b);for(v=h(r);null!==v&&(!(v.expirationTime>b)||a&&!M());){var d=v.callback;if(\"function\"===typeof d){v.callback=null;y=v.priorityLevel;var e=d(v.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?v.callback=e:v===h(r)&&k(r);G(b)}else k(r);v=h(r)}if(null!==v)var w=!0;else{var m=h(t);null!==m&&K(H,m.startTime-b);w=!1}return w}finally{v=null,y=c,z=!1}}var N=!1,O=null,L=-1,P=5,Q=-1;\nfunction M(){return exports.unstable_now()-Q<P?!1:!0}function R(){if(null!==O){var a=exports.unstable_now();Q=a;var b=!0;try{b=O(!0,a)}finally{b?S():(N=!1,O=null)}}else N=!1}var S;if(\"function\"===typeof F)S=function(){F(R)};else if(\"undefined\"!==typeof MessageChannel){var T=new MessageChannel,U=T.port2;T.port1.onmessage=R;S=function(){U.postMessage(null)}}else S=function(){D(R,0)};function I(a){O=a;N||(N=!0,S())}function K(a,b){L=D(function(){a(exports.unstable_now())},b)}\nexports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){A||z||(A=!0,I(J))};\nexports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):P=0<a?Math.floor(1E3/a):5};exports.unstable_getCurrentPriorityLevel=function(){return y};exports.unstable_getFirstCallbackNode=function(){return h(r)};exports.unstable_next=function(a){switch(y){case 1:case 2:case 3:var b=3;break;default:b=y}var c=y;y=b;try{return a()}finally{y=c}};exports.unstable_pauseExecution=function(){};\nexports.unstable_requestPaint=function(){};exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=y;y=a;try{return b()}finally{y=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();\"object\"===typeof c&&null!==c?(c=c.delay,c=\"number\"===typeof c&&0<c?d+c:d):c=d;switch(a){case 1:var e=-1;break;case 2:e=250;break;case 5:e=1073741823;break;case 4:e=1E4;break;default:e=5E3}e=c+e;a={id:u++,callback:b,priorityLevel:a,startTime:c,expirationTime:e,sortIndex:-1};c>d?(a.sortIndex=c,f(t,a),null===h(r)&&a===h(t)&&(B?(E(L),L=-1):B=!0,K(H,c-d))):(a.sortIndex=e,f(r,a),A||z||(A=!0,I(J)));return a};\nexports.unstable_shouldYield=M;exports.unstable_wrapCallback=function(a){var b=y;return function(){var c=y;y=b;try{return a.apply(this,arguments)}finally{y=c}}};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {AppMediaPlaybackController} from '../components/appMediaPlaybackController';\r\nimport {IS_MOBILE} from '../environment/userAgent';\r\nimport getTimeFormat from '../helpers/getTimeFormat';\r\nimport {nextRandomUint} from '../helpers/random';\r\nimport {AutoDownloadSettings, NotifyPeer, PeerNotifySettings} from '../layer';\r\nimport {TopPeerType, MyTopPeer} from '../lib/appManagers/appUsersManager';\r\nimport DialogsStorage from '../lib/storages/dialogs';\r\nimport FiltersStorage from '../lib/storages/filters';\r\nimport {AuthState} from '../types';\r\nimport App from './app';\r\n\r\nconst STATE_VERSION = App.version;\r\nconst BUILD = App.build;\r\n\r\nexport type Background = {\r\n  type?: 'color' | 'image' | 'default', // ! DEPRECATED\r\n  blur: boolean,\r\n  highlightningColor?: string,\r\n  color?: string,\r\n  slug?: string,        // image slug\r\n  intensity?: number,   // pattern intensity\r\n  id: string | number,  // wallpaper id\r\n};\r\n\r\nexport type Theme = {\r\n  name: 'day' | 'night' | 'system',\r\n  background: Background\r\n};\r\n\r\nexport type AutoDownloadPeerTypeSettings = {\r\n  contacts: boolean,\r\n  private: boolean,\r\n  groups: boolean,\r\n  channels: boolean\r\n};\r\n\r\nexport type State = {\r\n  allDialogsLoaded: DialogsStorage['allDialogsLoaded'],\r\n  pinnedOrders: DialogsStorage['pinnedOrders'],\r\n  // contactsList: UserId[],\r\n  contactsListCachedTime: number,\r\n  updates: Partial<{\r\n    seq: number,\r\n    pts: number,\r\n    date: number\r\n  }>,\r\n  // filters?: FiltersStorage['filters'], // ! DEPRECATED\r\n  filtersArr?: FiltersStorage['filtersArr'],\r\n  maxSeenMsgId: number,\r\n  stateCreatedTime: number,\r\n  recentEmoji: string[],\r\n  recentCustomEmoji: DocId[],\r\n  topPeersCache: {\r\n    [type in TopPeerType]?: {\r\n      peers: MyTopPeer[],\r\n      cachedTime: number\r\n    }\r\n  },\r\n  recentSearch: PeerId[],\r\n  version: typeof STATE_VERSION,\r\n  build: typeof BUILD,\r\n  authState: AuthState,\r\n  hiddenPinnedMessages: {[peerId: PeerId]: number},\r\n  settings: {\r\n    messagesTextSize: number,\r\n    distanceUnit: 'kilometers' | 'miles',\r\n    sendShortcut: 'enter' | 'ctrlEnter',\r\n    animationsEnabled: boolean,\r\n    autoDownload: {\r\n      contacts?: boolean, // ! DEPRECATED\r\n      private?: boolean, // ! DEPRECATED\r\n      groups?: boolean, // ! DEPRECATED\r\n      channels?: boolean, // ! DEPRECATED\r\n      photo: AutoDownloadPeerTypeSettings,\r\n      video: AutoDownloadPeerTypeSettings,\r\n      file: AutoDownloadPeerTypeSettings\r\n    },\r\n    autoDownloadNew: AutoDownloadSettings,\r\n    autoPlay: {\r\n      gifs: boolean,\r\n      videos: boolean\r\n    },\r\n    stickers: {\r\n      suggest: boolean,\r\n      loop: boolean\r\n    },\r\n    emoji: {\r\n      suggest: boolean,\r\n      big: boolean\r\n    },\r\n    background?: Background, // ! DEPRECATED\r\n    themes: Theme[],\r\n    theme: Theme['name'],\r\n    notifications: {\r\n      sound: boolean\r\n    },\r\n    nightTheme?: boolean, // ! DEPRECATED\r\n    timeFormat: 'h12' | 'h23'\r\n  },\r\n  playbackParams: ReturnType<AppMediaPlaybackController['getPlaybackParams']>,\r\n  keepSigned: boolean,\r\n  chatContextMenuHintWasShown: boolean,\r\n  stateId: number,\r\n  notifySettings: {[k in Exclude<NotifyPeer['_'], 'notifyPeer'>]?: PeerNotifySettings.peerNotifySettings}\r\n};\r\n\r\nconst BACKGROUND_DAY_DESKTOP: Background = {\r\n  blur: false,\r\n  slug: 'pattern',\r\n  color: '#dbddbb,#6ba587,#d5d88d,#88b884',\r\n  highlightningColor: 'hsla(86.4, 43.846153%, 45.117647%, .4)',\r\n  intensity: 50,\r\n  id: '1'\r\n};\r\n\r\nconst BACKGROUND_DAY_MOBILE: Background = {\r\n  blur: false,\r\n  slug: '',\r\n  color: '#dbddbb,#6ba587,#d5d88d,#88b884',\r\n  highlightningColor: 'hsla(86.4, 43.846153%, 45.117647%, .4)',\r\n  intensity: 0,\r\n  id: '1'\r\n};\r\n\r\nconst BACKGROUND_NIGHT_DESKTOP: Background = {\r\n  blur: false,\r\n  slug: 'pattern',\r\n  // color: '#dbddbb,#6ba587,#d5d88d,#88b884',\r\n  color: '#fec496,#dd6cb9,#962fbf,#4f5bd5',\r\n  highlightningColor: 'hsla(299.142857, 44.166666%, 37.470588%, .4)',\r\n  intensity: -50,\r\n  id: '-1'\r\n};\r\n\r\nconst BACKGROUND_NIGHT_MOBILE: Background = {\r\n  blur: false,\r\n  slug: '',\r\n  color: '#0f0f0f',\r\n  highlightningColor: 'hsla(0, 0%, 3.82353%, 0.4)',\r\n  intensity: 0,\r\n  id: '-1'\r\n};\r\n\r\nexport const STATE_INIT: State = {\r\n  allDialogsLoaded: {},\r\n  pinnedOrders: {},\r\n  // contactsList: [],\r\n  contactsListCachedTime: 0,\r\n  updates: {},\r\n  filtersArr: [],\r\n  maxSeenMsgId: 0,\r\n  stateCreatedTime: Date.now(),\r\n  recentEmoji: [],\r\n  recentCustomEmoji: [],\r\n  topPeersCache: {},\r\n  recentSearch: [],\r\n  version: STATE_VERSION,\r\n  build: BUILD,\r\n  authState: {\r\n    _: IS_MOBILE ? 'authStateSignIn' : 'authStateSignQr'\r\n  },\r\n  hiddenPinnedMessages: {},\r\n  settings: {\r\n    messagesTextSize: 16,\r\n    distanceUnit: 'kilometers',\r\n    sendShortcut: 'enter',\r\n    animationsEnabled: true,\r\n    autoDownload: {\r\n      photo: {\r\n        contacts: true,\r\n        private: true,\r\n        groups: true,\r\n        channels: true\r\n      },\r\n      video: {\r\n        contacts: true,\r\n        private: true,\r\n        groups: true,\r\n        channels: true\r\n      },\r\n      file: {\r\n        contacts: true,\r\n        private: true,\r\n        groups: true,\r\n        channels: true\r\n      }\r\n    },\r\n    autoDownloadNew: {\r\n      _: 'autoDownloadSettings',\r\n      file_size_max: 3145728,\r\n      pFlags: {\r\n        video_preload_large: true,\r\n        audio_preload_next: true\r\n      },\r\n      photo_size_max: 1048576,\r\n      video_size_max: 15728640,\r\n      video_upload_maxbitrate: 100\r\n    },\r\n    autoPlay: {\r\n      gifs: true,\r\n      videos: true\r\n    },\r\n    stickers: {\r\n      suggest: true,\r\n      loop: true\r\n    },\r\n    emoji: {\r\n      suggest: true,\r\n      big: true\r\n    },\r\n    themes: [{\r\n      name: 'day',\r\n      background: IS_MOBILE ? BACKGROUND_DAY_MOBILE : BACKGROUND_DAY_DESKTOP\r\n    }, {\r\n      name: 'night',\r\n      background: IS_MOBILE ? BACKGROUND_NIGHT_MOBILE : BACKGROUND_NIGHT_DESKTOP\r\n    }],\r\n    theme: 'day',\r\n    notifications: {\r\n      sound: false\r\n    },\r\n    timeFormat: getTimeFormat()\r\n  },\r\n  playbackParams: {\r\n    volume: 1,\r\n    muted: false,\r\n    playbackRate: 1,\r\n    playbackRates: {\r\n      voice: 1,\r\n      video: 1,\r\n      audio: 1\r\n    },\r\n    loop: false,\r\n    round: false\r\n  },\r\n  keepSigned: true,\r\n  chatContextMenuHintWasShown: false,\r\n  stateId: nextRandomUint(32),\r\n  notifySettings: {}\r\n};\r\n","export default function getTimeFormat(): 'h12' | 'h23' {\r\n  // try {\r\n  //   const resolvedOptions = Intl.DateTimeFormat(navigator.language,  {hour: 'numeric'}).resolvedOptions();\r\n  //   if('hourCycle' in resolvedOptions) {\r\n  //     return (resolvedOptions as any).hourCycle === 'h12' ? 'h12' : 'h23';\r\n  //   } else {\r\n  //     return resolvedOptions.hour12 ? 'h12' : 'h23';\r\n  //   }\r\n  // } catch(err) {\r\n  return new Date().toLocaleString().match(/\\s(AM|PM)/) ? 'h12' : 'h23';\r\n  // }\r\n}\r\n","let IS_APPLE_MX = false;\r\n\r\ntry {\r\n  // Awesome detect from https://stackoverflow.com/a/65412357\r\n  const ctx = document.createElement('canvas').getContext('webgl');\r\n  const extension = ctx.getExtension('WEBGL_debug_renderer_info');\r\n  const renderer: string = extension && ctx.getParameter(extension.UNMASKED_RENDERER_WEBGL) || '';\r\n  if((renderer.match(/Apple/) && !renderer.match(/Apple GPU/)) ||\r\n    ctx.getSupportedExtensions().indexOf('WEBGL_compressed_texture_s3tc_srgb') === -1) {\r\n    IS_APPLE_MX = true;\r\n  }\r\n} catch(err) {\r\n\r\n}\r\n\r\nexport default IS_APPLE_MX;\r\n","import IS_WEBRTC_SUPPORTED from './webrtcSupport';\r\n\r\nconst IS_CALL_SUPPORTED = IS_WEBRTC_SUPPORTED;\r\n\r\nexport default IS_CALL_SUPPORTED;\r\n","import {IS_SAFARI} from './userAgent';\r\n\r\n/*\r\n * This is used as a workaround for a memory leak in Safari caused by using Transferable objects to\r\n * transfer data between WebWorkers and the main thread.\r\n * https://github.com/mapbox/mapbox-gl-js/issues/8771\r\n *\r\n * This should be removed once the underlying Safari issue is fixed.\r\n */\r\n\r\nlet CAN_USE_TRANSFERABLES: boolean;\r\nif(!IS_SAFARI) CAN_USE_TRANSFERABLES = true;\r\nelse {\r\n  try {\r\n    const match = navigator.userAgent.match(/Version\\/(.+?) /);\r\n    CAN_USE_TRANSFERABLES = +match[1] >= 14;\r\n  } catch(err) {\r\n    CAN_USE_TRANSFERABLES = false;\r\n  }\r\n}\r\n\r\nexport default CAN_USE_TRANSFERABLES;\r\n","const IS_CANVAS_FILTER_SUPPORTED = 'filter' in (document.createElement('canvas').getContext('2d') || {});\r\n\r\nexport default IS_CANVAS_FILTER_SUPPORTED;\r\n","const IS_EMOJI_SUPPORTED = navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i) !== -1/*  && false *//*  || true */;\r\n\r\nexport default IS_EMOJI_SUPPORTED;\r\n","const IS_GEOLOCATION_SUPPORTED = !!navigator?.geolocation?.getCurrentPosition && false;\r\n\r\nexport default IS_GEOLOCATION_SUPPORTED;\r\n","import IS_WEBRTC_SUPPORTED from './webrtcSupport';\r\n\r\nconst IS_GROUP_CALL_SUPPORTED = IS_WEBRTC_SUPPORTED;\r\n\r\nexport default IS_GROUP_CALL_SUPPORTED;\r\n","import IS_WEBP_SUPPORTED from './webpSupport';\r\n\r\nconst IMAGE_MIME_TYPES_SUPPORTED = new Set([\r\n  'image/jpeg',\r\n  'image/png',\r\n  'image/bmp'\r\n]);\r\n\r\nif(IS_WEBP_SUPPORTED) {\r\n  IMAGE_MIME_TYPES_SUPPORTED.add('image/webp');\r\n}\r\n\r\nexport default IMAGE_MIME_TYPES_SUPPORTED;\r\n","import IMAGE_MIME_TYPES_SUPPORTED from './imageMimeTypesSupport';\r\nimport VIDEO_MIME_TYPES_SUPPORTED from './videoMimeTypesSupport';\r\n\r\nconst arr = [...IMAGE_MIME_TYPES_SUPPORTED].concat([...VIDEO_MIME_TYPES_SUPPORTED]);\r\n\r\nconst MEDIA_MIME_TYPES_SUPPORTED = new Set(arr);\r\n\r\nexport default MEDIA_MIME_TYPES_SUPPORTED;\r\n","import {IS_APPLE_MOBILE, IS_SAFARI} from './userAgent';\r\n\r\n// mov is not supported in Chrome on macOS\r\nconst IS_MOV_SUPPORTED = !!document.createElement('video').canPlayType('video/quicktime') || IS_SAFARI || IS_APPLE_MOBILE;\r\n\r\nexport default IS_MOV_SUPPORTED;\r\n","const audio = document.createElement('audio');\r\nconst IS_OPUS_SUPPORTED = !!(audio.canPlayType && audio.canPlayType('audio/ogg;').replace(/no/, ''))/*  && false */;\r\n\r\nexport default IS_OPUS_SUPPORTED;\r\n","import {IS_FIREFOX} from './userAgent';\r\n\r\nconst IS_PARALLAX_SUPPORTED = !IS_FIREFOX && false;\r\n\r\nexport default IS_PARALLAX_SUPPORTED;\r\n","const IS_SCREEN_SHARING_SUPPORTED = !!('getDisplayMedia' in (navigator?.mediaDevices || {}));\r\n\r\nexport default IS_SCREEN_SHARING_SUPPORTED;\r\n","const IS_SHARED_WORKER_SUPPORTED = typeof(SharedWorker) !== 'undefined'/*  && false */;\r\n\r\nexport default IS_SHARED_WORKER_SUPPORTED;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\n// @ts-ignore\r\nconst IS_TOUCH_SUPPORTED = ('ontouchstart' in window) || (window.DocumentTouch && document instanceof DocumentTouch)/*  || true */;\r\nexport default IS_TOUCH_SUPPORTED;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport ctx from './ctx';\r\n\r\nexport const USER_AGENT = navigator ? navigator.userAgent : null;\r\nexport const IS_APPLE = navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i) !== -1;\r\nexport const IS_ANDROID = navigator.userAgent.toLowerCase().indexOf('android') !== -1;\r\nexport const IS_CHROMIUM = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n\r\n// https://stackoverflow.com/a/58065241\r\nexport const IS_APPLE_MOBILE = (/iPad|iPhone|iPod/.test(navigator.platform) ||\r\n  (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) &&\r\n  !(ctx as any).MSStream;\r\n\r\nexport const IS_SAFARI = !!('safari' in ctx) || !!(USER_AGENT && (/\\b(iPad|iPhone|iPod)\\b/.test(USER_AGENT) || (!!USER_AGENT.match('Safari') && !USER_AGENT.match('Chrome'))))/*  || true */;\r\nexport const IS_FIREFOX = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\r\n\r\nexport const IS_MOBILE_SAFARI = IS_SAFARI && IS_APPLE_MOBILE;\r\n\r\nexport const IS_MOBILE = /* screen.width && screen.width < 480 ||  */navigator.maxTouchPoints > 0 && navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i) != -1;\r\n","const IS_VIBRATE_SUPPORTED = !!navigator?.vibrate;\r\n\r\nexport default IS_VIBRATE_SUPPORTED;\r\n","import IS_MOV_SUPPORTED from './movSupport';\r\n\r\nconst VIDEO_MIME_TYPES_SUPPORTED = new Set([\r\n  'image/gif', // have to display it as video\r\n  'video/mp4',\r\n  'video/webm'\r\n]);\r\n\r\nif(IS_MOV_SUPPORTED) {\r\n  VIDEO_MIME_TYPES_SUPPORTED.add('video/quicktime');\r\n}\r\n\r\nexport default VIDEO_MIME_TYPES_SUPPORTED;\r\n","import {IS_APPLE_MOBILE, IS_SAFARI} from './userAgent';\r\n\r\nconst IS_WEBM_SUPPORTED = !!document.createElement('video').canPlayType('video/webm') && !IS_SAFARI && !IS_APPLE_MOBILE;\r\n\r\nexport default IS_WEBM_SUPPORTED;\r\n","const IS_WEBP_SUPPORTED = document.createElement('canvas').toDataURL('image/webp').startsWith('data:image/webp');\r\n\r\nexport default IS_WEBP_SUPPORTED;\r\n","import {IS_FIREFOX} from './userAgent';\r\n\r\nconst IS_WEBRTC_SUPPORTED = !!(typeof(RTCPeerConnection) !== 'undefined' && !IS_FIREFOX);\r\n\r\nexport default IS_WEBRTC_SUPPORTED;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport type ColorHsla = {\r\n  h: number,\r\n  s: number,\r\n  l: number,\r\n  a: number\r\n};\r\n\r\nexport type ColorRgba = [number, number, number, number];\r\nexport type ColorRgb = [number, number, number];\r\n\r\n/**\r\n * @returns h [0, 360], s [0, 100], l [0, 100], a [0, 1]\r\n */\r\nexport function rgbaToHsla(r: number, g: number, b: number, a: number = 1): ColorHsla {\r\n  r /= 255, g /= 255, b /= 255;\r\n  const max = Math.max(r, g, b),\r\n    min = Math.min(r, g, b);\r\n  let h: number, s: number;\r\n  const l = (max + min) / 2;\r\n\r\n  if(max === min) {\r\n    h = s = 0; // achromatic\r\n  } else {\r\n    const d = max - min;\r\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n    switch(max) {\r\n      case r:\r\n        h = (g - b) / d + (g < b ? 6 : 0);\r\n        break;\r\n      case g:\r\n        h = (b - r) / d + 2;\r\n        break;\r\n      case b:\r\n        h = (r - g) / d + 4;\r\n        break;\r\n    }\r\n    h /= 6;\r\n  }\r\n\r\n  return {\r\n    h: h * 360,\r\n    s: s * 100,\r\n    l: l * 100,\r\n    a\r\n  };\r\n}\r\n\r\n// * https://stackoverflow.com/a/9493060/6758968\r\n/**\r\n * Converts an HSL color value to RGB. Conversion formula\r\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n * Assumes h in [0, 360], s, and l are contained in the set [0, 1], a in [0, 1] and\r\n * returns r, g, and b in the set [0, 255].\r\n *\r\n * @param   {number}  h       The hue\r\n * @param   {number}  s       The saturation\r\n * @param   {number}  l       The lightness\r\n * @return  {Array}           The RGB representation\r\n */\r\nexport function hslaToRgba(h: number, s: number, l: number, a: number): ColorRgba {\r\n  h /= 360, s /= 100, l /= 100;\r\n  let r: number, g: number, b: number;\r\n\r\n  if(s === 0) {\r\n    r = g = b = l; // achromatic\r\n  } else {\r\n    const hue2rgb = function hue2rgb(p: number, q: number, t: number) {\r\n      if(t < 0) t += 1;\r\n      if(t > 1) t -= 1;\r\n      if(t < 1/6) return p + (q - p) * 6 * t;\r\n      if(t < 1/2) return q;\r\n      if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\r\n      return p;\r\n    }\r\n\r\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n    const p = 2 * l - q;\r\n    r = hue2rgb(p, q, h + 1/3);\r\n    g = hue2rgb(p, q, h);\r\n    b = hue2rgb(p, q, h - 1/3);\r\n  }\r\n\r\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255), Math.round(a * 255)];\r\n}\r\n\r\nexport function hslaStringToRgba(hsla: string) {\r\n  const splitted = hsla.slice(5, -1).split(', ');\r\n  const alpha = +splitted.pop();\r\n  const arr = splitted.map((val) => {\r\n    if(val.endsWith('%')) {\r\n      return +val.slice(0, -1);\r\n    }\r\n\r\n    return +val;\r\n  });\r\n\r\n  return hslaToRgba(arr[0], arr[1], arr[2], alpha);\r\n}\r\n\r\nexport function hexaToRgba(hexa: string) {\r\n  const arr: ColorRgba = [] as any;\r\n  const offset = hexa[0] === '#' ? 1 : 0;\r\n  if(hexa.length === (5 + offset)) {\r\n    hexa = (offset ? '#' : '') + '0' + hexa.slice(offset);\r\n  }\r\n\r\n  if(hexa.length === (3 + offset)) {\r\n    for(let i = offset; i < hexa.length; ++i) {\r\n      arr.push(parseInt(hexa[i] + hexa[i], 16));\r\n    }\r\n  } else if(hexa.length === (4 + offset)) {\r\n    for(let i = offset; i < (hexa.length - 1); ++i) {\r\n      arr.push(parseInt(hexa[i] + hexa[i], 16));\r\n    }\r\n\r\n    arr.push(parseInt(hexa[hexa.length - 1], 16));\r\n  } else {\r\n    for(let i = offset; i < hexa.length; i += 2) {\r\n      arr.push(parseInt(hexa.slice(i, i + 2), 16));\r\n    }\r\n  }\r\n\r\n  return arr;\r\n}\r\n\r\nexport function hexToRgb(hex: string) {\r\n  return hexaToRgba(hex.slice(0, 7)) as any as ColorRgb;\r\n}\r\n\r\nexport function hexaToHsla(hexa: string) {\r\n  const rgba = hexaToRgba(hexa);\r\n  return rgbaToHsla(rgba[0], rgba[1], rgba[2], rgba[3]);\r\n}\r\n\r\nexport function rgbaToHexa(rgba: ColorRgba | ColorRgb) {\r\n  return '#' + rgba.map((v) => ('0' + v.toString(16)).slice(-2)).join('');\r\n}\r\n\r\nexport function hslaStringToHexa(hsla: string) {\r\n  return rgbaToHexa(hslaStringToRgba(hsla));\r\n}\r\n\r\nexport function hslaStringToHex(hsla: string) {\r\n  return hslaStringToHexa(hsla).slice(0, -2);\r\n}\r\n","export default function compareVersion(v1: string, v2: string): number {\r\n  v1 = v1.split(' ', 1)[0];\r\n  v2 = v2.split(' ', 1)[0];\r\n  const s1 = v1.split('.');\r\n  const s2 = v2.split('.');\r\n\r\n  for(let i = 0; i < s1.length; ++i) {\r\n    const v1 = +s1[i];\r\n    const v2 = +s2[i];\r\n    if(v1 > v2) return 1;\r\n    else if(v1 < v2) return -1;\r\n  }\r\n\r\n  return 0;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport default function blurActiveElement() {\r\n  if((document.activeElement as HTMLInputElement)?.blur) {\r\n    (document.activeElement as HTMLInputElement).blur();\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n *\r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nexport default function cancelEvent(event: Event) {\r\n  event = event || window.event;\r\n  if(event) {\r\n    // @ts-ignore\r\n    event = event.originalEvent || event;\r\n\r\n    try {\r\n      if(event.stopPropagation) event.stopPropagation();\r\n      if(event.preventDefault) event.preventDefault();\r\n      event.returnValue = false;\r\n      event.cancelBubble = true;\r\n    } catch(err) {}\r\n  }\r\n\r\n  return false;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\n// export function findUpClassName<T>(el: any, className: string): T;\r\nexport default function findUpClassName(el: EventTarget | {closest: (selector: string) => any}, className: string): HTMLElement {\r\n  return (el as any).closest('.' + className);\r\n  /* if(el.classList.contains(className)) return el; // 03.02.2020\r\n\r\n  while(el.parentElement) {\r\n    el = el.parentElement;\r\n    if(el.classList.contains(className))\r\n      return el;\r\n  }\r\n  return null; */\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {doubleRaf} from '../schedulers';\r\n\r\nexport default function fixSafariStickyInput(input: HTMLElement) {\r\n  input.style.transform = 'translateY(-99999px)';\r\n  /* input.style.position = 'fixed';\r\n  input.style.top = '-99999px';\r\n  input.style.left = '0'; */\r\n  input.focus();\r\n\r\n  // setTimeout(() => {\r\n  doubleRaf().then(() => {\r\n    // fastSmoothScroll(findUpClassName(input, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'start', 4, undefined, FocusDirection.Static);\r\n    /* input.style.position = '';\r\n    input.style.top = ''; */\r\n    input.style.transform = '';\r\n    // fastSmoothScroll(findUpClassName(input, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'start', 4, undefined, FocusDirection.Static);\r\n\r\n    /* setTimeout(() => {\r\n      fastSmoothScroll(findUpClassName(input, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'start', 4);\r\n    }, 50); */\r\n  });\r\n  // }, 0);\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport IS_TOUCH_SUPPORTED from '../../environment/touchSupport';\r\nimport {IS_MOBILE, IS_SAFARI} from '../../environment/userAgent';\r\nimport findUpClassName from './findUpClassName';\r\nimport fixSafariStickyInput from './fixSafariStickyInput';\r\n\r\nexport const IS_STICKY_INPUT_BUGGED = IS_SAFARI && IS_MOBILE && IS_TOUCH_SUPPORTED;\r\n\r\nif(IS_STICKY_INPUT_BUGGED) {\r\n  const key: 'clientY' | 'pageY' = 'clientY';\r\n  let startY = 0;\r\n  const o = {capture: true, passive: false};\r\n  const onTouchMove = (e: TouchEvent) => {\r\n    const touch = e.touches[0];\r\n\r\n    // console.log('touchmove y', touch[key], startY);\r\n\r\n    const scrollable = findUpClassName(touch.target, 'scrollable-y');\r\n    if(scrollable) {\r\n      const y = touch[key];\r\n      const scrolled = startY - y;\r\n\r\n      /* if(y < startY) {\r\n        startY = y;\r\n      } */\r\n\r\n      const scrollTop = scrollable.scrollTop;\r\n      const scrollHeight = scrollable.scrollHeight;\r\n      const clientHeight = scrollable.clientHeight;\r\n      const nextScrollTop = scrollTop ? Math.round(scrollTop + scrollable.clientHeight + scrolled) : scrollTop + scrolled;\r\n      // const needCancel = scrollHeight !== clientHeight ? (scrollTop && diff <= 1) || (scrollTop - diff) < 0 : true;\r\n      const needCancel = scrollHeight === clientHeight || nextScrollTop >= scrollHeight || nextScrollTop <= 0;\r\n      if(needCancel) {\r\n        e.preventDefault();\r\n      }\r\n\r\n      // console.log('touchmove with scrollable', scrollTop, startY, scrolled, nextScrollTop, needCancel, e.cancelable);\r\n    } else {\r\n      e.preventDefault();\r\n\r\n      // console.log('touchmove no scrollable', e, touch);\r\n    }\r\n\r\n    // if(e.target === document.documentElement || e.target === document.body) e.preventDefault();\r\n  };\r\n\r\n  // let el = document.createElement('div');\r\n  // document.body.prepend(el);\r\n  // let a = 0;\r\n\r\n  // let hasFocus = false;\r\n  let lastFocusOutTimeStamp = 0;\r\n  document.addEventListener('focusin', (e) => {\r\n    if(!(e.target as HTMLElement).classList.contains('is-sticky-input-bugged') || (e.timeStamp - lastFocusOutTimeStamp) < 50/*  && document.activeElement === input */) {\r\n      return;\r\n    }\r\n\r\n    // console.log('focusin', e, e.timeStamp);\r\n\r\n    // hasFocus = true;\r\n    // document.body.classList.add('is-keyboard-opened');\r\n\r\n    // el.innerText = 'focusin ' + ++a;\r\n\r\n    /* a < 2 &&  */fixSafariStickyInput(e.target as HTMLElement);\r\n\r\n    document.addEventListener('touchmove', onTouchMove, o);\r\n    document.addEventListener('touchstart', (e) => {\r\n      if(e.touches.length > 1) return;\r\n      const touchStart = e.touches[0];\r\n\r\n      startY = touchStart[key];\r\n    });\r\n  }, {passive: true});\r\n\r\n  document.addEventListener('focusout', (e) => {\r\n    // console.log('focusout', e, e.timeStamp);\r\n    document.removeEventListener('touchmove', onTouchMove, o);\r\n\r\n    lastFocusOutTimeStamp = e.timeStamp;\r\n\r\n    // el.innerText = 'focusout ' + ++a;\r\n\r\n    // if(hasFocus) {\r\n    //   hasFocus = false;\r\n    //   document.body.classList.remove('is-keyboard-opened');\r\n    // }\r\n  }, {passive: true});\r\n\r\n  document.addEventListener('visibilitychange', () => {\r\n    // console.log('window visibilitychange');\r\n    if(document.activeElement &&\r\n      document.activeElement.classList.contains('is-sticky-input-bugged') &&\r\n      (document.activeElement as HTMLElement).blur) {\r\n      fixSafariStickyInput(document.activeElement as HTMLElement);\r\n    }\r\n\r\n    /* blurActiveElement();\r\n    window.scrollTo(0, 0);\r\n    setVH(); */\r\n  }, {passive: true});\r\n}\r\n\r\nexport default function fixSafariStickyInputFocusing(input: HTMLElement) {\r\n  if(!IS_STICKY_INPUT_BUGGED) return;\r\n  input.classList.add('is-sticky-input-bugged');\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport noop from '../noop';\r\nimport pause from '../schedulers/pause';\r\n\r\nconst texts = ['b', ''];\r\ntype FontType = 'text' | 'icons' | 'monospace';\r\n\r\nconst cache: {\r\n  [key: string]: {\r\n    [text: string]: Promise<any>\r\n  }\r\n} = {};\r\n\r\nconst fonts: {[type in FontType]: string} = {\r\n  text: 'Roboto',\r\n  icons: 'tgico',\r\n  monospace: 'Roboto Mono'\r\n};\r\n\r\nexport default function loadFonts(types: {[type in FontType]?: string[] | 'all'} = {\r\n  text: texts,\r\n  icons: undefined,\r\n  monospace: texts\r\n}): Promise<any> {\r\n  if(!('fonts' in document)) {\r\n    return Promise.resolve();\r\n  }\r\n\r\n  const promises: Promise<any>[] = [];\r\n  for(const type in types) {\r\n    let _texts = types[type as FontType];\r\n    if(_texts === 'all') {\r\n      _texts = texts;\r\n    }\r\n\r\n    const font = fonts[type as FontType];\r\n    const weights = type === 'icons' ? [500] : [400, 500];\r\n    for(const weight of weights) {\r\n      const _promises = (_texts || [undefined]).map((text) => {\r\n        const key = [weight, '1rem', font].join(' ');\r\n        const promise = (cache[key] ??= {})[text || ''] ??= document.fonts.load(key, text);\r\n        return promise;\r\n      });\r\n      promises.push(..._promises);\r\n    }\r\n  }\r\n\r\n  return Promise.race([\r\n    Promise.all(promises).catch(noop),\r\n    pause(1000)\r\n  ]);\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\r\nimport EventListenerBase from './eventListenerBase';\r\n\r\nconst FOCUS_EVENT_NAME = IS_TOUCH_SUPPORTED ? 'touchstart' : 'mousemove';\r\nconst DO_NOT_IDLE = false;\r\n\r\nexport class IdleController extends EventListenerBase<{\r\n  change: (idle: boolean) => void\r\n}> {\r\n  private _isIdle: boolean;\r\n\r\n  private focusPromise: Promise<void>;\r\n  private focusResolve: () => void;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this._isIdle = true;\r\n    this.focusPromise = Promise.resolve();\r\n    this.focusResolve = () => {};\r\n\r\n    window.addEventListener('blur', () => {\r\n      this.isIdle = true;\r\n\r\n      window.addEventListener('focus', () => {\r\n        this.isIdle = false;\r\n      }, {once: true});\r\n    });\r\n\r\n    // * Prevent setting online after reloading page\r\n    window.addEventListener(FOCUS_EVENT_NAME, () => {\r\n      this.isIdle = false;\r\n    }, {once: true, passive: true});\r\n\r\n    this.addEventListener('change', (idle) => {\r\n      if(idle) {\r\n        this.focusPromise = new Promise((resolve) => {\r\n          this.focusResolve = resolve;\r\n        });\r\n      } else {\r\n        this.focusResolve();\r\n      }\r\n    });\r\n  }\r\n\r\n  public getFocusPromise() {\r\n    return this.focusPromise;\r\n  }\r\n\r\n  public get isIdle() {\r\n    return this._isIdle;\r\n  }\r\n\r\n  public set isIdle(value: boolean) {\r\n    if(this._isIdle === value) {\r\n      return;\r\n    }\r\n\r\n    if(DO_NOT_IDLE && value) {\r\n      return;\r\n    }\r\n\r\n    this._isIdle = value;\r\n    this.dispatchEvent('change', value);\r\n  }\r\n}\r\n\r\nconst idleController = new IdleController();\r\nexport default idleController;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport EventListenerBase from './eventListenerBase';\r\n\r\nexport class OverlayCounter extends EventListenerBase<{\r\n  change: (isActive: boolean) => void\r\n}> {\r\n  public overlaysActive = 0;\r\n\r\n  get isOverlayActive() {\r\n    return this.overlaysActive > 0;\r\n  }\r\n\r\n  set isOverlayActive(value: boolean) {\r\n    this.overlaysActive += value ? 1 : -1;\r\n    this.dispatchEvent('change', this.isOverlayActive);\r\n  }\r\n}\r\n\r\nconst overlayCounter = new OverlayCounter();\r\nexport default overlayCounter;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\n// * Jolly Cobra's schedulers\r\nimport {NoneToVoidFunction} from '../types';\r\n\r\n/*\r\nexport function throttleWithTickEnd<F extends AnyToVoidFunction>(fn: F) {\r\n  return throttleWith(onTickEnd, fn);\r\n}\r\n\r\nexport function throttleWithNow<F extends AnyToVoidFunction>(fn: F) {\r\n  return throttleWith(runNow, fn);\r\n}\r\n\r\nexport function onTickEnd(cb: NoneToVoidFunction) {\r\n  Promise.resolve().then(cb);\r\n}\r\n\r\nfunction runNow(fn: NoneToVoidFunction) {\r\n  fn();\r\n} */\r\n\r\nlet fastRafCallbacks: NoneToVoidFunction[] | undefined;\r\nexport function fastRaf(callback: NoneToVoidFunction) {\r\n  if(!fastRafCallbacks) {\r\n    fastRafCallbacks = [callback];\r\n\r\n    requestAnimationFrame(() => {\r\n      const currentCallbacks = fastRafCallbacks!;\r\n      fastRafCallbacks = undefined;\r\n      currentCallbacks.forEach((cb) => cb());\r\n    });\r\n  } else {\r\n    fastRafCallbacks.push(callback);\r\n  }\r\n}\r\n\r\nlet fastRafConventionalCallbacks: NoneToVoidFunction[] | undefined, processing = false;\r\nexport function fastRafConventional(callback: NoneToVoidFunction) {\r\n  if(!fastRafConventionalCallbacks) {\r\n    fastRafConventionalCallbacks = [callback];\r\n\r\n    requestAnimationFrame(() => {\r\n      processing = true;\r\n      for(let i = 0; i < fastRafConventionalCallbacks.length; ++i) {\r\n        fastRafConventionalCallbacks[i]();\r\n      }\r\n\r\n      fastRafConventionalCallbacks = undefined;\r\n      processing = false;\r\n    });\r\n  } else if(processing) {\r\n    callback();\r\n  } else {\r\n    fastRafConventionalCallbacks.push(callback);\r\n  }\r\n}\r\n\r\nlet rafPromise: Promise<void>;\r\nexport function fastRafPromise() {\r\n  if(rafPromise) return rafPromise;\r\n\r\n  rafPromise = new Promise<void>((resolve) => fastRaf(() => resolve()));\r\n  rafPromise.then(() => {\r\n    rafPromise = undefined;\r\n  });\r\n\r\n  return rafPromise;\r\n}\r\n\r\nexport function doubleRaf() {\r\n  return new Promise<void>((resolve) => {\r\n    fastRaf(() => {\r\n      fastRaf(resolve);\r\n    });\r\n  });\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport default function parseUriParams(uri: string, splitted = uri.split('?')) {\r\n  const params: any = {};\r\n  if(!splitted[1]) return params;\r\n  splitted[1].split('&').forEach((item) => {\r\n    params[item.split('=')[0]] = decodeURIComponent(item.split('=')[1]);\r\n  });\r\n\r\n  return params;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport type {Theme} from '../config/state';\r\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\r\nimport rootScope from '../lib/rootScope';\r\nimport {hslaStringToHex} from './color';\r\n\r\nexport class ThemeController {\r\n  private themeColor: string;\r\n  private _themeColorElem: Element;\r\n  private systemTheme: Theme['name'];\r\n\r\n  constructor() {\r\n    rootScope.addEventListener('theme_change', () => {\r\n      this.setTheme();\r\n    });\r\n\r\n    // rootScope.addEventListener('settings_updated', ())\r\n  }\r\n\r\n  private get themeColorElem() {\r\n    if(this._themeColorElem !== undefined) {\r\n      return this._themeColorElem;\r\n    }\r\n\r\n    return this._themeColorElem = document.head.querySelector('[name=\"theme-color\"]') as Element || null;\r\n  }\r\n\r\n  public setThemeColor(color = this.themeColor) {\r\n    if(!color) {\r\n      color = this.isNight() ? '#212121' : '#ffffff';\r\n    }\r\n\r\n    const themeColorElem = this.themeColorElem;\r\n    if(themeColorElem) {\r\n      themeColorElem.setAttribute('content', color);\r\n    }\r\n  }\r\n\r\n  public setThemeListener() {\r\n    try {\r\n      const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n      const checkDarkMode = () => {\r\n        // const theme = this.getTheme();\r\n        this.systemTheme = darkModeMediaQuery.matches ? 'night' : 'day';\r\n        // const newTheme = this.getTheme();\r\n\r\n        if(rootScope.myId) {\r\n          rootScope.dispatchEvent('theme_change');\r\n        } else {\r\n          this.setTheme();\r\n        }\r\n      };\r\n\r\n      if('addEventListener' in darkModeMediaQuery) {\r\n        darkModeMediaQuery.addEventListener('change', checkDarkMode);\r\n      } else if('addListener' in darkModeMediaQuery) {\r\n        (darkModeMediaQuery as any).addListener(checkDarkMode);\r\n      }\r\n\r\n      checkDarkMode();\r\n    } catch(err) {\r\n\r\n    }\r\n  }\r\n\r\n  public applyHighlightningColor() {\r\n    let hsla: string;\r\n    const theme = themeController.getTheme();\r\n    if(theme.background.highlightningColor) {\r\n      hsla = theme.background.highlightningColor;\r\n      document.documentElement.style.setProperty('--message-highlightning-color', hsla);\r\n    } else {\r\n      document.documentElement.style.removeProperty('--message-highlightning-color');\r\n    }\r\n\r\n    if(!IS_TOUCH_SUPPORTED && hsla) {\r\n      themeController.themeColor = hslaStringToHex(hsla);\r\n    }\r\n  }\r\n\r\n  public setTheme() {\r\n    const isNight = this.isNight();\r\n    const colorScheme = document.head.querySelector('[name=\"color-scheme\"]');\r\n    if(colorScheme) {\r\n      colorScheme.setAttribute('content', isNight ? 'dark' : 'light');\r\n    }\r\n\r\n    document.documentElement.classList.toggle('night', isNight);\r\n    this.setThemeColor();\r\n\r\n    this.applyHighlightningColor();\r\n  }\r\n\r\n  public isNight() {\r\n    return this.getTheme().name === 'night';\r\n  }\r\n\r\n  public getTheme(name: Theme['name'] = rootScope.settings.theme === 'system' ? this.systemTheme : rootScope.settings.theme) {\r\n    return rootScope.settings.themes.find((t) => t.name === name);\r\n  }\r\n}\r\n\r\nconst themeController = new ThemeController();\r\nexport default themeController;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport default function setWorkerProxy() {\r\n  // * hook worker constructor to set search parameters (test, debug, etc)\r\n  const workerHandler = {\r\n    construct(target: any, args: any) {\r\n      let url = args[0] + '';\r\n      if(url.indexOf('blob:') !== 0) {\r\n        url += location.search;\r\n      }\r\n\r\n      return new target(url);\r\n    }\r\n  };\r\n\r\n  [\r\n    Worker,\r\n    typeof(SharedWorker) !== 'undefined' && SharedWorker\r\n  ].filter(Boolean).forEach((w) => {\r\n    window[w.name as any] = new Proxy(w, workerHandler);\r\n  });\r\n}\r\n\r\nsetWorkerProxy();\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport * as ReactDOM from \"react-dom/client\";\r\nimport App from './config/app';\r\nimport Modes from './config/modes';\r\nimport IS_EMOJI_SUPPORTED from './environment/emojiSupport';\r\nimport IS_TOUCH_SUPPORTED from './environment/touchSupport';\r\nimport { IS_ANDROID, IS_APPLE, IS_APPLE_MOBILE, IS_FIREFOX, IS_MOBILE, IS_MOBILE_SAFARI, IS_SAFARI } from './environment/userAgent';\r\nimport blurActiveElement from './helpers/dom/blurActiveElement';\r\nimport cancelEvent from './helpers/dom/cancelEvent';\r\nimport { IS_STICKY_INPUT_BUGGED } from './helpers/dom/fixSafariStickyInputFocusing';\r\nimport loadFonts from './helpers/dom/loadFonts';\r\nimport toggleAttributePolyfill from './helpers/dom/toggleAttributePolyfill';\r\nimport overlayCounter from './helpers/overlayCounter';\r\nimport './helpers/peerIdPolyfill';\r\nimport pause from './helpers/schedulers/pause';\r\nimport setWorkerProxy from './helpers/setWorkerProxy';\r\nimport parseUriParams from './helpers/string/parseUriParams';\r\nimport themeController from './helpers/themeController';\r\nimport getProxiedManagers from './lib/appManagers/getProxiedManagers';\r\nimport I18n from './lib/langPack';\r\nimport apiManagerProxy from './lib/mtproto/mtprotoworker';\r\nimport singleInstance from './lib/mtproto/singleInstance';\r\nimport './lib/polyfill';\r\nimport rootScope from './lib/rootScope';\r\nimport './materialize.scss';\r\nimport './scss/style.scss';\r\nimport { AuthState } from './types';\r\n// import appNavigationController from './components/appNavigationController';\r\n\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n  toggleAttributePolyfill();\r\n\r\n  // polyfill for replaceChildren\r\n  if ((Node as any).prototype.replaceChildren === undefined) {\r\n    (Node as any).prototype.replaceChildren = function (...nodes: any[]) {\r\n      this.textContent = '';\r\n      // while(this.lastChild) {\r\n      //   this.removeChild(this.lastChild);\r\n      // }\r\n      if (nodes) {\r\n        this.append(...nodes);\r\n      }\r\n    }\r\n  }\r\n\r\n  rootScope.managers = getProxiedManagers();\r\n  var div = document.createElement(\"div\")\r\n  div.id = 'dialog'\r\n  document.body.append(div)\r\n  rootScope.dialogRoot = ReactDOM.createRoot(div);\r\n\r\n  const manifest = document.getElementById('manifest') as HTMLLinkElement;\r\n  manifest.href = `site${IS_APPLE && !IS_APPLE_MOBILE ? '_apple' : ''}.webmanifest?v=jw3mK7G9Aq`;\r\n\r\n  singleInstance.start();\r\n\r\n  // We listen to the resize event (https://css-tricks.com/the-trick-to-viewport-units-on-mobile/)\r\n  const w = window.visualViewport || window; // * handle iOS keyboard\r\n  let setViewportVH = false/* , hasFocus = false */;\r\n  let lastVH: number;\r\n  const setVH = () => {\r\n    const vh = (setViewportVH && !overlayCounter.isOverlayActive ? (w as VisualViewport).height || (w as Window).innerHeight : window.innerHeight) * 0.01;\r\n    if (lastVH === vh) {\r\n      return;\r\n    } else if (IS_TOUCH_SUPPORTED && lastVH < vh && (vh - lastVH) > 1) {\r\n      blurActiveElement(); // (Android) fix blurring inputs when keyboard is being closed (e.g. closing keyboard by back arrow and touching a bubble)\r\n    }\r\n\r\n    lastVH = vh;\r\n\r\n    // const vh = document.documentElement.scrollHeight * 0.01;\r\n    document.documentElement.style.setProperty('--vh', `${vh}px`);\r\n\r\n    // console.log('setVH', vh, setViewportVH ? w : window);\r\n\r\n    /* if(setViewportVH && userAgent.isSafari && touchSupport.isTouchSupported && document.activeElement && (document.activeElement as HTMLElement).blur) {\r\n      const rect = document.activeElement.getBoundingClientRect();\r\n      if(rect.top < 0 || rect.bottom >= (w as any).height) {\r\n        fastSmoothScroll(findUpClassName(document.activeElement, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'center', 4, undefined, FocusDirection.Static);\r\n      }\r\n    } */\r\n  };\r\n\r\n  setWorkerProxy;\r\n\r\n  // const [_, touchSupport, userAgent, _rootScope, _appStateManager, _I18n, __/* , ___ */] = await Promise.all([\r\n  //   import('./lib/polyfill'),\r\n  //   import('./environment/touchSupport'),\r\n  //   import('./environment/userAgent'),\r\n  //   import('./lib/rootScope'),\r\n  //   import('./lib/appManagers/appStateManager'),\r\n  //   import('./lib/langPack'),\r\n  //   import('./helpers/peerIdPolyfill'),\r\n  //   // import('./helpers/cacheFunctionPolyfill')\r\n  // ]);\r\n\r\n  /* const {IS_TOUCH_SUPPORTED} = touchSupport;\r\n  const {IS_FIREFOX, IS_MOBILE, IS_APPLE, IS_SAFARI, IS_APPLE_MOBILE, IS_ANDROID} = userAgent;\r\n  const rootScope = _rootScope.default;\r\n  const appStateManager = _appStateManager.default;\r\n  const I18n = _I18n.default; */\r\n\r\n  window.addEventListener('resize', setVH);\r\n  setVH();\r\n\r\n  if (IS_STICKY_INPUT_BUGGED) {\r\n    const toggleResizeMode = () => {\r\n      setViewportVH = tabId === 1 && IS_STICKY_INPUT_BUGGED && !overlayCounter.isOverlayActive;\r\n      setVH();\r\n\r\n      if (w !== window) {\r\n        if (setViewportVH) {\r\n          window.removeEventListener('resize', setVH);\r\n          w.addEventListener('resize', setVH);\r\n        } else {\r\n          w.removeEventListener('resize', setVH);\r\n          window.addEventListener('resize', setVH);\r\n        }\r\n      }\r\n    };\r\n\r\n    let tabId: number;\r\n    (window as any).onImTabChange = (id: number) => {\r\n      const wasTabId = tabId !== undefined;\r\n      tabId = id;\r\n\r\n      if (wasTabId || tabId === 1) {\r\n        toggleResizeMode();\r\n      }\r\n    };\r\n\r\n    overlayCounter.addEventListener('change', () => {\r\n      toggleResizeMode();\r\n    });\r\n  }\r\n\r\n  if (IS_FIREFOX && !IS_EMOJI_SUPPORTED) {\r\n    document.addEventListener('dragstart', (e) => {\r\n      const target = e.target as HTMLElement;\r\n      if (target.tagName === 'IMG' && target.classList.contains('emoji')) {\r\n        cancelEvent(e);\r\n        return false;\r\n      }\r\n    });\r\n  }\r\n\r\n  if (IS_EMOJI_SUPPORTED) {\r\n    document.documentElement.classList.add('native-emoji');\r\n  }\r\n\r\n  // prevent firefox image dragging\r\n  document.addEventListener('dragstart', (e) => {\r\n    if ((e.target as HTMLElement)?.tagName === 'IMG') {\r\n      e.preventDefault();\r\n      return false;\r\n    }\r\n  });\r\n\r\n  // restrict contextmenu on images (e.g. webp stickers)\r\n  document.addEventListener('contextmenu', (e) => {\r\n    if ((e.target as HTMLElement).tagName === 'IMG' && !(window as any).appMediaViewer) {\r\n      cancelEvent(e);\r\n    }\r\n  });\r\n\r\n  if (IS_FIREFOX) {\r\n    document.documentElement.classList.add('is-firefox', 'no-backdrop');\r\n  }\r\n\r\n  if (IS_MOBILE) {\r\n    document.documentElement.classList.add('is-mobile');\r\n  }\r\n\r\n  if (IS_APPLE) {\r\n    if (IS_SAFARI) {\r\n      document.documentElement.classList.add('is-safari');\r\n    }\r\n\r\n    // document.documentElement.classList.add('emoji-supported');\r\n\r\n    if (IS_APPLE_MOBILE) {\r\n      document.documentElement.classList.add('is-ios');\r\n    } else {\r\n      document.documentElement.classList.add('is-mac');\r\n    }\r\n  } else if (IS_ANDROID) {\r\n    document.documentElement.classList.add('is-android');\r\n\r\n    /* document.addEventListener('focusin', (e) => {\r\n      hasFocus = true;\r\n      focusTime = Date.now();\r\n    }, {passive: true});\r\n\r\n    document.addEventListener('focusout', () => {\r\n      hasFocus = false;\r\n    }, {passive: true}); */\r\n  }\r\n\r\n  if (!IS_TOUCH_SUPPORTED) {\r\n    document.documentElement.classList.add('no-touch');\r\n  } else {\r\n    document.documentElement.classList.add('is-touch');\r\n    /* document.addEventListener('touchmove', (event: any) => {\r\n      event = event.originalEvent || event;\r\n      if(event.scale && event.scale !== 1) {\r\n        event.preventDefault();\r\n      }\r\n    }, {capture: true, passive: false}); */\r\n  }\r\n\r\n  const perf = performance.now();\r\n\r\n  // await pause(1000000);\r\n\r\n  const langPromise = I18n.getCacheLangPack();\r\n\r\n  const [stateResult, langPack] = await Promise.all([\r\n    // loadState(),\r\n    apiManagerProxy.sendState().then(([stateResult]) => stateResult),\r\n    langPromise\r\n  ]);\r\n  I18n.setTimeFormat(stateResult.state.settings.timeFormat);\r\n\r\n  rootScope.managers.rootScope.getPremium().then((isPremium) => {\r\n    rootScope.premium = isPremium;\r\n  });\r\n\r\n  themeController.setThemeListener();\r\n\r\n  if (langPack.appVersion !== App.langPackVersion) {\r\n    I18n.getLangPack(langPack.lang_code);\r\n  }\r\n\r\n  /**\r\n   * won't fire if font is loaded too fast\r\n   */\r\n  function fadeInWhenFontsReady(elem: HTMLElement, promise: Promise<any>) {\r\n    elem.style.opacity = '0';\r\n\r\n    promise.then(() => {\r\n      window.requestAnimationFrame(() => {\r\n        elem.style.opacity = '';\r\n      });\r\n    });\r\n  }\r\n\r\n  console.log('got state, time:', performance.now() - perf);\r\n\r\n  let authState = stateResult.state.authState;\r\n\r\n  const hash = location.hash;\r\n  const splitted = hash.split('?');\r\n  const params = parseUriParams(hash, splitted);\r\n  if (params.tgWebAuthToken && authState._ !== 'authStateSignedIn') {\r\n    const data: AuthState.signImport['data'] = {\r\n      token: params.tgWebAuthToken,\r\n      dcId: +params.tgWebAuthDcId,\r\n      userId: params.tgWebAuthUserId.toUserId(),\r\n      isTest: params.tgWebAuthTest !== undefined && !!+params.tgWebAuthTest,\r\n      tgAddr: params.tgaddr\r\n    };\r\n\r\n    if (data.isTest !== Modes.test) {\r\n      const urlSearchParams = new URLSearchParams(location.search);\r\n      if (+params.tgWebAuthTest) {\r\n        urlSearchParams.set('test', '1');\r\n      } else {\r\n        urlSearchParams.delete('test');\r\n      }\r\n\r\n      location.search = urlSearchParams.toString();\r\n      return;\r\n    }\r\n\r\n    rootScope.managers.appStateManager.pushToState('authState', authState = { _: 'authStateSignImport', data });\r\n\r\n    // appNavigationController.overrideHash('?tgaddr=' + encodeURIComponent(params.tgaddr));\r\n  }\r\n\r\n  if (authState._ !== 'authStateSignedIn'/*  || 1 === 1 */) {\r\n    console.log('Will mount auth page:', authState._, Date.now() / 1000);\r\n\r\n    const el = document.getElementById('auth-pages');\r\n    let scrollable: HTMLElement;\r\n    if (el) {\r\n      scrollable = el.querySelector('.scrollable') as HTMLElement;\r\n      if ((!IS_TOUCH_SUPPORTED || IS_MOBILE_SAFARI)) {\r\n        scrollable.classList.add('no-scrollbar');\r\n      }\r\n\r\n      // * don't remove this line\r\n      scrollable.style.opacity = '0';\r\n\r\n      const placeholder = document.createElement('div');\r\n      placeholder.classList.add('auth-placeholder');\r\n\r\n      scrollable.prepend(placeholder);\r\n      scrollable.append(placeholder.cloneNode());\r\n    }\r\n\r\n    try {\r\n      await Promise.all([\r\n        import('./lib/mtproto/telegramMeWebManager'),\r\n        import('./lib/mtproto/webPushApiManager')\r\n      ]).then(([meModule, pushModule]) => {\r\n        meModule.default.setAuthorized(false);\r\n        pushModule.default.forceUnsubscribe();\r\n      });\r\n    } catch (err) {\r\n\r\n    }\r\n\r\n    let pagePromise: Promise<void>;\r\n    // langPromise.then(async() => {\r\n    switch (authState._) {\r\n      case 'authStateSignIn':\r\n        pagePromise = (await import('./pages/pageSignIn')).default.mount();\r\n        break;\r\n      case 'authStateSignQr':\r\n        pagePromise = (await import('./pages/pageSignQR')).default.mount();\r\n        break;\r\n      case 'authStateAuthCode':\r\n        pagePromise = (await import('./pages/pageAuthCode')).default.mount(authState.sentCode);\r\n        break;\r\n      case 'authStatePassword':\r\n        pagePromise = (await import('./pages/pagePassword')).default.mount();\r\n        break;\r\n      case 'authStateSignUp':\r\n        pagePromise = (await import('./pages/pageSignUp')).default.mount(authState.authCode);\r\n        break;\r\n      case 'authStateSignImport':\r\n        pagePromise = (await import('./pages/pageSignImport')).default.mount(authState.data);\r\n        break;\r\n    }\r\n    // });\r\n\r\n    if (scrollable) {\r\n      // wait for text appear\r\n      if (pagePromise) {\r\n        await pagePromise;\r\n      }\r\n\r\n      const promise = 'fonts' in document ?\r\n        Promise.race([\r\n          pause(1000),\r\n          document.fonts.ready\r\n        ]) :\r\n        Promise.resolve();\r\n      fadeInWhenFontsReady(scrollable, promise);\r\n    }\r\n\r\n    /* setTimeout(async() => {\r\n      (await import('./pages/pageAuthCode')).default.mount({\r\n        \"_\": \"auth.sentCode\",\r\n        \"pFlags\": {},\r\n        \"flags\": 6,\r\n        \"type\": {\r\n          \"_\": \"auth.sentCodeTypeSms\",\r\n          \"length\": 5\r\n        },\r\n        \"phone_code_hash\": \"\",\r\n        \"next_type\": {\r\n          \"_\": \"auth.codeTypeCall\"\r\n        },\r\n        \"timeout\": 120,\r\n        \"phone_number\": \"\"\r\n      });\r\n\r\n      (await import('./pages/pageSignQR')).default.mount();\r\n\r\n      (await import('./pages/pagePassword')).default.mount();\r\n\r\n      (await import('./pages/pageSignUp')).default.mount({\r\n        \"phone_code_hash\": \"\",\r\n        \"phone_number\": \"\"\r\n      });\r\n    }, 500); */\r\n  } else {\r\n    console.log('Will mount IM page:', Date.now() / 1000);\r\n    fadeInWhenFontsReady(document.getElementById('main-columns'), loadFonts());\r\n    (await import('./pages/pageIm')).default.mount();\r\n  }\r\n});\r\n","export default function toggleAttributePolyfill() {\r\n  if(!Element.prototype.toggleAttribute) {\r\n    Element.prototype.toggleAttribute = function(name, force) {\r\n      if(force !== void 0) force = !!force;\r\n\r\n      if(this.hasAttribute(name)) {\r\n        if(force) return true;\r\n\r\n        this.removeAttribute(name);\r\n        return false;\r\n      }\r\n      if(force === false) return false;\r\n\r\n      this.setAttribute(name, '');\r\n      return true;\r\n    };\r\n  }\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n *\r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nexport class AppRuntimeManager {\r\n  public reload() {\r\n    try {\r\n      location.reload();\r\n    } catch(e) {};\r\n\r\n    // if(window.chrome && chrome.runtime && chrome.runtime.reload) {\r\n    //   chrome.runtime.reload();\r\n    // }\r\n  }\r\n\r\n  public close() {\r\n    try {\r\n      window.close();\r\n    } catch(e) {}\r\n  }\r\n\r\n  /**\r\n   * Better to call from event\r\n   */\r\n  public focus() {\r\n    // // @ts-ignore\r\n    // if(window.navigator.mozApps && document.hidden) {\r\n    //   // Get app instance and launch it to bring app to foreground\r\n    //   // @ts-ignore\r\n    //   window.navigator.mozApps.getSelf().onsuccess = function() {\r\n    //     this.result.launch();\r\n    //   };\r\n    // } else {\r\n    //   // @ts-ignore\r\n    //   if(window.chrome && chrome.app && chrome.app.window) {\r\n    //     // @ts-ignore\r\n    //     chrome.app.window.current().focus();\r\n    //   }\r\n\r\n    window.focus();\r\n    // }\r\n  }\r\n}\r\n\r\nconst appRuntimeManager = new AppRuntimeManager();\r\nexport default appRuntimeManager;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport type createManagers from './createManagers';\r\nimport {ModifyFunctionsToAsync} from '../../types';\r\nimport apiManagerProxy from '../mtproto/mtprotoworker';\r\nimport {AckedResult} from '../mtproto/superMessagePort';\r\nimport noop from '../../helpers/noop';\r\nimport dT from '../../helpers/dT';\r\nimport DEBUG from '../../config/debug';\r\n\r\n// let stats: {\r\n//   [manager: string]: {\r\n//     [method: string]: {\r\n//       times: number[],\r\n//       byArgs: {\r\n//         [args: string]: number[]\r\n//       }\r\n//     }\r\n//   }\r\n// } = {};\r\n\r\n// let sentCount = 0;\r\n// let sentMethods: {[key: string]: number} = {};\r\n// let sentMethods2: {[key: string]: number} = {};\r\n// function collectStats(manager: string, method: string, args: any[], promise: Promise<any>) {\r\n//   ++sentCount;\r\n\r\n//   const key = [manager, method].join('-');\r\n//   if(!sentMethods[key]) sentMethods[key] = 0;\r\n//   ++sentMethods[key];\r\n\r\n//   const key2 = [('00000' + sentCount).slice(-5), key].join('-');\r\n\r\n//   let byManager = stats[manager] ??= {};\r\n//   let byMethod = byManager[method] ??= {times: [], byArgs: {}};\r\n\r\n//   const perf = performance.now();\r\n//   promise.catch(noop).finally(() => {\r\n//     const time = performance.now() - perf;\r\n//     byMethod.times.push(time);\r\n\r\n//     sentMethods2[key2] = time;\r\n\r\n//     try {\r\n//       const argsString = JSON.stringify(args);\r\n//       byMethod.byArgs[argsString].push(time);\r\n//     } catch(err) {}\r\n//   });\r\n// }\r\n\r\n// setInterval(() => {\r\n//   // console.log(dT(), '[PROXY] stats', stats, sentCount, sentMethods, sentMethods2);\r\n//   sentCount = 0;\r\n//   sentMethods = {};\r\n//   sentMethods2 = {};\r\n// }, 2000);\r\n\r\nconst DEBUG_MANAGER_REQUESTS: {[managerName: string]: Set<string>} = {};\r\nif(DEBUG) {\r\n  (window as any).DEBUG_MANAGER_REQUESTS = DEBUG_MANAGER_REQUESTS;\r\n}\r\n\r\nfunction createProxy(/* source: T,  */name: string, ack?: boolean) {\r\n  const proxy = new Proxy({}, {\r\n    get: (target, p, receiver) => {\r\n      // console.log('get', target, p, receiver);\r\n      // @ts-ignore\r\n      // const value = source[p];\r\n      // if(typeof(value) !== 'function') {\r\n      //   return value;\r\n      // }\r\n\r\n      return (...args: any[]) => {\r\n        const promise = apiManagerProxy.invoke('manager', {\r\n          name,\r\n          method: p as string,\r\n          args\r\n        }, ack as any);\r\n\r\n        if(DEBUG) {\r\n          if(DEBUG_MANAGER_REQUESTS[name]?.has(p as any)) {\r\n            console.warn('manager request', name, p, args);\r\n          }\r\n        }\r\n\r\n        // collectStats(name, p as string, args, promise);\r\n\r\n        return promise;\r\n\r\n        // @ts-ignore\r\n        // return Promise.resolve(value.call(source, ...args));\r\n      };\r\n    }\r\n  });\r\n\r\n  return proxy;\r\n}\r\n\r\ntype AA<T> = {\r\n  [key in keyof T]: T[key] extends (...args: infer A) => infer R ? (...args: A) => Promise<AckedResult<Awaited<R>>> : never\r\n};\r\n\r\ntype T = Awaited<ReturnType<typeof createManagers>>;\r\ntype ProxiedManagers = {\r\n  [name in keyof T]?: ModifyFunctionsToAsync<T[name]>;\r\n} & {\r\n  acknowledged?: {\r\n    [name in keyof T]?: AA<T[name]>;\r\n  }\r\n};\r\n\r\nfunction createProxyProxy(proxied: any, ack?: boolean) {\r\n  return new Proxy(proxied, {\r\n    get: (target, p, receiver) => {\r\n      // @ts-ignore\r\n      return target[p] ??= createProxy(p as string, ack);\r\n    }\r\n  });\r\n}\r\n\r\nlet proxied: ProxiedManagers;\r\nexport default function getProxiedManagers() {\r\n  if(proxied) {\r\n    return proxied;\r\n  }\r\n\r\n  proxied = createProxyProxy({}, false);\r\n  proxied.acknowledged = createProxyProxy({}, true);\r\n  return proxied;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n *\r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nimport {Database} from '../../config/databases';\r\nimport Modes from '../../config/modes';\r\nimport makeError from '../../helpers/makeError';\r\nimport safeAssign from '../../helpers/object/safeAssign';\r\nimport {logger} from '../logger';\r\n\r\n/**\r\n * https://developer.mozilla.org/en-US/docs/Web/API/IDBObjectStore/createIndex\r\n */\r\nexport type IDBIndex = {\r\n  indexName: string,\r\n  keyPath: string,\r\n  objectParameters: IDBIndexParameters\r\n};\r\n\r\nexport type IDBStore = {\r\n  name: string,\r\n  indexes?: IDBIndex[]\r\n};\r\n\r\nexport type IDBOptions = {\r\n  name?: string,\r\n  storeName: string,\r\n  stores?: IDBStore[],\r\n  version?: number\r\n};\r\n\r\nconst DEBUG = false;\r\n\r\nexport class IDB {\r\n  private static INSTANCES: IDB[] = [];\r\n  private openDbPromise: Promise<IDBDatabase>;\r\n  private db: IDBDatabase;\r\n  private storageIsAvailable: boolean;\r\n  private log: ReturnType<typeof logger>;\r\n  private name: string;\r\n  private version: number;\r\n  private stores: IDBStore[];\r\n\r\n  constructor(db: Database<any>) {\r\n    safeAssign(this, db);\r\n\r\n    if(Modes.test) {\r\n      this.name += '_test';\r\n    }\r\n\r\n    this.storageIsAvailable = true;\r\n    this.log = logger(['IDB', db.name].join('-'));\r\n    this.log('constructor');\r\n\r\n    this.openDatabase(true);\r\n\r\n    IDB.INSTANCES.push(this);\r\n  }\r\n\r\n  public isAvailable() {\r\n    return this.storageIsAvailable;\r\n  }\r\n\r\n  public openDatabase(createNew = false): Promise<IDBDatabase> {\r\n    if(this.openDbPromise && !createNew) {\r\n      return this.openDbPromise;\r\n    }\r\n\r\n    const createIndexes = (os: IDBObjectStore, store: IDBStore) => {\r\n      const indexNames = Array.from(os.indexNames);\r\n      for(const indexName of indexNames) {\r\n        os.deleteIndex(indexName);\r\n      }\r\n\r\n      if(!store.indexes?.length) {\r\n        return;\r\n      }\r\n\r\n      for(const index of store.indexes) {\r\n        if(os.indexNames.contains(index.indexName)) {\r\n          continue;\r\n        }\r\n\r\n        os.createIndex(index.indexName, index.keyPath, index.objectParameters);\r\n      }\r\n    };\r\n\r\n    const createObjectStore = (db: IDBDatabase, store: IDBStore) => {\r\n      const os = db.createObjectStore(store.name);\r\n      createIndexes(os, store);\r\n    };\r\n\r\n    try {\r\n      var request = indexedDB.open(this.name, this.version);\r\n\r\n      if(!request) {\r\n        return Promise.reject();\r\n      }\r\n    } catch(error) {\r\n      this.log.error('error opening db', (error as Error).message);\r\n      this.storageIsAvailable = false;\r\n      return Promise.reject(error);\r\n    }\r\n\r\n    let finished = false;\r\n    setTimeout(() => {\r\n      if(!finished) {\r\n        request.onerror(makeError('IDB_CREATE_TIMEOUT') as Event);\r\n      }\r\n    }, 3000);\r\n\r\n    return this.openDbPromise = new Promise<IDBDatabase>((resolve, reject) => {\r\n      request.onsuccess = (event) => {\r\n        finished = true;\r\n        const db = request.result;\r\n        let calledNew = false;\r\n\r\n        this.log('Opened');\r\n\r\n        db.onerror = (error) => {\r\n          this.storageIsAvailable = false;\r\n          this.log.error('Error creating/accessing IndexedDB database', error);\r\n          reject(error);\r\n        };\r\n\r\n        db.onclose = (e) => {\r\n          this.log.error('closed:', e);\r\n          !calledNew && this.openDatabase();\r\n        };\r\n\r\n        db.onabort = (e) => {\r\n          this.log.error('abort:', e);\r\n          const transaction = e.target as IDBTransaction;\r\n\r\n          this.openDatabase(calledNew = true);\r\n\r\n          if(transaction.onerror) {\r\n            transaction.onerror(e);\r\n          }\r\n\r\n          db.close();\r\n        };\r\n\r\n        db.onversionchange = (e) => {\r\n          this.log.error('onversionchange, lol?');\r\n        };\r\n\r\n        resolve(this.db = db);\r\n      };\r\n\r\n      request.onerror = (event) => {\r\n        finished = true;\r\n        this.storageIsAvailable = false;\r\n        this.log.error('Error creating/accessing IndexedDB database', event);\r\n        reject(event);\r\n      };\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        finished = true;\r\n        this.log.warn('performing idb upgrade from', event.oldVersion, 'to', event.newVersion);\r\n\r\n        const target = event.target as IDBOpenDBRequest;\r\n        const db = target.result;\r\n        this.stores.forEach((store) => {\r\n          /* if(db.objectStoreNames.contains(store.name)) {\r\n            //if(event.oldVersion === 1) {\r\n              db.deleteObjectStore(store.name);\r\n            //}\r\n          } */\r\n\r\n          if(!db.objectStoreNames.contains(store.name)) {\r\n            createObjectStore(db, store);\r\n          } else {\r\n            const txn = target.transaction;\r\n            const os = txn.objectStore(store.name);\r\n            createIndexes(os, store);\r\n          }\r\n        });\r\n      };\r\n    });\r\n  }\r\n\r\n  public static create<T extends Database<any>>(db: T) {\r\n    return this.INSTANCES.find((instance) => instance.name === db.name) ?? new IDB(db);\r\n  }\r\n\r\n  public static closeDatabases(preserve?: IDB) {\r\n    this.INSTANCES.forEach((storage) => {\r\n      if(preserve && preserve === storage) {\r\n        return;\r\n      }\r\n\r\n      const db = storage.db;\r\n      if(db) {\r\n        db.onclose = () => {};\r\n        db.close();\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default class IDBStorage<T extends Database<any>, StoreName extends string = T['stores'][0]['name']> {\r\n  private log: ReturnType<typeof logger>;\r\n  private storeName: T['stores'][0]['name'];\r\n  private idb: IDB;\r\n\r\n  constructor(db: T, storeName: typeof db['stores'][0]['name']) {\r\n    this.storeName = storeName;\r\n    this.log = logger(['IDB', db.name, storeName].join('-'));\r\n    this.idb = IDB.create(db);\r\n  }\r\n\r\n  /**\r\n   * ! WARNING ! function requires at least one opened connection\r\n   */\r\n  /* public static clearObjectStores() {\r\n    const storage = this.STORAGES[0];\r\n    this.closeDatabases(storage);\r\n\r\n    const names = Array.from(storage.db.objectStoreNames);\r\n    const promises = names.map((name) => storage.clear(name));\r\n    return Promise.all(promises);\r\n  } */\r\n\r\n  /* public static deleteDatabase() {\r\n    this.closeDatabases();\r\n\r\n    const storages = this.STORAGES;\r\n    const dbNames = Array.from(new Set(storages.map((storage) => storage.name)));\r\n    const promises = dbNames.map((dbName) => {\r\n      return new Promise<void>((resolve, reject) => {\r\n        const deleteRequest = indexedDB.deleteDatabase(dbName);\r\n\r\n        deleteRequest.onerror = () => {\r\n          reject();\r\n        };\r\n\r\n        deleteRequest.onsuccess = () => {\r\n          resolve();\r\n        };\r\n      });\r\n    });\r\n\r\n    return Promise.all(promises);\r\n  } */\r\n\r\n  public delete(entryName: string | string[], storeName?: StoreName): Promise<void> {\r\n    // return Promise.resolve();\r\n    if(!Array.isArray(entryName)) {\r\n      entryName = [].concat(entryName);\r\n    }\r\n\r\n    return this.getObjectStore('readwrite', (objectStore) => {\r\n      return (entryName as string[]).map((entryName) => objectStore.delete(entryName));\r\n    }, DEBUG ? 'delete: ' + entryName.join(', ') : '', storeName);\r\n  }\r\n\r\n  public clear(storeName?: StoreName): Promise<void> {\r\n    return this.getObjectStore('readwrite', (objectStore) => objectStore.clear(), DEBUG ? 'clear' : '', storeName);\r\n  }\r\n\r\n  public save(entryName: string | string[], value: any | any[], storeName?: StoreName) {\r\n    // const handleError = (error: Error) => {\r\n    //   this.log.error('save: transaction error:', entryName, value, db, error, error && error.name);\r\n    //   if((!error || error.name === 'InvalidStateError')/*  && false */) {\r\n    //     setTimeout(() => {\r\n    //       this.save(entryName, value);\r\n    //     }, 2e3);\r\n    //   } else {\r\n    //     //console.error('IndexedDB saveFile transaction error:', error, error && error.name);\r\n    //   }\r\n    // };\r\n\r\n    if(!Array.isArray(entryName)) {\r\n      entryName = [].concat(entryName);\r\n      value = [].concat(value);\r\n    }\r\n\r\n    return this.getObjectStore('readwrite', (objectStore) => {\r\n      return (entryName as string[]).map((entryName, idx) => objectStore.put(value[idx], entryName));\r\n    }, DEBUG ? 'save: ' + entryName.join(', ') : '', storeName);\r\n  }\r\n\r\n  // public saveFile(fileName: string, blob: Blob | Uint8Array) {\r\n  //   //return Promise.resolve(blobConstruct([blob]));\r\n  //   if(!(blob instanceof Blob)) {\r\n  //     blob = blobConstruct(blob);\r\n  //   }\r\n\r\n  //   return this.save(fileName, blob);\r\n  // }\r\n\r\n  /* public saveFileBase64(db: IDBDatabase, fileName: string, blob: Blob | any): Promise<Blob> {\r\n    if(this.getBlobSize(blob) > 10 * 1024 * 1024) {\r\n      return Promise.reject();\r\n    }\r\n\r\n    if(!(blob instanceof Blob)) {\r\n      var safeMimeType = blobSafeMimeType(blob.type || 'image/jpeg');\r\n      var address = 'data:' + safeMimeType + ';base64,' + bytesToBase64(blob);\r\n      return this.storagePutB64String(db, fileName, address).then(() => {\r\n        return blob;\r\n      });\r\n    }\r\n\r\n    try {\r\n      var reader = new FileReader();\r\n    } catch (e) {\r\n      this.storageIsAvailable = false;\r\n      return Promise.reject();\r\n    }\r\n\r\n    let promise = new Promise<Blob>((resolve, reject) => {\r\n      reader.onloadend = () => {\r\n        this.storagePutB64String(db, fileName, reader.result as string).then(() => {\r\n          resolve(blob);\r\n        }, reject);\r\n      }\r\n\r\n      reader.onerror = reject;\r\n    });\r\n\r\n\r\n    try {\r\n      reader.readAsDataURL(blob);\r\n    } catch (e) {\r\n      this.storageIsAvailable = false;\r\n      return Promise.reject();\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  public storagePutB64String(db: IDBDatabase, fileName: string, b64string: string) {\r\n    try {\r\n      var objectStore = db.transaction([this.storeName], 'readwrite')\r\n        .objectStore(this.storeName);\r\n      var request = objectStore.put(b64string, fileName);\r\n    } catch(error) {\r\n      this.storageIsAvailable = false;\r\n      return Promise.reject(error);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      request.onsuccess = function(event) {\r\n        resolve();\r\n      };\r\n\r\n      request.onerror = reject;\r\n    });\r\n  }\r\n\r\n  public getBlobSize(blob: any) {\r\n    return blob.size || blob.byteLength || blob.length;\r\n  } */\r\n\r\n  public get<T>(entryName: string[], storeName?: StoreName): Promise<T[]>;\r\n  public get<T>(entryName: string, storeName?: StoreName): Promise<T>;\r\n  public get<T>(entryName: string | string[], storeName?: StoreName): Promise<T> | Promise<T[]> {\r\n    // return Promise.reject();\r\n\r\n    if(!Array.isArray(entryName)) {\r\n      entryName = [].concat(entryName);\r\n    }\r\n\r\n    if(!entryName.length) {\r\n      return Promise.resolve([]) as any;\r\n    }\r\n\r\n    return this.getObjectStore<T>('readonly', (objectStore) => {\r\n      return (entryName as string[]).map((entryName) => objectStore.get(entryName));\r\n    }, DEBUG ? 'get: ' + entryName.join(', ') : '', storeName);\r\n  }\r\n\r\n  private getObjectStore<T>(\r\n    mode: IDBTransactionMode,\r\n    callback: (objectStore: IDBObjectStore) => IDBRequest | IDBRequest[],\r\n    log?: string,\r\n    storeName = this.storeName\r\n  ) {\r\n    let perf: number;\r\n\r\n    if(log) {\r\n      perf = performance.now();\r\n      this.log(log + ': start');\r\n    }\r\n\r\n    return this.idb.openDatabase().then((db) => {\r\n      return new Promise<T>((resolve, reject) => {\r\n        /* if(mode === 'readwrite') {\r\n          return;\r\n        } */\r\n\r\n        const transaction = db.transaction([storeName], mode);\r\n\r\n        const onError = () => {\r\n          clearTimeout(timeout);\r\n          reject(transaction.error);\r\n        };\r\n\r\n        // let resolved = false;\r\n        const onComplete = (/* what: string */) => {\r\n          clearTimeout(timeout);\r\n\r\n          if(log) {\r\n            this.log(log + ': end', performance.now() - perf/* , what */);\r\n          }\r\n\r\n          // if(resolved) {\r\n          //   return;\r\n          // }\r\n\r\n          // resolved = true;\r\n          const results = requests.map((r) => r.result);\r\n          resolve(isArray ? results : results[0]);\r\n        };\r\n\r\n        transaction.onerror = onError;\r\n\r\n        // * have to wait while clearing or setting something\r\n        const waitForTransactionComplete = mode === 'readwrite';\r\n        if(waitForTransactionComplete) {\r\n          transaction.oncomplete = () => onComplete(/* 'transaction' */);\r\n        }\r\n\r\n        const timeout = setTimeout(() => {\r\n          this.log.error('transaction not finished', transaction, log);\r\n        }, 10000);\r\n\r\n        /* transaction.addEventListener('abort', (e) => {\r\n          //handleError();\r\n          this.log.error('IndexedDB: transaction abort!', transaction.error);\r\n        }); */\r\n\r\n        const callbackResult = callback(transaction.objectStore(storeName));\r\n\r\n        const isArray = Array.isArray(callbackResult);\r\n        const requests: IDBRequest[] = isArray ? callbackResult : [].concat(callbackResult) as any;\r\n\r\n        if(waitForTransactionComplete) {\r\n          return;\r\n        }\r\n\r\n        const length = requests.length;\r\n        let left = length;\r\n\r\n        const onRequestFinished = () => {\r\n          if(transaction.error) {\r\n            return;\r\n          }\r\n\r\n          if(!--left) {\r\n            onComplete(/* 'requests' */);\r\n          }\r\n        };\r\n\r\n        for(let i = 0; i < length; ++i) {\r\n          const request = requests[i];\r\n          request.onerror = onError;\r\n          request.onsuccess = onRequestFinished;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  public getAll<T>(storeName?: StoreName): Promise<T[]> {\r\n    return this.getObjectStore<T[]>('readonly', (objectStore) => objectStore.getAll(), DEBUG ? 'getAll' : '', storeName);\r\n  }\r\n\r\n  /* public getAllKeys(): Promise<Array<string>> {\r\n    console.time('getAllEntries');\r\n    return this.openDatabase().then((db) => {\r\n      var objectStore = db.transaction([this.storeName], 'readonly')\r\n        .objectStore(this.storeName);\r\n      var request = objectStore.getAllKeys();\r\n\r\n      return new Promise((resolve, reject) => {\r\n        request.onsuccess = function(event) {\r\n          // @ts-ignore\r\n          var result = event.target.result;\r\n          resolve(result);\r\n          console.timeEnd('getAllEntries');\r\n        }\r\n\r\n        request.onerror = reject;\r\n      });\r\n    });\r\n  } */\r\n\r\n  /* public isFileExists(fileName: string): Promise<boolean> {\r\n    console.time('isFileExists');\r\n    return this.openDatabase().then((db) => {\r\n      var objectStore = db.transaction([this.storeName], 'readonly')\r\n        .objectStore(this.storeName);\r\n      var request = objectStore.openCursor(fileName);\r\n\r\n      return new Promise((resolve, reject) => {\r\n        request.onsuccess = function(event) {\r\n          // @ts-ignore\r\n          var cursor = event.target.result;\r\n          resolve(!!cursor);\r\n          console.timeEnd('isFileExists');\r\n        }\r\n\r\n        request.onerror = reject;\r\n      });\r\n    });\r\n  } */\r\n\r\n  /* public getFileWriter(fileName: string, mimeType: string) {\r\n    var fakeWriter = FileManager.getFakeFileWriter(mimeType, (blob) => {\r\n      return this.saveFile(fileName, blob);\r\n    });\r\n\r\n    return Promise.resolve(fakeWriter);\r\n  } */\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport type lang from '../lang';\r\nimport type langSign from '../langSign';\r\nimport type {State} from '../config/state';\r\nimport DEBUG, {MOUNT_CLASS_TO} from '../config/debug';\r\nimport {HelpCountriesList, HelpCountry, LangPackDifference, LangPackString} from '../layer';\r\nimport stateStorage from './stateStorage';\r\nimport App from '../config/app';\r\nimport rootScope from './rootScope';\r\nimport {IS_MOBILE} from '../environment/userAgent';\r\nimport deepEqual from '../helpers/object/deepEqual';\r\nimport safeAssign from '../helpers/object/safeAssign';\r\nimport capitalizeFirstLetter from '../helpers/string/capitalizeFirstLetter';\r\nimport matchUrlProtocol from './richTextProcessor/matchUrlProtocol';\r\nimport wrapUrl from './richTextProcessor/wrapUrl';\r\n\r\nexport const langPack: {[actionType: string]: LangPackKey} = {\r\n  'messageActionChatCreate': 'ActionCreateGroup',\r\n  'messageActionChatCreateYou': 'ActionYouCreateGroup',\r\n  'messageActionChatEditTitle': 'ActionChangedTitle',\r\n  'messageActionChatEditPhoto': 'ActionChangedPhoto',\r\n  'messageActionChatEditVideo': 'ActionChangedVideo',\r\n  'messageActionChatDeletePhoto': 'ActionRemovedPhoto',\r\n  'messageActionChatReturn': 'ActionAddUserSelf',\r\n  'messageActionChatReturnYou': 'ActionAddUserSelfYou',\r\n  'messageActionChatJoined': 'ActionAddUserSelfMega',\r\n  'messageActionChatJoinedYou': 'ChannelMegaJoined',\r\n  'messageActionChatAddUser': 'ActionAddUser',\r\n  'messageActionChatAddUsers': 'ActionAddUser',\r\n  'messageActionChatLeave': 'ActionLeftUser',\r\n  'messageActionChatLeaveYou': 'YouLeft',\r\n  'messageActionChatDeleteUser': 'ActionKickUser',\r\n  'messageActionChatJoinedByLink': 'ActionInviteUser',\r\n  'messageActionPinMessage': 'Chat.Service.Group.UpdatedPinnedMessage',\r\n  'messageActionContactSignUp': 'Chat.Service.PeerJoinedTelegram',\r\n  'messageActionChannelCreate': 'ActionCreateChannel',\r\n  'messageActionChannelEditTitle': 'Chat.Service.Channel.UpdatedTitle',\r\n  'messageActionChannelEditPhoto': 'Chat.Service.Channel.UpdatedPhoto',\r\n  'messageActionChannelEditVideo': 'Chat.Service.Channel.UpdatedVideo',\r\n  'messageActionChannelDeletePhoto': 'Chat.Service.Channel.RemovedPhoto',\r\n  'messageActionHistoryClear': 'HistoryCleared',\r\n  'messageActionDiscussionStarted': 'DiscussionStarted',\r\n\r\n  'messageActionChannelMigrateFrom': 'ActionMigrateFromGroup',\r\n\r\n  'messageActionPhoneCall.video_in_ok': 'ChatList.Service.VideoCall.incoming',\r\n  'messageActionPhoneCall.video_out_ok': 'ChatList.Service.VideoCall.outgoing',\r\n  'messageActionPhoneCall.video_missed': 'ChatList.Service.VideoCall.Missed',\r\n  'messageActionPhoneCall.video_cancelled': 'ChatList.Service.VideoCall.Cancelled',\r\n  'messageActionPhoneCall.in_ok': 'ChatList.Service.Call.incoming',\r\n  'messageActionPhoneCall.out_ok': 'ChatList.Service.Call.outgoing',\r\n  'messageActionPhoneCall.missed': 'ChatList.Service.Call.Missed',\r\n  'messageActionPhoneCall.cancelled': 'ChatList.Service.Call.Cancelled',\r\n\r\n  'messageActionGroupCall.started': 'Chat.Service.VoiceChatStarted.Channel',\r\n  'messageActionGroupCall.started_by': 'Chat.Service.VoiceChatStarted',\r\n  'messageActionGroupCall.started_byYou': 'Chat.Service.VoiceChatStartedYou',\r\n  'messageActionGroupCall.ended': 'Chat.Service.VoiceChatFinished.Channel',\r\n  'messageActionGroupCall.ended_by': 'Chat.Service.VoiceChatFinished',\r\n  'messageActionGroupCall.ended_byYou': 'Chat.Service.VoiceChatFinishedYou',\r\n\r\n  'messageActionBotAllowed': 'Chat.Service.BotPermissionAllowed'\r\n};\r\n\r\nexport type LangPackKey = /* string |  */keyof typeof lang | keyof typeof langSign;\r\n\r\nexport type FormatterArgument = string | number | Node | FormatterArgument[];\r\nexport type FormatterArguments = FormatterArgument[];\r\n\r\nexport const UNSUPPORTED_LANG_PACK_KEY: LangPackKey = IS_MOBILE ? 'Message.Unsupported.Mobile' : 'Message.Unsupported.Desktop';\r\n\r\nnamespace I18n {\r\n  export const strings: Map<LangPackKey, LangPackString> = new Map();\r\n  export const countriesList: HelpCountry[] = [];\r\n  let pluralRules: Intl.PluralRules;\r\n\r\n  let cacheLangPackPromise: Promise<LangPackDifference>;\r\n  export let lastRequestedLangCode: string;\r\n  export let lastRequestedNormalizedLangCode: string;\r\n  export let lastAppliedLangCode: string;\r\n  export let requestedServerLanguage = false;\r\n  export let timeFormat: State['settings']['timeFormat'];\r\n\r\n  function setLangCode(langCode: string) {\r\n    lastRequestedLangCode = langCode;\r\n    lastRequestedNormalizedLangCode = langCode.split('-')[0];\r\n  }\r\n\r\n  export function getCacheLangPack(): Promise<LangPackDifference> {\r\n    if(cacheLangPackPromise) return cacheLangPackPromise;\r\n    return cacheLangPackPromise = Promise.all([\r\n      stateStorage.get('langPack') as Promise<LangPackDifference>,\r\n      polyfillPromise\r\n    ]).then(([langPack]) => {\r\n      if(!langPack/*  || true */) {\r\n        return loadLocalLangPack();\r\n      } else if(DEBUG && false) {\r\n        return getLangPack(langPack.lang_code);\r\n      }/*  else if(langPack.appVersion !== App.langPackVersion) {\r\n        return getLangPack(langPack.lang_code);\r\n      } */\r\n\r\n      if(!lastRequestedLangCode) {\r\n        setLangCode(langPack.lang_code);\r\n      }\r\n\r\n      applyLangPack(langPack);\r\n      return langPack;\r\n    }).finally(() => {\r\n      cacheLangPackPromise = undefined;\r\n    });\r\n  }\r\n\r\n  function updateAmPm() {\r\n    if(timeFormat === 'h12') {\r\n      try {\r\n        const dateTimeFormat = getDateTimeFormat({hour: 'numeric', minute: 'numeric', hour12: true});\r\n        const date = new Date();\r\n        date.setHours(0);\r\n        const amText = dateTimeFormat.format(date);\r\n        amPmCache.am = amText.split(' ')[1];\r\n        date.setHours(12);\r\n        const pmText = dateTimeFormat.format(date);\r\n        amPmCache.pm = pmText.split(' ')[1];\r\n      } catch(err) {\r\n        console.error('cannot get am/pm', err);\r\n        amPmCache = {am: 'AM', pm: 'PM'};\r\n      }\r\n    }\r\n  }\r\n\r\n  export function setTimeFormat(\r\n    format: State['settings']['timeFormat'],\r\n    haveToUpdate = !!timeFormat && timeFormat !== format\r\n  ) {\r\n    timeFormat = format;\r\n\r\n    updateAmPm();\r\n\r\n    if(haveToUpdate) {\r\n      cachedDateTimeFormats.clear();\r\n      const elements = Array.from(document.querySelectorAll(`.i18n`)) as HTMLElement[];\r\n      elements.forEach((element) => {\r\n        const instance = weakMap.get(element);\r\n\r\n        if(instance instanceof IntlDateElement) {\r\n          instance.update();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  export function loadLocalLangPack() {\r\n    const defaultCode = App.langPackCode;\r\n    setLangCode(defaultCode);\r\n    return Promise.all([\r\n      import('../lang'),\r\n      import('../langSign'),\r\n      import('../countries')\r\n    ]).then(([lang, langSign, countries]) => {\r\n      const strings: LangPackString[] = [];\r\n      formatLocalStrings(lang.default, strings);\r\n      formatLocalStrings(langSign.default, strings);\r\n\r\n      const langPack: LangPackDifference = {\r\n        _: 'langPackDifference',\r\n        from_version: 0,\r\n        lang_code: defaultCode,\r\n        strings,\r\n        version: 0,\r\n        local: true,\r\n        countries: countries.default\r\n      };\r\n      return saveLangPack(langPack);\r\n    });\r\n  }\r\n\r\n  export function loadLangPack(langCode: string, web?: boolean) {\r\n    requestedServerLanguage = true;\r\n    const managers = rootScope.managers;\r\n    return Promise.all([\r\n      managers.apiManager.invokeApiCacheable('langpack.getLangPack', {\r\n        lang_code: langCode,\r\n        lang_pack: web ? 'web' : App.langPack\r\n      }),\r\n      !web && managers.apiManager.invokeApiCacheable('langpack.getLangPack', {\r\n        lang_code: langCode,\r\n        lang_pack: 'android'\r\n      }),\r\n      import('../lang'),\r\n      import('../langSign'),\r\n      managers.apiManager.invokeApiCacheable('help.getCountriesList', {\r\n        lang_code: langCode,\r\n        hash: 0\r\n      }) as Promise<HelpCountriesList.helpCountriesList>,\r\n      polyfillPromise\r\n    ]);\r\n  }\r\n\r\n  export function getStrings(langCode: string, strings: string[]) {\r\n    return rootScope.managers.apiManager.invokeApi('langpack.getStrings', {\r\n      lang_pack: App.langPack,\r\n      lang_code: langCode,\r\n      keys: strings\r\n    });\r\n  }\r\n\r\n  export function formatLocalStrings(strings: any, pushTo: LangPackString[] = []) {\r\n    for(const i in strings) {\r\n      // @ts-ignore\r\n      const v = strings[i];\r\n      if(typeof(v) === 'string') {\r\n        pushTo.push({\r\n          _: 'langPackString',\r\n          key: i,\r\n          value: v\r\n        });\r\n      } else {\r\n        pushTo.push({\r\n          _: 'langPackStringPluralized',\r\n          key: i,\r\n          ...v\r\n        });\r\n      }\r\n    }\r\n\r\n    return pushTo;\r\n  }\r\n\r\n  export function getLangPack(langCode: string, web?: boolean) {\r\n    setLangCode(langCode);\r\n    return loadLangPack(langCode, web).then(([langPack1, langPack2, localLangPack1, localLangPack2, countries, _]) => {\r\n      let strings: LangPackString[] = [];\r\n\r\n      [localLangPack1, localLangPack2].forEach((l) => {\r\n        formatLocalStrings(l.default as any, strings);\r\n      });\r\n\r\n      strings = strings.concat(...[langPack1.strings, langPack2.strings].filter(Boolean));\r\n\r\n      langPack1.strings = strings;\r\n      langPack1.countries = countries;\r\n      return saveLangPack(langPack1);\r\n    });\r\n  }\r\n\r\n  export function saveLangPack(langPack: LangPackDifference) {\r\n    langPack.appVersion = App.langPackVersion;\r\n\r\n    return stateStorage.set({langPack}).then(() => {\r\n      applyLangPack(langPack);\r\n      return langPack;\r\n    });\r\n  }\r\n\r\n  export const polyfillPromise = (function checkIfPolyfillNeeded() {\r\n    if(typeof(Intl) !== 'undefined' && typeof(Intl.PluralRules) !== 'undefined'/*  && false */) {\r\n      return Promise.resolve();\r\n    } else {\r\n      return import('./pluralPolyfill').then((_Intl) => {\r\n        (window as any).Intl = Object.assign(typeof(Intl) !== 'undefined' ? Intl : {}, _Intl.default);\r\n      });\r\n    }\r\n  })();\r\n\r\n  export function applyLangPack(langPack: LangPackDifference) {\r\n    const currentLangCode = lastRequestedLangCode;\r\n    if(langPack.lang_code !== currentLangCode) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      pluralRules = new Intl.PluralRules(lastRequestedNormalizedLangCode);\r\n    } catch(err) {\r\n      console.error('pluralRules error', err);\r\n      pluralRules = new Intl.PluralRules(lastRequestedNormalizedLangCode.split('-', 1)[0]);\r\n    }\r\n\r\n    try {\r\n      pluralRules = new Intl.PluralRules(langPack.lang_code);\r\n    } catch(err) {\r\n      console.error('pluralRules error', err);\r\n      pluralRules = new Intl.PluralRules(langPack.lang_code.split('-', 1)[0]);\r\n    }\r\n\r\n    strings.clear();\r\n\r\n    for(const string of langPack.strings) {\r\n      strings.set(string.key as LangPackKey, string);\r\n    }\r\n\r\n    if(langPack.countries) {\r\n      countriesList.length = 0;\r\n      countriesList.push(...langPack.countries.countries);\r\n\r\n      langPack.countries.countries.forEach((country) => {\r\n        if(country.name) {\r\n          const langPackKey: any = country.default_name;\r\n          strings.set(langPackKey, {\r\n            _: 'langPackString',\r\n            key: langPackKey,\r\n            value: country.name\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    if(lastAppliedLangCode !== currentLangCode) {\r\n      rootScope.dispatchEvent('language_change', currentLangCode);\r\n      lastAppliedLangCode = currentLangCode;\r\n      cachedDateTimeFormats.clear();\r\n      updateAmPm();\r\n    }\r\n\r\n    const elements = Array.from(document.querySelectorAll(`.i18n`)) as HTMLElement[];\r\n    elements.forEach((element) => {\r\n      const instance = weakMap.get(element);\r\n\r\n      if(instance) {\r\n        instance.update();\r\n      }\r\n    });\r\n  }\r\n\r\n  function pushNextArgument(out: ReturnType<typeof superFormatter>, args: FormatterArguments, indexHolder: {i: number}) {\r\n    const arg = args[indexHolder.i++];\r\n    if(Array.isArray(arg)) {\r\n      out.push(...arg as any);\r\n    } else {\r\n      out.push(arg);\r\n    }\r\n  }\r\n\r\n  export function superFormatter(input: string, args?: FormatterArguments, indexHolder = {i: 0}): Exclude<FormatterArgument, FormatterArgument[]>[] {\r\n    const out: ReturnType<typeof superFormatter> = [];\r\n    const regExp = /(\\*\\*|__)(.+?)\\1|(\\n)|(\\[.+?\\]\\(.*?\\))|un\\d|%\\d\\$.|%./g;\r\n\r\n    let lastIndex = 0;\r\n    input.replace(regExp, (match, p1: any, p2: any, p3: any, p4: string, offset: number, string: string) => {\r\n      // console.table({match, p1, p2, offset, string});\r\n\r\n      out.push(string.slice(lastIndex, offset));\r\n\r\n      if(p1) {\r\n        // offset += p1.length;\r\n        let element: HTMLElement;\r\n        switch(p1) {\r\n          case '**': {\r\n            element = document.createElement('b');\r\n            break;\r\n          }\r\n\r\n          case '__': {\r\n            element = document.createElement('i');\r\n            break;\r\n          }\r\n        }\r\n\r\n        element.append(...superFormatter(p2, args, indexHolder) as any);\r\n        out.push(element);\r\n      } else if(p3) {\r\n        out.push(document.createElement('br'));\r\n      } else if(p4) {\r\n        const idx = p4.lastIndexOf(']');\r\n        const text = p4.slice(1, idx);\r\n\r\n        const url = p4.slice(idx + 2, p4.length - 1);\r\n        let a: HTMLAnchorElement;\r\n        if(url && matchUrlProtocol(url)) {\r\n          a = document.createElement('a');\r\n          const wrappedUrl = wrapUrl(url);\r\n          a.href = wrappedUrl.url;\r\n          if(wrappedUrl.onclick) a.setAttribute('onclick', wrappedUrl.onclick);\r\n          a.target = '_blank';\r\n        } else {\r\n          a = args[indexHolder.i++] as HTMLAnchorElement;\r\n\r\n          if(a instanceof DocumentFragment) { // right after wrapRichText\r\n            a = a.firstChild as any;\r\n          }\r\n\r\n          a.textContent = ''; // reset content\r\n        }\r\n\r\n        a.append(...superFormatter(text, args, indexHolder) as any);\r\n\r\n        out.push(a);\r\n      } else if(args) {\r\n        pushNextArgument(out, args, indexHolder);\r\n      }\r\n\r\n      lastIndex = offset + match.length;\r\n      return '';\r\n    });\r\n\r\n    if(lastIndex !== input.length) {\r\n      out.push(input.slice(lastIndex));\r\n    }\r\n\r\n    return out;\r\n  }\r\n\r\n  export function format(key: LangPackKey, plain: true, args?: FormatterArguments): string;\r\n  export function format(key: LangPackKey, plain?: false, args?: FormatterArguments): ReturnType<typeof superFormatter>;\r\n  export function format(key: LangPackKey, plain = false, args?: FormatterArguments): ReturnType<typeof superFormatter> | string {\r\n    const str = strings.get(key);\r\n    let input: string;\r\n    if(str) {\r\n      if(str._ === 'langPackStringPluralized' && args?.length) {\r\n        let v = args[0] as number | string;\r\n        if(typeof(v) === 'string') v = +v.replace(/\\D/g, '');\r\n        const s = pluralRules.select(v);\r\n        // @ts-ignore\r\n        input = str[s + '_value'] || str['other_value'];\r\n      } else if(str._ === 'langPackString') {\r\n        input = str.value;\r\n      } else {\r\n        // input = '[' + key + ']';\r\n        input = key;\r\n      }\r\n    } else {\r\n      // input = '[' + key + ']';\r\n      input = key;\r\n    }\r\n\r\n    const result = superFormatter(input, args);\r\n    if(plain) { // * let's try a hack now... (don't want to replace []() entity)\r\n      return result.map((item) => item instanceof Node ? item.textContent : item).join('');\r\n    } else {\r\n      return result;\r\n    }\r\n\r\n    /* if(plain) {\r\n      if(args?.length) {\r\n        const regExp = /un\\d|%\\d\\$.|%./g;\r\n        let i = 0;\r\n        input = input.replace(regExp, (match, offset, string) => {\r\n          return '' + args[i++];\r\n        });\r\n      }\r\n\r\n      return input;\r\n    } else {\r\n      return superFormatter(input, args);\r\n    } */\r\n  }\r\n\r\n  export const weakMap: WeakMap<HTMLElement, IntlElementBase<IntlElementBaseOptions>> = new WeakMap();\r\n\r\n  export type IntlElementBaseOptions = {\r\n    element?: HTMLElement,\r\n    property?: 'innerText' | 'innerHTML' | 'placeholder' | 'textContent',\r\n  };\r\n\r\n  abstract class IntlElementBase<Options extends IntlElementBaseOptions> {\r\n    public element: IntlElementBaseOptions['element'];\r\n    public property: IntlElementBaseOptions['property'];\r\n\r\n    constructor(options?: Options) {\r\n      this.element = options?.element || document.createElement('span');\r\n      this.element.classList.add('i18n');\r\n\r\n      this.property = options?.property;\r\n      if(options && ((options as any as IntlElementOptions).key || (options as any as IntlDateElementOptions).date)) {\r\n        this.update(options);\r\n      }\r\n\r\n      weakMap.set(this.element, this);\r\n    }\r\n\r\n    abstract update(options?: Options): void;\r\n  }\r\n\r\n  export type IntlElementOptions = IntlElementBaseOptions & {\r\n    key?: LangPackKey,\r\n    args?: FormatterArguments\r\n  };\r\n  export class IntlElement extends IntlElementBase<IntlElementOptions> {\r\n    public key: IntlElementOptions['key'];\r\n    public args: IntlElementOptions['args'];\r\n\r\n    constructor(options: IntlElementOptions = {}) {\r\n      super({...options, property: options.property ?? 'innerHTML'});\r\n    }\r\n\r\n    public update(options?: IntlElementOptions) {\r\n      safeAssign(this, options);\r\n\r\n      if(this.property === 'innerHTML') {\r\n        this.element.textContent = '';\r\n        this.element.append(...format(this.key, false, this.args) as any);\r\n      } else {\r\n        // @ts-ignore\r\n        const v = this.element[this.property];\r\n        const formatted = format(this.key, true, this.args);\r\n\r\n        // * hasOwnProperty won't work here\r\n        if(v === undefined) this.element.dataset[this.property] = formatted;\r\n        else (this.element as HTMLInputElement)[this.property] = formatted;\r\n      }\r\n    }\r\n\r\n    public compareAndUpdate(options?: IntlElementOptions) {\r\n      if(this.key === options.key && deepEqual(this.args, options.args)) {\r\n        return;\r\n      }\r\n\r\n      return this.update(options);\r\n    }\r\n  }\r\n\r\n  const cachedDateTimeFormats: Map<string, Intl.DateTimeFormat> = new Map();\r\n  function getDateTimeFormat(options: Intl.DateTimeFormatOptions = {}) {\r\n    const json = JSON.stringify(options);\r\n    let dateTimeFormat = cachedDateTimeFormats.get(json);\r\n    if(!dateTimeFormat) {\r\n      dateTimeFormat = new Intl.DateTimeFormat(lastRequestedNormalizedLangCode + '-u-hc-' + timeFormat, options);\r\n      cachedDateTimeFormats.set(json, dateTimeFormat);\r\n    }\r\n\r\n    return dateTimeFormat;\r\n  }\r\n\r\n  export let amPmCache = {am: 'AM', pm: 'PM'};\r\n  export type IntlDateElementOptions = IntlElementBaseOptions & {\r\n    date?: Date,\r\n    options: Intl.DateTimeFormatOptions\r\n  };\r\n  export class IntlDateElement extends IntlElementBase<IntlDateElementOptions> {\r\n    public date: IntlDateElementOptions['date'];\r\n    public options: IntlDateElementOptions['options'];\r\n\r\n    constructor(options: IntlDateElementOptions) {\r\n      super({...options, property: options.property ?? 'textContent'});\r\n    }\r\n\r\n    public update(options?: IntlDateElementOptions) {\r\n      safeAssign(this, options);\r\n\r\n      let text: string;\r\n      if(this.options.hour && this.options.minute && Object.keys(this.options).length === 2/*  && false */) {\r\n        const hours = this.date.getHours();\r\n        text = ('0' + (timeFormat === 'h12' ? (hours % 12) || 12 : hours)).slice(-2) + ':' + ('0' + this.date.getMinutes()).slice(-2);\r\n        // if(this.options.second) {\r\n        //   text += ':' + ('0' + this.date.getSeconds()).slice(-2);\r\n        // }\r\n\r\n        if(timeFormat === 'h12') {\r\n          text += ' ' + (hours < 12 ? amPmCache.am : amPmCache.pm);\r\n        }\r\n      } else {\r\n        // * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Locale/hourCycle#adding_an_hour_cycle_via_the_locale_string\r\n        const dateTimeFormat = getDateTimeFormat(this.options);\r\n        text = capitalizeFirstLetter(dateTimeFormat.format(this.date));\r\n      }\r\n\r\n      (this.element as any)[this.property] = text;\r\n    }\r\n  }\r\n\r\n  export function i18n(key: LangPackKey, args?: FormatterArguments) {\r\n    return new IntlElement({key, args}).element;\r\n  }\r\n\r\n  export function i18n_(options: IntlElementOptions) {\r\n    return new IntlElement(options).element;\r\n  }\r\n\r\n  export function _i18n(element: HTMLElement, key: LangPackKey, args?: FormatterArguments, property?: IntlElementOptions['property']) {\r\n    return new IntlElement({element, key, args, property}).element;\r\n  }\r\n}\r\n\r\nexport {I18n};\r\nexport default I18n;\r\n\r\nconst i18n = I18n.i18n;\r\nexport {i18n};\r\n\r\nconst i18n_ = I18n.i18n_;\r\nexport {i18n_};\r\n\r\nconst _i18n = I18n._i18n;\r\nexport {_i18n};\r\n\r\nexport function joinElementsWith(elements: (Node | string)[], joiner: typeof elements[0] | ((isLast: boolean) => typeof elements[0])) {\r\n  const arr = elements.slice(0, 1);\r\n  for(let i = 1; i < elements.length; ++i) {\r\n    const isLast = (elements.length - 1) === i;\r\n    arr.push(typeof(joiner) === 'function' ? joiner(isLast) : joiner);\r\n    arr.push(elements[i]);\r\n  }\r\n\r\n  return arr;\r\n}\r\n\r\n\r\nexport function join(elements: (Node | string)[], useLast: boolean, plain: true): string;\r\nexport function join(elements: (Node | string)[], useLast?: boolean, plain?: false): (string | Node)[];\r\nexport function join(elements: (Node | string)[], useLast: boolean, plain: boolean): string | (string | Node)[];\r\nexport function join(elements: (Node | string)[], useLast = true, plain?: boolean): string | (string | Node)[] {\r\n  const joined = joinElementsWith(elements, (isLast) => {\r\n    const langPackKey: LangPackKey = isLast && useLast ? 'AutoDownloadSettings.LastDelimeter' : 'AutoDownloadSettings.Delimeter';\r\n    return plain ? I18n.format(langPackKey, true) : i18n(langPackKey);\r\n  });\r\n\r\n  return plain ? joined.join('') : joined;\r\n}\r\n\r\nMOUNT_CLASS_TO.I18n = I18n;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport type {MyDialogFilter} from '../storages/filters';\r\n\r\n/**\r\n * Legacy Webogram's format, don't change dcID to camelCase. date is timestamp\r\n */\r\nexport type UserAuth = {dcID: number | string, date: number, id: PeerId};\r\nexport type REAL_FOLDER_ID = 0 | 1;\r\n\r\nexport const NULL_PEER_ID: PeerId = 0;\r\nexport const REPLIES_PEER_ID: PeerId = 1271266957;\r\nexport const REPLIES_HIDDEN_CHANNEL_ID: ChatId = 777;\r\nexport const SERVICE_PEER_ID: PeerId = 777000;\r\nexport const MUTE_UNTIL = 0x7FFFFFFF;\r\nexport const BOT_START_PARAM = '';\r\nexport const MAX_FILE_SAVE_SIZE = 20 * 1024 * 1024;\r\nexport const THUMB_TYPE_FULL = '';\r\n\r\nexport const FOLDER_ID_ALL: REAL_FOLDER_ID = 0;\r\nexport const FOLDER_ID_ARCHIVE: REAL_FOLDER_ID = 1;\r\nexport const REAL_FOLDERS: Set<number> = new Set([FOLDER_ID_ALL, FOLDER_ID_ARCHIVE]);\r\nexport const START_LOCAL_ID = Math.max(...Array.from(REAL_FOLDERS)) + 1 as MyDialogFilter['localId'];\r\n","import IS_CALL_SUPPORTED from './callSupport';\r\nimport CAN_USE_TRANSFERABLES from './canUseTransferables';\r\nimport IS_CANVAS_FILTER_SUPPORTED from './canvasFilterSupport';\r\nimport IS_EMOJI_SUPPORTED from './emojiSupport';\r\nimport IS_GEOLOCATION_SUPPORTED from './geolocationSupport';\r\nimport IS_GROUP_CALL_SUPPORTED from './groupCallSupport';\r\nimport IMAGE_MIME_TYPES_SUPPORTED from './imageMimeTypesSupport';\r\nimport MEDIA_MIME_TYPES_SUPPORTED from './mediaMimeTypesSupport';\r\nimport IS_MOV_SUPPORTED from './movSupport';\r\nimport IS_PARALLAX_SUPPORTED from './parallaxSupport';\r\nimport IS_SCREEN_SHARING_SUPPORTED from './screenSharingSupport';\r\nimport IS_TOUCH_SUPPORTED from './touchSupport';\r\nimport IS_VIBRATE_SUPPORTED from './vibrateSupport';\r\nimport VIDEO_MIME_TYPES_SUPPORTED from './videoMimeTypesSupport';\r\nimport IS_WEBM_SUPPORTED from './webmSupport';\r\nimport IS_WEBP_SUPPORTED from './webpSupport';\r\nimport IS_WEBRTC_SUPPORTED from './webrtcSupport';\r\nimport * as userAgent from './userAgent';\r\nimport IS_OPUS_SUPPORTED from './opusSupport';\r\nimport IS_SHARED_WORKER_SUPPORTED from './sharedWorkerSupport';\r\nimport IS_APPLE_MX from './appleMx';\r\n\r\nconst ENVIRONMENT = {\r\n  CAN_USE_TRANSFERABLES,\r\n  IS_APPLE_MX,\r\n  IS_CALL_SUPPORTED,\r\n  IS_CANVAS_FILTER_SUPPORTED,\r\n  IS_EMOJI_SUPPORTED,\r\n  IS_GEOLOCATION_SUPPORTED,\r\n  IS_GROUP_CALL_SUPPORTED,\r\n  IS_MOV_SUPPORTED,\r\n  IS_PARALLAX_SUPPORTED,\r\n  IS_SCREEN_SHARING_SUPPORTED,\r\n  IS_TOUCH_SUPPORTED,\r\n  IS_VIBRATE_SUPPORTED,\r\n  IS_OPUS_SUPPORTED,\r\n  IS_SHARED_WORKER_SUPPORTED,\r\n  IS_WEBM_SUPPORTED,\r\n  IS_WEBP_SUPPORTED,\r\n  IS_WEBRTC_SUPPORTED,\r\n  IMAGE_MIME_TYPES_SUPPORTED,\r\n  MEDIA_MIME_TYPES_SUPPORTED,\r\n  VIDEO_MIME_TYPES_SUPPORTED,\r\n  ...userAgent\r\n};\r\n\r\nexport default ENVIRONMENT;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport App from '../../../../config/app';\r\nimport DEBUG from '../../../../config/debug';\r\nimport {AutoDownloadPeerTypeSettings, State, STATE_INIT} from '../../../../config/state';\r\nimport compareVersion from '../../../../helpers/compareVersion';\r\nimport copy from '../../../../helpers/object/copy';\r\nimport validateInitObject from '../../../../helpers/object/validateInitObject';\r\nimport {UserAuth} from '../../../mtproto/mtproto_config';\r\nimport rootScope from '../../../rootScope';\r\nimport stateStorage from '../../../stateStorage';\r\nimport sessionStorage from '../../../sessionStorage';\r\nimport {recordPromiseBound} from '../../../../helpers/recordPromise';\r\n// import RESET_STORAGES_PROMISE from \"../storages/resetStoragesPromise\";\r\nimport {StoragesResults} from '../storages/loadStorages';\r\nimport {logger} from '../../../logger';\r\n\r\nconst REFRESH_EVERY = 24 * 60 * 60 * 1000; // 1 day\r\n// const REFRESH_EVERY = 1e3;\r\n// const REFRESH_EVERY_WEEK = 24 * 60 * 60 * 1000 * 7; // 7 days\r\n\r\nconst STATE_VERSION = STATE_INIT.version;\r\nconst BUILD = STATE_INIT.build;\r\n\r\nconst ALL_KEYS = Object.keys(STATE_INIT) as any as Array<keyof State>;\r\n\r\nconst REFRESH_KEYS: Array<keyof State> = [\r\n  'contactsListCachedTime',\r\n  'stateCreatedTime',\r\n  'maxSeenMsgId',\r\n  'filtersArr'\r\n];\r\n\r\n// const REFRESH_KEYS_WEEK = ['dialogs', 'allDialogsLoaded', 'updates', 'pinnedOrders'] as any as Array<keyof State>;\r\n\r\nasync function loadStateInner() {\r\n  const log = logger('STATE-LOADER');\r\n\r\n  const totalPerf = performance.now();\r\n  const recordPromise = recordPromiseBound(log);\r\n\r\n  const promises = ALL_KEYS.map((key) => recordPromise(stateStorage.get(key), 'state ' + key))\r\n  .concat(\r\n    recordPromise(sessionStorage.get('user_auth'), 'auth'),\r\n    recordPromise(sessionStorage.get('state_id'), 'auth'),\r\n    recordPromise(sessionStorage.get('k_build'), 'auth')\r\n  )\r\n  .concat(recordPromise(stateStorage.get('user_auth'), 'old auth')); // support old webk format\r\n\r\n  const arr = await Promise.all(promises);\r\n  log.warn('promises', performance.now() - totalPerf);\r\n  // await new Promise((resolve) => setTimeout(resolve, 3e3));\r\n  /* const self = this;\r\n  const skipHandleKeys = new Set(['isProxy', 'filters', 'drafts']);\r\n  const getHandler = (path?: string) => {\r\n    return {\r\n      get(target: any, key: any) {\r\n        if(key === 'isProxy') {\r\n          return true;\r\n        }\r\n\r\n        const prop = target[key];\r\n\r\n        if(prop !== undefined && !skipHandleKeys.has(key) && !prop.isProxy && typeof(prop) === 'object') {\r\n          target[key] = new Proxy(prop, getHandler(path || key));\r\n          return target[key];\r\n        }\r\n\r\n        return prop;\r\n      },\r\n      set(target: any, key: any, value: any) {\r\n        console.log('Setting', target, `.${key} to equal`, value, path);\r\n\r\n        target[key] = value;\r\n\r\n        // @ts-ignore\r\n        self.pushToState(path || key, path ? self.state[path] : value, false);\r\n\r\n        return true;\r\n      }\r\n    };\r\n  }; */\r\n\r\n  // const pushed: {key: keyof State, value: State[keyof State]}[] = [];\r\n  const pushedKeys: (keyof State)[] = [];\r\n  const pushToState = <T extends keyof State>(key: T, value: State[T]) => {\r\n    // appStateManager.pushToState(key, value);\r\n    state[key] = value;\r\n    // pushed.push({key, value});\r\n    pushedKeys.push(key);\r\n  };\r\n\r\n  const replaceState = (_state: State) => {\r\n    // pushed.length = 0;\r\n    pushedKeys.length = 0;\r\n    state = _state;\r\n    pushedKeys.push(...Object.keys(state) as any as typeof pushedKeys);\r\n    // state = appStateManager.setState(_state);\r\n    // appStateManager.storage.set(state);\r\n  };\r\n\r\n  // let state: State = appStateManager.setState({} as any);\r\n  let state: State = {} as any;\r\n\r\n  // ! then can't store false values\r\n  for(let i = 0, length = ALL_KEYS.length; i < length; ++i) {\r\n    const key = ALL_KEYS[i];\r\n    const value = arr[i];\r\n    if(value !== undefined) {\r\n      // @ts-ignore\r\n      state[key] = value;\r\n    } else {\r\n      pushToState(key, copy(STATE_INIT[key]));\r\n    }\r\n  }\r\n\r\n  arr.splice(0, ALL_KEYS.length);\r\n\r\n  // * Read auth\r\n  let auth = arr.shift() as UserAuth | number;\r\n  const stateId = arr.shift() as number;\r\n  const sessionBuild = arr.shift() as number;\r\n  const shiftedWebKAuth = arr.shift() as UserAuth | number;\r\n  if(!auth && shiftedWebKAuth) { // support old webk auth\r\n    auth = shiftedWebKAuth;\r\n    const keys: string[] = ['dc', 'server_time_offset', 'xt_instance'];\r\n    for(let i = 1; i <= 5; ++i) {\r\n      keys.push(`dc${i}_server_salt`);\r\n      keys.push(`dc${i}_auth_key`);\r\n    }\r\n\r\n    const values = await Promise.all(keys.map((key) => stateStorage.get(key as any)));\r\n    keys.push('user_auth');\r\n    values.push(typeof(auth) === 'number' || typeof(auth) === 'string' ? {dcID: values[0] || App.baseDcId, date: Date.now() / 1000 | 0, id: auth.toPeerId(false)} as UserAuth : auth);\r\n\r\n    const obj: any = {};\r\n    keys.forEach((key, idx) => {\r\n      obj[key] = values[idx];\r\n    });\r\n\r\n    await sessionStorage.set(obj);\r\n  }\r\n\r\n  /* if(!auth) { // try to read Webogram's session from localStorage\r\n    try {\r\n      const keys = Object.keys(localStorage);\r\n      for(let i = 0; i < keys.length; ++i) {\r\n        const key = keys[i];\r\n        let value: any;\r\n        try {\r\n          value = localStorage.getItem(key);\r\n          value = JSON.parse(value);\r\n        } catch(err) {\r\n          //console.error(err);\r\n        }\r\n\r\n        sessionStorage.set({\r\n          [key as any]: value\r\n        });\r\n      }\r\n\r\n      auth = sessionStorage.getFromCache('user_auth');\r\n    } catch(err) {\r\n      this.log.error('localStorage import error', err);\r\n    }\r\n  } */\r\n\r\n  if(auth) {\r\n    // ! Warning ! DON'T delete this\r\n    state.authState = {_: 'authStateSignedIn'};\r\n    rootScope.dispatchEvent('user_auth', typeof(auth) === 'number' || typeof(auth) === 'string' ?\r\n      {dcID: 0, date: Date.now() / 1000 | 0, id: auth.toPeerId(false)} :\r\n      auth); // * support old version\r\n  }\r\n\r\n  const resetStorages: Set<keyof StoragesResults> = new Set();\r\n  if(state.stateId !== stateId) {\r\n    if(stateId !== undefined) {\r\n      const preserve: Map<keyof State, State[keyof State]> = new Map([\r\n        ['authState', undefined],\r\n        ['stateId', undefined]\r\n      ]);\r\n\r\n      preserve.forEach((_, key) => {\r\n        preserve.set(key, copy(state[key]));\r\n      });\r\n\r\n      state = copy(STATE_INIT);\r\n\r\n      preserve.forEach((value, key) => {\r\n        // @ts-ignore\r\n        state[key] = value;\r\n      });\r\n\r\n      const r: {[k in keyof StoragesResults]: number} = {\r\n        chats: 1,\r\n        dialogs: 1,\r\n        users: 1\r\n      };\r\n      for(const key in r) {\r\n        resetStorages.add(key as keyof StoragesResults);\r\n        // this.storagesResults[key as keyof AppStateManager['storagesResults']].length = 0;\r\n      }\r\n\r\n      replaceState(state);\r\n    }\r\n\r\n    await sessionStorage.set({\r\n      state_id: state.stateId\r\n    });\r\n  }\r\n\r\n  const time = Date.now();\r\n  if((state.stateCreatedTime + REFRESH_EVERY) < time) {\r\n    if(DEBUG) {\r\n      log('will refresh state', state.stateCreatedTime, time);\r\n    }\r\n\r\n    const r = (keys: typeof REFRESH_KEYS) => {\r\n      keys.forEach((key) => {\r\n        pushToState(key, copy(STATE_INIT[key]));\r\n\r\n        // const s = appStateManager.storagesResults[key as keyof AppStateManager['storagesResults']];\r\n        // if(s?.length) {\r\n        // appStateManager.resetStorages.add(key as keyof AppStateManager['storagesResults']);\r\n        // s.length = 0;\r\n        // }\r\n      });\r\n    };\r\n\r\n    r(REFRESH_KEYS);\r\n\r\n    /* if((state.stateCreatedTime + REFRESH_EVERY_WEEK) < time) {\r\n      if(DEBUG) {\r\n        this.log('will refresh updates');\r\n      }\r\n\r\n      r(REFRESH_KEYS_WEEK);\r\n    } */\r\n  }\r\n\r\n  // state = this.state = new Proxy(state, getHandler());\r\n\r\n  // * support old version\r\n  if(!state.settings.hasOwnProperty('theme') && state.settings.hasOwnProperty('nightTheme')) {\r\n    state.settings.theme = state.settings.nightTheme ? 'night' : 'day';\r\n    pushToState('settings', state.settings);\r\n  }\r\n\r\n  // * support old version\r\n  if(!state.settings.hasOwnProperty('themes') && state.settings.background) {\r\n    state.settings.themes = copy(STATE_INIT.settings.themes);\r\n    const theme = state.settings.themes.find((t) => t.name === state.settings.theme);\r\n    if(theme) {\r\n      theme.background = state.settings.background;\r\n      pushToState('settings', state.settings);\r\n    }\r\n  }\r\n\r\n  // * migrate auto download settings\r\n  const autoDownloadSettings = state.settings.autoDownload;\r\n  if(autoDownloadSettings?.private !== undefined) {\r\n    const oldTypes = [\r\n      'contacts' as const,\r\n      'private' as const,\r\n      'groups' as const,\r\n      'channels' as const\r\n    ];\r\n\r\n    const mediaTypes = [\r\n      'photo' as const,\r\n      'video' as const,\r\n      'file' as const\r\n    ];\r\n\r\n    mediaTypes.forEach((mediaType) => {\r\n      const peerTypeSettings: AutoDownloadPeerTypeSettings = autoDownloadSettings[mediaType] = {} as any;\r\n      oldTypes.forEach((peerType) => {\r\n        peerTypeSettings[peerType] = autoDownloadSettings[peerType];\r\n      });\r\n    });\r\n\r\n    oldTypes.forEach((peerType) => {\r\n      delete autoDownloadSettings[peerType];\r\n    });\r\n\r\n    pushToState('settings', state.settings);\r\n  }\r\n\r\n  validateInitObject(STATE_INIT, state, (missingKey) => {\r\n    pushToState(missingKey as keyof State, state[missingKey as keyof State]);\r\n  });\r\n\r\n  let newVersion: string, oldVersion: string;\r\n  if(state.version !== STATE_VERSION || state.build !== BUILD/*  || true */) {\r\n    // reset filters and dialogs if version is older\r\n    if(/* compareVersion(state.version, '0.8.7') === -1 || state.build < 179 ||  */state.build < 217) {\r\n      state.allDialogsLoaded = copy(STATE_INIT.allDialogsLoaded);\r\n      state.pinnedOrders = copy(STATE_INIT.pinnedOrders);\r\n      state.filtersArr = copy(STATE_INIT.filtersArr);\r\n\r\n      resetStorages.add('dialogs');\r\n    }\r\n\r\n    // * migrate backgrounds (March 13, 2022; to version 1.3.0)\r\n    if(compareVersion(state.version, '1.3.0') === -1) {\r\n      let migrated = false;\r\n      state.settings.themes.forEach((theme, idx, arr) => {\r\n        if((\r\n          theme.name === 'day' &&\r\n          theme.background.slug === 'ByxGo2lrMFAIAAAAmkJxZabh8eM' &&\r\n          theme.background.type === 'image'\r\n        ) || (\r\n          theme.name === 'night' &&\r\n          theme.background.color === '#0f0f0f' &&\r\n          theme.background.type === 'color'\r\n        )) {\r\n          const newTheme = STATE_INIT.settings.themes.find((newTheme) => newTheme.name === theme.name);\r\n          if(newTheme) {\r\n            arr[idx] = copy(newTheme);\r\n            migrated = true;\r\n          }\r\n        }\r\n      });\r\n\r\n      if(migrated) {\r\n        pushToState('settings', state.settings);\r\n      }\r\n    }\r\n\r\n    if(compareVersion(state.version, STATE_VERSION) !== 0) {\r\n      newVersion = STATE_VERSION;\r\n      oldVersion = state.version;\r\n    }\r\n\r\n    pushToState('version', STATE_VERSION);\r\n    pushToState('build', BUILD);\r\n  }\r\n\r\n  if(sessionBuild !== BUILD && (!sessionBuild || sessionBuild < BUILD)) {\r\n    sessionStorage.set({k_build: BUILD});\r\n  }\r\n\r\n  // ! probably there is better place for it\r\n  rootScope.settings = state.settings;\r\n\r\n  if(DEBUG) {\r\n    log('state res', state, copy(state));\r\n  }\r\n\r\n  // return resolve();\r\n\r\n  log.warn('total', performance.now() - totalPerf);\r\n\r\n  // RESET_STORAGES_PROMISE.resolve(appStateManager.resetStorages);\r\n\r\n  return {state, resetStorages, newVersion, oldVersion, pushedKeys};\r\n}\r\n\r\nlet promise: ReturnType<typeof loadStateInner>;\r\nexport default function loadState() {\r\n  return promise ??= loadStateInner();\r\n}\r\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {Awaited} from '../../types';\nimport type {CacheStorageDbName} from '../files/cacheStorage';\nimport type {State} from '../../config/state';\nimport type {Message, MessagePeerReaction, PeerNotifySettings} from '../../layer';\nimport {CryptoMethods} from '../crypto/crypto_methods';\nimport rootScope from '../rootScope';\nimport webpWorkerController from '../webp/webpWorkerController';\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport sessionStorage from '../sessionStorage';\nimport webPushApiManager from './webPushApiManager';\nimport appRuntimeManager from '../appManagers/appRuntimeManager';\nimport telegramMeWebManager from './telegramMeWebManager';\nimport pause from '../../helpers/schedulers/pause';\nimport ENVIRONMENT from '../../environment';\nimport loadState from '../appManagers/utils/state/loadState';\nimport opusDecodeController from '../opusDecodeController';\nimport MTProtoMessagePort from './mtprotoMessagePort';\nimport cryptoMessagePort from '../crypto/cryptoMessagePort';\nimport SuperMessagePort from './superMessagePort';\nimport IS_SHARED_WORKER_SUPPORTED from '../../environment/sharedWorkerSupport';\nimport toggleStorages from '../../helpers/toggleStorages';\nimport idleController from '../../helpers/idleController';\nimport ServiceMessagePort from '../serviceWorker/serviceMessagePort';\nimport App from '../../config/app';\nimport deferredPromise, {CancellablePromise} from '../../helpers/cancellablePromise';\n\nexport type Mirrors = {\n  state: State\n};\n\nexport type MirrorTaskPayload<T extends keyof Mirrors = keyof Mirrors, K extends keyof Mirrors[T] = keyof Mirrors[T], J extends Mirrors[T][K] = Mirrors[T][K]> = {\n  name: T,\n  key?: K,\n  value: any\n};\n\nexport type NotificationBuildTaskPayload = {\n  message: Message.message | Message.messageService,\n  fwdCount?: number,\n  peerReaction?: MessagePeerReaction,\n  peerTypeNotifySettings?: PeerNotifySettings\n};\n\nexport type TabState = {\n  chatPeerIds: PeerId[],\n  idleStartTime: number,\n};\n\nclass ApiManagerProxy extends MTProtoMessagePort {\n  // private worker: /* Window */Worker;\n  // private sockets: Map<number, Socket> = new Map();\n  private mirrors: Mirrors;\n\n  public newVersion: string;\n  public oldVersion: string;\n\n  private tabState: TabState;\n\n  public serviceMessagePort: ServiceMessagePort<true>;\n  private lastServiceWorker: ServiceWorker;\n\n  private pingServiceWorkerPromise: CancellablePromise<void>;\n\n  constructor() {\n    super();\n\n    this.mirrors = {} as any;\n    this.tabState = {\n      chatPeerIds: [],\n      idleStartTime: 0\n    };\n\n    this.log('constructor');\n\n                      \n    this.registerWorker();\n             \n\n    this.registerServiceWorker();\n    this.registerCryptoWorker();\n\n    // const perf = performance.now();\n    this.addMultipleEventsListeners({\n      convertWebp: ({fileName, bytes}) => {\n        return webpWorkerController.convert(fileName, bytes);\n      },\n\n      convertOpus: ({fileName, bytes}) => {\n        return opusDecodeController.pushDecodeTask(bytes, false).then((result) => result.bytes);\n      },\n\n      event: ({name, args}) => {\n        // @ts-ignore\n        rootScope.dispatchEventSingle(name, ...args);\n      },\n\n      localStorageProxy: (payload) => {\n        const storageTask = payload;\n        return (sessionStorage[storageTask.type] as any)(...storageTask.args);\n      },\n\n      mirror: this.onMirrorTask\n\n      // hello: () => {\n      //   this.log.error('time hello', performance.now() - perf);\n      // }\n    });\n\n    // this.addTaskListener('socketProxy', (task) => {\n    //   const socketTask = task.payload;\n    //   const id = socketTask.id;\n    //   //console.log('socketProxy', socketTask, id);\n\n    //   if(socketTask.type === 'send') {\n    //     const socket = this.sockets.get(id);\n    //     socket.send(socketTask.payload);\n    //   } else if(socketTask.type === 'close') { // will remove from map in onClose\n    //     const socket = this.sockets.get(id);\n    //     socket.close();\n    //   } else if(socketTask.type === 'setup') {\n    //     const socket = new Socket(socketTask.payload.dcId, socketTask.payload.url, socketTask.payload.logSuffix);\n\n    //     const onOpen = () => {\n    //       //console.log('socketProxy onOpen');\n    //       this.postMessage({\n    //         type: 'socketProxy',\n    //         payload: {\n    //           type: 'open',\n    //           id\n    //         }\n    //       });\n    //     };\n    //     const onClose = () => {\n    //       this.postMessage({\n    //         type: 'socketProxy',\n    //         payload: {\n    //           type: 'close',\n    //           id\n    //         }\n    //       });\n\n    //       socket.removeEventListener('open', onOpen);\n    //       socket.removeEventListener('close', onClose);\n    //       socket.removeEventListener('message', onMessage);\n    //       this.sockets.delete(id);\n    //     };\n    //     const onMessage = (buffer: ArrayBuffer) => {\n    //       this.postMessage({\n    //         type: 'socketProxy',\n    //         payload: {\n    //           type: 'message',\n    //           id,\n    //           payload: buffer\n    //         }\n    //       });\n    //     };\n\n    //     socket.addEventListener('open', onOpen);\n    //     socket.addEventListener('close', onClose);\n    //     socket.addEventListener('message', onMessage);\n    //     this.sockets.set(id, socket);\n    //   }\n    // });\n\n    rootScope.addEventListener('language_change', (language) => {\n      rootScope.managers.networkerFactory.setLanguage(language);\n    });\n\n    window.addEventListener('online', () => {\n      rootScope.managers.networkerFactory.forceReconnectTimeout();\n    });\n\n    rootScope.addEventListener('logging_out', () => {\n      const toClear: CacheStorageDbName[] = ['cachedFiles', 'cachedStreamChunks'];\n      Promise.all([\n        toggleStorages(false, true),\n        sessionStorage.clear(),\n        Promise.race([\n          telegramMeWebManager.setAuthorized(false),\n          pause(3000)\n        ]),\n        webPushApiManager.forceUnsubscribe(),\n        Promise.all(toClear.map((cacheName) => caches.delete(cacheName)))\n      ]).finally(() => {\n        appRuntimeManager.reload();\n      });\n    });\n\n    idleController.addEventListener('change', (idle) => {\n      this.updateTabStateIdle(idle);\n    });\n    this.updateTabStateIdle(idleController.isIdle);\n\n    this.log('Passing environment:', ENVIRONMENT);\n    this.invoke('environment', ENVIRONMENT);\n    // this.sendState();\n  }\n\n  public pingServiceWorkerWithIframe() {\n    if(this.pingServiceWorkerPromise) {\n      return this.pingServiceWorkerPromise;\n    }\n\n    const promise = this.pingServiceWorkerPromise = deferredPromise<void>();\n    const iframe = document.createElement('iframe');\n    iframe.hidden = true;\n    const onLoad = () => {\n      setTimeout(() => { // ping once in 10 seconds\n        this.pingServiceWorkerPromise = undefined;\n      }, 10e3);\n\n      clearTimeout(timeout);\n      iframe.remove();\n      iframe.removeEventListener('load', onLoad);\n      iframe.removeEventListener('error', onLoad);\n      promise.resolve();\n    };\n    iframe.addEventListener('load', onLoad);\n    iframe.addEventListener('error', onLoad);\n    iframe.src = 'ping/' + (Math.random() * 0xFFFFFFFF | 0);\n    document.body.append(iframe);\n\n    const timeout = window.setTimeout(onLoad, 1e3);\n    return promise;\n  }\n\n  private attachServiceWorker(serviceWorker: ServiceWorker) {\n    this.lastServiceWorker && this.serviceMessagePort.detachPort(this.lastServiceWorker);\n    this.serviceMessagePort.attachSendPort(this.lastServiceWorker = serviceWorker);\n    this.serviceMessagePort.invokeVoid('hello', undefined);\n  }\n\n  private _registerServiceWorker() {\n    navigator.serviceWorker.register(\n      /* webpackChunkName: \"sw\" */\n      new URL('../serviceWorker/index.service', import.meta.url),\n      {scope: './'}\n    ).then((registration) => {\n      this.log('SW registered', registration);\n\n      // ! doubtful fix for hard refresh\n      if(registration.active && !navigator.serviceWorker.controller) {\n        return registration.unregister().then(() => {\n          window.location.reload();\n        });\n      }\n\n      const sw = registration.installing || registration.waiting || registration.active;\n      sw.addEventListener('statechange', (e) => {\n        this.log('SW statechange', e);\n      });\n\n      const controller = navigator.serviceWorker.controller || registration.installing || registration.waiting || registration.active;\n      this.attachServiceWorker(controller);\n\n                       \n                                            \n               \n    }, (err) => {\n      this.log.error('SW registration failed!', err);\n\n      this.invokeVoid('serviceWorkerOnline', false);\n    });\n  }\n\n  private registerServiceWorker() {\n    if(!('serviceWorker' in navigator)) return;\n\n    this.serviceMessagePort = new ServiceMessagePort<true>();\n\n    // this.addMultipleEventsListeners({\n    //   hello: () => {\n    //     // this.serviceMessagePort.invokeVoid('port', undefined);\n    //   }\n    // });\n\n    // ! I hate webpack - it won't load it by using worker.register, only navigator.serviceWorker will do it.\n    const worker = navigator.serviceWorker;\n    this._registerServiceWorker();\n\n    // worker.startMessages();\n\n    worker.addEventListener('controllerchange', () => {\n      this.log.warn('controllerchange');\n\n      const controller = worker.controller;\n      this.attachServiceWorker(controller);\n\n      controller.addEventListener('error', (e) => {\n        this.log.error('controller error:', e);\n      });\n    });\n\n                     \n                                  \n            \n    this.serviceMessagePort.attachListenPort(worker);\n    this.serviceMessagePort.addMultipleEventsListeners({\n      port: (payload, source, event) => {\n        this.invokeVoid('serviceWorkerPort', undefined, undefined, [event.ports[0]]);\n      },\n\n      hello: (payload, source) => {\n        this.serviceMessagePort.resendLockTask(source);\n      }\n    });\n             \n\n    worker.addEventListener('messageerror', (e) => {\n      this.log.error('SW messageerror:', e);\n    });\n  }\n\n  private async registerCryptoWorker() {\n    const get = (url: string) => {\n      return fetch(url).then((response) => response.text()).then((text) => {\n        const pathnameSplitted = location.pathname.split('/');\n        pathnameSplitted[pathnameSplitted.length - 1] = '';\n        const pre = location.origin + pathnameSplitted.join('/');\n        text = `\n        var originalImportScripts = importScripts; \n        importScripts = (url) => {\n          console.log('importScripts', url);\n          var newUrl = '${pre}' + url.split('/').pop();\n          return originalImportScripts(newUrl);\n        };\n        ${text}`;\n        const blob = new Blob([text], {type: 'application/javascript'});\n        return blob;\n      });\n    };\n\n    const workerHandler = {\n      construct(target: any, args: any): any {\n        const url = args[0] + location.search;\n        return {url};\n      }\n    };\n\n    const originals = [\n      Worker,\n      typeof(SharedWorker) !== 'undefined' && SharedWorker\n    ].filter(Boolean);\n    originals.forEach((w) => window[w.name as any] = new Proxy(w, workerHandler));\n\n    const worker: SharedWorker | Worker = new Worker(\n      /* webpackChunkName: \"crypto.worker\" */\n      new URL('../crypto/crypto.worker.ts', import.meta.url),\n      {type: 'module'}\n    );\n\n    originals.forEach((w) => window[w.name as any] = w as any);\n\n    const originalUrl = (worker as any).url;\n\n    const createWorker = (url: string) => new constructor(url, {type: 'module'});\n    const attachWorkerToPort = (worker: SharedWorker | Worker) => this.attachWorkerToPort(worker, cryptoMessagePort, 'crypto');\n    const constructor = IS_SHARED_WORKER_SUPPORTED ? SharedWorker : Worker;\n\n    // let cryptoWorkers = workers.length;\n    cryptoMessagePort.addEventListener('port', (payload, source, event) => {\n      this.invokeVoid('cryptoPort', undefined, undefined, [event.ports[0]]);\n      // .then((attached) => {\n      //   if(!attached && cryptoWorkers-- > 1) {\n      //     this.log.error('terminating unneeded crypto worker');\n\n      //     cryptoMessagePort.invokeVoid('terminate', undefined, source);\n      //     const worker = workers.find((worker) => (worker as SharedWorker).port === source || (worker as any) === source);\n      //     if((worker as SharedWorker).port) (worker as SharedWorker).port.close();\n      //     else (worker as Worker).terminate();\n      //     cryptoMessagePort.detachPort(source);\n      //   }\n      // });\n    });\n\n    const firstWorker = createWorker(originalUrl);\n    attachWorkerToPort(firstWorker);\n\n    const blob = await get(originalUrl);\n    const urlsPromise = await this.invoke('createProxyWorkerURLs', {originalUrl, blob});\n    const workers = urlsPromise.slice(1).map(createWorker);\n    workers.forEach(attachWorkerToPort);\n  }\n\n                    \n  private registerWorker() {\n    // return;\n\n    let worker: SharedWorker | Worker;\n    if(IS_SHARED_WORKER_SUPPORTED) {\n      worker = new SharedWorker(\n        /* webpackChunkName: \"mtproto.worker\" */\n        new URL('./mtproto.worker.ts', import.meta.url),\n        {type: 'module'}\n      );\n    } else {\n      worker = new Worker(\n        /* webpackChunkName: \"mtproto.worker\" */\n        new URL('./mtproto.worker.ts', import.meta.url),\n        {type: 'module'}\n      );\n    }\n\n    this.onWorkerFirstMessage(worker);\n  }\n           \n\n  private attachWorkerToPort(worker: SharedWorker | Worker, messagePort: SuperMessagePort<any, any, any>, type: string) {\n    const port: MessagePort = (worker as SharedWorker).port || worker as any;\n    messagePort.attachPort(port);\n\n    worker.addEventListener('error', (err) => {\n      this.log.error(type, 'worker error', err);\n    });\n  }\n\n  private onWorkerFirstMessage(worker: any) {\n    this.log('set webWorker');\n\n    // this.worker = worker;\n                     \n                                \n            \n    this.attachWorkerToPort(worker, this, 'mtproto');\n             \n  }\n\n  private loadState() {\n    return Promise.all([\n      loadState().then((stateResult) => {\n        this.newVersion = stateResult.newVersion;\n        this.oldVersion = stateResult.oldVersion;\n        this.mirrors['state'] = stateResult.state;\n        return stateResult;\n      })\n      // loadStorages(createStorages()),\n    ]);\n  }\n\n  public sendState() {\n    return this.loadState().then((result) => {\n      const [stateResult] = result;\n      this.invoke('state', {...stateResult, userId: rootScope.myId.toUserId()});\n      return result;\n    });\n  }\n\n                       \n  public invokeCrypto<Method extends keyof CryptoMethods>(method: Method, ...args: Parameters<CryptoMethods[typeof method]>): Promise<Awaited<ReturnType<CryptoMethods[typeof method]>>> {\n    return cryptoMessagePort.invokeCrypto(method, ...args);\n  }\n           \n\n  public async toggleStorages(enabled: boolean, clearWrite: boolean) {\n    await toggleStorages(enabled, clearWrite);\n    this.invoke('toggleStorages', {enabled, clearWrite});\n    this.serviceMessagePort.invokeVoid('toggleStorages', {enabled, clearWrite});\n  }\n\n  public async getMirror<T extends keyof Mirrors>(name: T) {\n    const mirror = this.mirrors[name];\n    return mirror;\n  }\n\n  public getState() {\n    return this.getMirror('state');\n  }\n\n  public updateTabState<T extends keyof TabState>(key: T, value: TabState[T]) {\n    this.tabState[key] = value;\n    this.invokeVoid('tabState', this.tabState);\n  }\n\n  public updateTabStateIdle(idle: boolean) {\n    this.updateTabState('idleStartTime', idle ? Date.now() : 0);\n  }\n\n  private onMirrorTask = (payload: MirrorTaskPayload) => {\n    const {name, key, value} = payload;\n    if(!payload.hasOwnProperty('key')) {\n      this.mirrors[name] = value;\n      return;\n    }\n\n    const mirror = this.mirrors[name] ??= {} as any;\n    if(value === undefined) {\n      delete mirror[key];\n    } else {\n      mirror[key] = value;\n    }\n  };\n}\n\ninterface ApiManagerProxy extends MTProtoMessagePort<true> {}\n\nconst apiManagerProxy = new ApiManagerProxy();\nMOUNT_CLASS_TO.apiManagerProxy = apiManagerProxy;\nexport default apiManagerProxy;\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n *\r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nimport App from '../../config/app';\r\nimport {MOUNT_CLASS_TO} from '../../config/debug';\r\nimport tabId from '../../config/tabId';\r\nimport IS_SHARED_WORKER_SUPPORTED from '../../environment/sharedWorkerSupport';\r\nimport EventListenerBase from '../../helpers/eventListenerBase';\r\nimport idleController from '../../helpers/idleController';\r\nimport {logger} from '../logger';\r\nimport rootScope from '../rootScope';\r\nimport sessionStorage from '../sessionStorage';\r\nimport apiManagerProxy from './mtprotoworker';\r\n\r\nexport type AppInstance = {\r\n  id: number,\r\n  idle: boolean,\r\n  time: number\r\n};\r\n\r\nexport type InstanceDeactivateReason = 'version' | 'tabs';\r\n\r\nconst CHECK_INSTANCE_INTERVAL = 5000;\r\nconst DEACTIVATE_TIMEOUT = 30000;\r\nconst MULTIPLE_TABS_THRESHOLD = 20000;\r\nconst IS_MULTIPLE_TABS_SUPPORTED = IS_SHARED_WORKER_SUPPORTED;\r\n\r\nexport class SingleInstance extends EventListenerBase<{\r\n  activated: () =>  void,\r\n  deactivated: (reason: InstanceDeactivateReason) => void\r\n}> {\r\n  private instanceId: number;\r\n  private started: boolean;\r\n  private masterInstance: boolean;\r\n  private deactivateTimeout: number;\r\n  private deactivated: InstanceDeactivateReason;\r\n  private log = logger('INSTANCE');\r\n\r\n  constructor() {\r\n    super(false);\r\n\r\n    this.log = logger('INSTANCE');\r\n    this.instanceId = tabId;\r\n  }\r\n\r\n  public get deactivatedReason() {\r\n    return this.deactivated;\r\n  }\r\n\r\n  public start() {\r\n    this.reset();\r\n\r\n    if(!this.started/*  && !Config.Navigator.mobile && !Config.Modes.packed */) {\r\n      this.started = true;\r\n\r\n      idleController.addEventListener('change', this.checkInstance);\r\n      setInterval(this.checkInstance, CHECK_INSTANCE_INTERVAL);\r\n      this.checkInstance();\r\n\r\n      try {\r\n        document.documentElement.addEventListener('beforeunload', this.clearInstance);\r\n      } catch(e) {}\r\n    }\r\n  }\r\n\r\n  private reset() {\r\n    this.masterInstance = false;\r\n    this.clearDeactivateTimeout();\r\n    this.deactivated = undefined;\r\n  }\r\n\r\n  private clearInstance = () => {\r\n    if(this.masterInstance && !this.deactivated) {\r\n      this.log.warn('clear master instance');\r\n      sessionStorage.delete('xt_instance');\r\n    }\r\n  };\r\n\r\n  public activateInstance() {\r\n    if(this.deactivated) {\r\n      this.reset();\r\n      this.checkInstance(false);\r\n      this.dispatchEvent('activated');\r\n    }\r\n  }\r\n\r\n  private deactivateInstance(reason: InstanceDeactivateReason) {\r\n    if(this.masterInstance || this.deactivated) {\r\n      return;\r\n    }\r\n\r\n    this.log.warn('deactivate', reason);\r\n    this.clearDeactivateTimeout();\r\n    this.deactivated = reason;\r\n\r\n    this.dispatchEvent('deactivated', reason);\r\n  }\r\n\r\n  private clearDeactivateTimeout() {\r\n    if(this.deactivateTimeout) {\r\n      clearTimeout(this.deactivateTimeout);\r\n      this.deactivateTimeout = 0;\r\n    }\r\n  }\r\n\r\n  private checkInstance = async(idle = idleController.isIdle) => {\r\n    if(this.deactivated) {\r\n      return;\r\n    }\r\n\r\n    const time = Date.now();\r\n    const newInstance: AppInstance = {\r\n      id: this.instanceId,\r\n      idle,\r\n      time\r\n    };\r\n\r\n    const [curInstance, build = App.build] = await Promise.all([\r\n      sessionStorage.get('xt_instance', false),\r\n      sessionStorage.get('k_build', false)\r\n    ]);\r\n\r\n    if(build > App.build) {\r\n      this.masterInstance = false;\r\n      rootScope.managers.networkerFactory.stopAll();\r\n      this.deactivateInstance('version');\r\n      apiManagerProxy.toggleStorages(false, false);\r\n      return;\r\n    } else if(IS_MULTIPLE_TABS_SUPPORTED) {\r\n      sessionStorage.set({xt_instance: newInstance});\r\n      return;\r\n    }\r\n\r\n    // this.log('check instance', newInstance, curInstance)\r\n    if(!idle ||\r\n        !curInstance ||\r\n        curInstance.id === this.instanceId ||\r\n        curInstance.time < (time - MULTIPLE_TABS_THRESHOLD)) {\r\n      sessionStorage.set({xt_instance: newInstance});\r\n\r\n      if(!this.masterInstance) {\r\n        this.masterInstance = true;\r\n        rootScope.managers.networkerFactory.startAll();\r\n        this.log.warn('now master instance', newInstance);\r\n      }\r\n\r\n      this.clearDeactivateTimeout();\r\n    } else if(this.masterInstance) {\r\n      this.masterInstance = false;\r\n      rootScope.managers.networkerFactory.stopAll();\r\n      this.log.warn('now idle instance', newInstance);\r\n      this.deactivateTimeout ||= window.setTimeout(() => this.deactivateInstance('tabs'), DEACTIVATE_TIMEOUT);\r\n    }\r\n  };\r\n}\r\n\r\nconst singleInstance = new SingleInstance();\r\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.singleInstance = singleInstance);\r\nexport default singleInstance;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n *\r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nimport App from '../../config/app';\r\nimport {MOUNT_CLASS_TO} from '../../config/debug';\r\nimport Modes from '../../config/modes';\r\nimport loadScript from '../../helpers/dom/loadScript';\r\nimport tsNow from '../../helpers/tsNow';\r\nimport sessionStorage from '../sessionStorage';\r\n\r\nexport class TelegramMeWebManager {\r\n  private disabled = /* false &&  */(Modes.test || App.domains.indexOf(location.hostname) === -1);\r\n\r\n  public setAuthorized(canRedirect: boolean) {\r\n    if(this.disabled) {\r\n      return;\r\n    }\r\n\r\n    return sessionStorage.get('tgme_sync').then((curValue) => {\r\n      const ts = tsNow(true);\r\n      if(\r\n        canRedirect &&\r\n        curValue?.canRedirect === canRedirect &&\r\n        (curValue.ts + 86400) > ts\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      sessionStorage.set({\r\n        tgme_sync: {\r\n          canRedirect,\r\n          ts\r\n        }\r\n      });\r\n\r\n      const path = `_websync_?authed=${canRedirect ? '1' : '0'}&version=${encodeURIComponent(App.version + ' ' + App.suffix)}`;\r\n      const urls = [\r\n        '//telegram.me/' + path,\r\n        '//t.me/' + path\r\n      ];\r\n\r\n      const promises = urls.map((url) => {\r\n        return loadScript(url).then((script) => {\r\n          script.remove();\r\n        });\r\n      });\r\n\r\n      return Promise.all(promises);\r\n    });\r\n  }\r\n}\r\n\r\nconst telegramMeWebManager = new TelegramMeWebManager();\r\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.telegramMeWebManager = telegramMeWebManager);\r\nexport default telegramMeWebManager;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport default function loadScript(url: string) {\r\n  const script = document.createElement('script');\r\n  const promise = new Promise<HTMLScriptElement>((resolve) => {\r\n    script.onload = script.onerror = () => {\r\n      resolve(script);\r\n    };\r\n  });\r\n  script.src = url;\r\n  document.body.appendChild(script);\r\n  return promise;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n *\r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nimport type {PushNotificationObject} from '../serviceWorker/push';\r\nimport type {ServicePushPingTaskPayload} from '../serviceWorker/serviceMessagePort';\r\nimport type {NotificationSettings} from '../appManagers/uiNotificationsManager';\r\nimport {MOUNT_CLASS_TO} from '../../config/debug';\r\nimport {logger} from '../logger';\r\nimport apiManagerProxy from './mtprotoworker';\r\nimport I18n, {LangPackKey} from '../langPack';\r\nimport {IS_MOBILE} from '../../environment/userAgent';\r\nimport appRuntimeManager from '../appManagers/appRuntimeManager';\r\nimport copy from '../../helpers/object/copy';\r\nimport singleInstance from './singleInstance';\r\nimport EventListenerBase from '../../helpers/eventListenerBase';\r\n\r\nexport type PushSubscriptionNotifyType = 'init' | 'subscribe' | 'unsubscribe';\r\nexport type PushSubscriptionNotifyEvent = `push_${PushSubscriptionNotifyType}`;\r\n\r\nexport type PushSubscriptionNotify = {\r\n  tokenType: number,\r\n  tokenValue: string\r\n};\r\n\r\nexport class WebPushApiManager extends EventListenerBase<{\r\n  push_notification_click: (n: PushNotificationObject) => void,\r\n  push_init: (n: PushSubscriptionNotify) => void,\r\n  push_subscribe: (n: PushSubscriptionNotify) => void,\r\n  push_unsubscribe: (n: PushSubscriptionNotify) => void\r\n}> {\r\n  public isAvailable = true;\r\n  private isPushEnabled = false;\r\n  private localNotificationsAvailable = true;\r\n  private started = false;\r\n  private settings: NotificationSettings & {baseUrl?: string} = {} as any;\r\n  private isAliveTO: any;\r\n  private isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\r\n  private userVisibleOnly = this.isFirefox ? false : true;\r\n  private log = logger('PM');\r\n\r\n  constructor() {\r\n    super(false);\r\n\r\n    if(!('PushManager' in window) ||\r\n      !('Notification' in window) ||\r\n      !('serviceWorker' in navigator)) {\r\n      this.log.warn('Push messaging is not supported.');\r\n      this.isAvailable = false;\r\n      this.localNotificationsAvailable = false;\r\n    }\r\n\r\n    if(this.isAvailable && Notification.permission === 'denied') {\r\n      this.log.warn('The user has blocked notifications.');\r\n    }\r\n  }\r\n\r\n  public start() {\r\n    if(!this.started) {\r\n      this.started = true;\r\n      this.getSubscription();\r\n      this.setUpServiceWorkerChannel();\r\n    }\r\n  }\r\n\r\n  public setLocalNotificationsDisabled() {\r\n    this.localNotificationsAvailable = false;\r\n  }\r\n\r\n  public getSubscription() {\r\n    if(!this.isAvailable) {\r\n      return;\r\n    }\r\n\r\n    navigator.serviceWorker.ready.then((reg) => {\r\n      reg.pushManager.getSubscription().then((subscription) => {\r\n        this.isPushEnabled = !!subscription;\r\n        this.pushSubscriptionNotify('init', subscription);\r\n      }).catch((err) => {\r\n        this.log.error('Error during getSubscription()', err);\r\n      });\r\n    });\r\n  }\r\n\r\n  public subscribe = () => {\r\n    if(!this.isAvailable) {\r\n      return;\r\n    }\r\n\r\n    navigator.serviceWorker.ready.then((reg) => {\r\n      reg.pushManager.subscribe({userVisibleOnly: this.userVisibleOnly}).then((subscription) => {\r\n        // The subscription was successful\r\n        this.isPushEnabled = true;\r\n        this.pushSubscriptionNotify('subscribe', subscription);\r\n      }).catch((e) => {\r\n        if(Notification.permission === 'denied') {\r\n          this.log('Permission for Notifications was denied');\r\n        } else {\r\n          this.log('Unable to subscribe to push.', e);\r\n          if(!this.userVisibleOnly) {\r\n            this.userVisibleOnly = true;\r\n            setTimeout(this.subscribe, 0);\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  public unsubscribe() {\r\n    if(!this.isAvailable) {\r\n      return;\r\n    }\r\n\r\n    navigator.serviceWorker.ready.then((reg) => {\r\n      reg.pushManager.getSubscription().then((subscription) => {\r\n        this.isPushEnabled = false;\r\n\r\n        if(subscription) {\r\n          this.pushSubscriptionNotify('unsubscribe', subscription);\r\n\r\n          setTimeout(() => {\r\n            subscription.unsubscribe().then((successful) => {\r\n              this.isPushEnabled = false;\r\n            }).catch((e) => {\r\n              this.log.error('Unsubscription error: ', e);\r\n            });\r\n          }, 3000);\r\n        }\r\n      }).catch((e) => {\r\n        this.log.error('Error thrown while unsubscribing from ' +\r\n          'push messaging.', e);\r\n      });\r\n    });\r\n  }\r\n\r\n  public forceUnsubscribe() {\r\n    if(!this.isAvailable) {\r\n      return;\r\n    }\r\n\r\n    navigator.serviceWorker.ready.then((reg) => {\r\n      reg.pushManager.getSubscription().then((subscription) => {\r\n        this.log.warn('force unsubscribe', subscription);\r\n        if(subscription) {\r\n          subscription.unsubscribe().then((successful) => {\r\n            this.log.warn('force unsubscribe successful', successful);\r\n            this.isPushEnabled = false;\r\n          }).catch((e) => {\r\n            this.log.error('Unsubscription error: ', e);\r\n          });\r\n        }\r\n      }).catch((e) => {\r\n        this.log.error('Error thrown while unsubscribing from ' +\r\n          'push messaging.', e);\r\n      });\r\n    });\r\n  }\r\n\r\n  public isAliveNotify = () => {\r\n    if(!this.isAvailable || singleInstance.deactivatedReason) {\r\n      return;\r\n    }\r\n\r\n    this.settings.baseUrl = (location.href || '').replace(/#.*$/, '');\r\n\r\n    const lang: ServicePushPingTaskPayload['lang'] = {} as any;\r\n    const ACTIONS_LANG_MAP: Record<keyof ServicePushPingTaskPayload['lang'], LangPackKey> = {\r\n      push_action_mute1d: IS_MOBILE ? 'PushNotification.Action.Mute1d.Mobile' : 'PushNotification.Action.Mute1d',\r\n      push_action_settings: IS_MOBILE ? 'PushNotification.Action.Settings.Mobile' : 'PushNotification.Action.Settings',\r\n      push_message_nopreview: 'PushNotification.Message.NoPreview'\r\n    };\r\n\r\n    for(const action in ACTIONS_LANG_MAP) {\r\n      lang[action as keyof typeof ACTIONS_LANG_MAP] = I18n.format(ACTIONS_LANG_MAP[action as keyof typeof ACTIONS_LANG_MAP], true);\r\n    }\r\n\r\n    apiManagerProxy.serviceMessagePort.invokeVoid('pushPing', {\r\n      localNotifications: this.localNotificationsAvailable,\r\n      lang: lang,\r\n      settings: this.settings\r\n    });\r\n\r\n    this.isAliveTO = setTimeout(this.isAliveNotify, 10000);\r\n  }\r\n\r\n  public setSettings(newSettings: WebPushApiManager['settings']) {\r\n    this.settings = copy(newSettings);\r\n    clearTimeout(this.isAliveTO);\r\n    this.isAliveNotify();\r\n  }\r\n\r\n  public hidePushNotifications() {\r\n    if(!this.isAvailable) {\r\n      return;\r\n    }\r\n\r\n    apiManagerProxy.serviceMessagePort.invokeVoid('notificationsClear', undefined);\r\n  }\r\n\r\n  public setUpServiceWorkerChannel() {\r\n    if(!this.isAvailable) {\r\n      return;\r\n    }\r\n\r\n    apiManagerProxy.serviceMessagePort.addEventListener('pushClick', (payload) => {\r\n      if(singleInstance.deactivatedReason) {\r\n        appRuntimeManager.reload();\r\n        return;\r\n      }\r\n\r\n      this.dispatchEvent('push_notification_click', payload);\r\n    });\r\n\r\n    navigator.serviceWorker.ready.then(this.isAliveNotify);\r\n  }\r\n\r\n  public pushSubscriptionNotify(event: PushSubscriptionNotifyType, subscription?: PushSubscription) {\r\n    if(subscription) {\r\n      const subscriptionObj: PushSubscriptionJSON = subscription.toJSON();\r\n      if(!subscriptionObj ||\r\n        !subscriptionObj.endpoint ||\r\n        !subscriptionObj.keys ||\r\n        !subscriptionObj.keys.p256dh ||\r\n        !subscriptionObj.keys.auth) {\r\n        this.log.warn('Invalid push subscription', subscriptionObj);\r\n        this.unsubscribe();\r\n        this.isAvailable = false;\r\n        this.pushSubscriptionNotify(event);\r\n        return;\r\n      }\r\n\r\n      this.log.warn('Push', event, subscriptionObj);\r\n      this.dispatchEvent(('push_' + event) as PushSubscriptionNotifyEvent, {\r\n        tokenType: 10,\r\n        tokenValue: JSON.stringify(subscriptionObj)\r\n      });\r\n    } else {\r\n      this.log.warn('Push', event, false);\r\n      this.dispatchEvent(('push_' + event) as PushSubscriptionNotifyEvent, false as any);\r\n    }\r\n  }\r\n}\r\n\r\nconst webPushApiManager = new WebPushApiManager();\r\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.webPushApiManager = webPushApiManager);\r\nexport default webPushApiManager;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {MOUNT_CLASS_TO} from '../config/debug';\r\nimport IS_OPUS_SUPPORTED from '../environment/opusSupport';\r\nimport {IS_SAFARI} from '../environment/userAgent';\r\nimport {Modify} from '../types';\r\nimport {logger, LogTypes} from './logger';\r\nimport apiManagerProxy from './mtproto/mtprotoworker';\r\nimport type {ConvertWebPTask} from './webp/webpWorkerController';\r\n\r\ntype Result = {\r\n  bytes: Uint8Array,\r\n  waveform?: Uint8Array\r\n};\r\n\r\ntype Task = {\r\n  pages: Uint8Array,\r\n  withWaveform: boolean,\r\n  waveform?: Uint8Array,\r\n  callback: {resolve: (result: Result) => void, reject: (err: any) => void},\r\n  timeout: number\r\n};\r\n\r\nexport interface ConvertOpusTask extends Modify<ConvertWebPTask, {type: 'convertOpus'}> {\r\n  type: 'convertOpus'\r\n}\r\n\r\nexport class OpusDecodeController {\r\n  private worker: Worker;\r\n  private wavWorker: Worker;\r\n  private sampleRate = 48000;\r\n  private tasks: Array<Task> = [];\r\n  private keepAlive = false;\r\n  private log = logger('OPUS', LogTypes.Error);\r\n\r\n  public isPlaySupported() {\r\n    return IS_OPUS_SUPPORTED;\r\n  }\r\n\r\n  public loadWavWorker() {\r\n    if(this.wavWorker) return;\r\n\r\n    this.wavWorker = new Worker('waveWorker.min.js');\r\n    this.wavWorker.addEventListener('message', (e) => {\r\n      const data = e.data;\r\n\r\n      this.log('[WAV] got message:', data);\r\n      if(data && data.page) {\r\n        const bytes = data.page;\r\n        this.onTaskEnd(this.tasks.shift(), bytes);\r\n      }\r\n    });\r\n  }\r\n\r\n  public loadWorker() {\r\n    if(this.worker) return;\r\n\r\n    this.worker = new Worker('decoderWorker.min.js');\r\n    this.worker.addEventListener('message', (e) => {\r\n      const data = e.data;\r\n\r\n      this.log('[DECODER] got message', data);\r\n      if(data.type === 'done') {\r\n        // this.log('[DECODER] send done to wav');\r\n        this.wavWorker.postMessage({command: 'done'});\r\n\r\n        if(data.waveform) {\r\n          this.tasks[0].waveform = data.waveform;\r\n        }\r\n      } else { // e.data contains decoded buffers as float32 values\r\n        // this.log('[DECODER] send encode to wav');\r\n        this.wavWorker.postMessage({\r\n          command: 'encode',\r\n          buffers: e.data\r\n        }, IS_SAFARI ? undefined : data.map((typedArray: Uint8Array) => typedArray.buffer));\r\n      }\r\n    });\r\n  }\r\n\r\n  public setKeepAlive(keepAlive: boolean) {\r\n    this.keepAlive = keepAlive;\r\n    if(this.keepAlive) {\r\n      this.loadWorker();\r\n      this.loadWavWorker();\r\n    } else if(!this.tasks.length) {\r\n      this.terminateWorkers();\r\n    }\r\n  }\r\n\r\n  public onTaskEnd(task: Task, result?: Uint8Array) {\r\n    if(!result) {\r\n      task.callback.reject('timeout');\r\n    } else {\r\n      clearTimeout(task.timeout);\r\n      task.callback.resolve({bytes: result, waveform: task.waveform});\r\n    }\r\n\r\n    if(this.tasks.length) {\r\n      this.executeNewTask(this.tasks[0]);\r\n    }\r\n\r\n    this.terminateWorkers();\r\n  }\r\n\r\n  public terminateWorkers(kill = false) {\r\n    if((this.keepAlive || this.tasks.length) && !kill) return;\r\n\r\n    if(this.worker) {\r\n      this.worker.terminate();\r\n      this.worker = null;\r\n    }\r\n\r\n    if(this.wavWorker) {\r\n      this.wavWorker.terminate();\r\n      this.wavWorker = null;\r\n    }\r\n  }\r\n\r\n  public executeNewTask(task: Task) {\r\n    this.worker.postMessage({\r\n      command: 'init',\r\n      decoderSampleRate: this.sampleRate,\r\n      outputBufferSampleRate: this.sampleRate\r\n    });\r\n\r\n    this.wavWorker.postMessage({\r\n      command: 'init',\r\n      wavBitDepth: 16,\r\n      wavSampleRate: this.sampleRate\r\n    });\r\n\r\n    // console.log('sending command to worker:', task);\r\n    // setTimeout(() => {\r\n    this.log('[DECODER] send decode');\r\n    this.worker.postMessage({\r\n      command: 'decode',\r\n      pages: task.pages,\r\n      waveform: task.withWaveform\r\n    }, IS_SAFARI ? undefined : [task.pages.buffer]);\r\n    // }, 1e3);\r\n\r\n    task.timeout = window.setTimeout(() => {\r\n      this.log.error('decode timeout'/* , task */);\r\n\r\n      this.terminateWorkers(true);\r\n      if(this.tasks.length) {\r\n        this.loadWorker();\r\n        this.loadWavWorker();\r\n      }\r\n\r\n      this.onTaskEnd(this.tasks.shift());\r\n    }, 10e3);\r\n  }\r\n\r\n  public pushDecodeTask(pages: Uint8Array, withWaveform: boolean) {\r\n    return new Promise<Result>((resolve, reject) => {\r\n      const task = {\r\n        pages,\r\n        withWaveform,\r\n        callback: {resolve, reject},\r\n        timeout: 0\r\n      };\r\n\r\n      this.loadWorker();\r\n      this.loadWavWorker();\r\n\r\n      if(this.tasks.push(task) === 1) {\r\n        this.executeNewTask(task);\r\n      }\r\n    });\r\n  }\r\n\r\n  public async decode(typedArray: Uint8Array, withWaveform = false) {\r\n    return this.pushDecodeTask(typedArray, withWaveform).then(async(result) => {\r\n      const dataBlob = new Blob([result.bytes], {type: 'audio/wav'});\r\n      return {url: await apiManagerProxy.invoke('createObjectURL', dataBlob), waveform: result.waveform};\r\n    });\r\n  }\r\n}\r\n\r\nconst opusDecodeController = new OpusDecodeController();\r\nMOUNT_CLASS_TO.opusDecodeController = opusDecodeController;\r\nexport default opusDecodeController;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n *\r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nimport emojiRegExp from '../../vendor/emoji/regex';\r\nimport {MessageEntity} from '../../layer';\r\n\r\nconst EmojiHelper = {\r\n  emojiMap: (code: string) => { return code; },\r\n  shortcuts: [] as any,\r\n  emojis: [] as any\r\n};\r\n\r\nexport const ALPHA_CHARS_REG_EXP = 'a-z' +\r\n  '\\\\u00c0-\\\\u00d6\\\\u00d8-\\\\u00f6\\\\u00f8-\\\\u00ff' + // Latin-1\r\n  '\\\\u0100-\\\\u024f' + // Latin Extended A and B\r\n  '\\\\u0253\\\\u0254\\\\u0256\\\\u0257\\\\u0259\\\\u025b\\\\u0263\\\\u0268\\\\u026f\\\\u0272\\\\u0289\\\\u028b' + // IPA Extensions\r\n  '\\\\u02bb' + // Hawaiian\r\n  '\\\\u0300-\\\\u036f' + // Combining diacritics\r\n  '\\\\u1e00-\\\\u1eff' + // Latin Extended Additional (mostly for Vietnamese)\r\n  '\\\\u0400-\\\\u04ff\\\\u0500-\\\\u0527' + // Cyrillic\r\n  '\\\\u2de0-\\\\u2dff\\\\ua640-\\\\ua69f' + // Cyrillic Extended A/B\r\n  '\\\\u0591-\\\\u05bf\\\\u05c1-\\\\u05c2\\\\u05c4-\\\\u05c5\\\\u05c7' +\r\n  '\\\\u05d0-\\\\u05ea\\\\u05f0-\\\\u05f4' + // Hebrew\r\n  '\\\\ufb1d-\\\\ufb28\\\\ufb2a-\\\\ufb36\\\\ufb38-\\\\ufb3c\\\\ufb3e\\\\ufb40-\\\\ufb41' +\r\n  '\\\\ufb43-\\\\ufb44\\\\ufb46-\\\\ufb4f' + // Hebrew Pres. Forms\r\n  '\\\\u0610-\\\\u061a\\\\u0620-\\\\u065f\\\\u066e-\\\\u06d3\\\\u06d5-\\\\u06dc' +\r\n  '\\\\u06de-\\\\u06e8\\\\u06ea-\\\\u06ef\\\\u06fa-\\\\u06fc\\\\u06ff' + // Arabic\r\n  '\\\\u0750-\\\\u077f\\\\u08a0\\\\u08a2-\\\\u08ac\\\\u08e4-\\\\u08fe' + // Arabic Supplement and Extended A\r\n  '\\\\ufb50-\\\\ufbb1\\\\ufbd3-\\\\ufd3d\\\\ufd50-\\\\ufd8f\\\\ufd92-\\\\ufdc7\\\\ufdf0-\\\\ufdfb' + // Pres. Forms A\r\n  '\\\\ufe70-\\\\ufe74\\\\ufe76-\\\\ufefc' + // Pres. Forms B\r\n  '\\\\u200c' + // Zero-Width Non-Joiner\r\n  '\\\\u0e01-\\\\u0e3a\\\\u0e40-\\\\u0e4e' + // Thai\r\n  '\\\\u1100-\\\\u11ff\\\\u3130-\\\\u3185\\\\uA960-\\\\uA97F\\\\uAC00-\\\\uD7AF\\\\uD7B0-\\\\uD7FF' + // Hangul (Korean)\r\n  '\\\\u3003\\\\u3005\\\\u303b' + // Kanji/Han iteration marks\r\n  '\\\\uff21-\\\\uff3a\\\\uff41-\\\\uff5a' + // full width Alphabet\r\n  '\\\\uff66-\\\\uff9f' + // half width Katakana\r\n  '\\\\uffa1-\\\\uffdc'; // half width Hangul (Korean)\r\nexport const ALPHA_NUMERIC_REG_EXP = '0-9\\_' + ALPHA_CHARS_REG_EXP;\r\nexport const DOMAIN_ADD_CHARS = '\\u00b7';\r\n// Based on Regular Expression for URL validation by Diego Perini\r\nexport const URL_ALPHANUMERIC_REG_EXP_PART = '[' + ALPHA_CHARS_REG_EXP + '0-9]';\r\nexport const URL_PROTOCOL_REG_EXP_PART = '((?:https?|ftp)://|mailto:)?';\r\nexport const URL_REG_EXP = URL_PROTOCOL_REG_EXP_PART +\r\n  // user:pass authentication\r\n  '(?:' + URL_ALPHANUMERIC_REG_EXP_PART + '{1,64}(?::' + URL_ALPHANUMERIC_REG_EXP_PART + '{0,64})?@)?' +\r\n  '(?:' +\r\n  // sindresorhus/ip-regexp\r\n  '(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}' +\r\n  '|' +\r\n  // host name\r\n  URL_ALPHANUMERIC_REG_EXP_PART + '[' + ALPHA_CHARS_REG_EXP + DOMAIN_ADD_CHARS + '0-9\\-]{0,64}' +\r\n  // domain name\r\n  '(?:\\\\.' + URL_ALPHANUMERIC_REG_EXP_PART + '[' + ALPHA_CHARS_REG_EXP + DOMAIN_ADD_CHARS + '0-9\\-]{0,64}){0,10}' +\r\n  // TLD identifier\r\n  '(?:\\\\.(xn--[0-9a-z]{2,16}|[' + ALPHA_CHARS_REG_EXP + ']{2,24}))' +\r\n  ')' +\r\n  // port number\r\n  '(?::\\\\d{2,5})?' +\r\n  // resource path\r\n  '(?:/(?:\\\\S{0,255}[^\\\\s.;,(\\\\[\\\\]{}<>\"\\'])?)?';\r\nexport const URL_PROTOCOL_REG_EXP = new RegExp('^' + URL_PROTOCOL_REG_EXP_PART.slice(0, -1), 'i');\r\nexport const URL_ANY_PROTOCOL_REG_EXP = /^((?:[^\\/]+?):\\/\\/|mailto:)/;\r\nexport const USERNAME_REG_EXP = '[a-zA-Z\\\\d_]{5,32}';\r\nexport const BOT_COMMAND_REG_EXP = '\\\\/([a-zA-Z\\\\d_]{1,32})(?:@(' + USERNAME_REG_EXP + '))?(\\\\b|$)';\r\nexport const FULL_REG_EXP = new RegExp('(^| )(@)(' + USERNAME_REG_EXP + ')|(' + URL_REG_EXP + ')|(\\\\n)|(' + emojiRegExp + ')|(^|[\\\\s\\\\(\\\\]])(#[' + ALPHA_NUMERIC_REG_EXP + ']{2,64})|(^|\\\\s)' + BOT_COMMAND_REG_EXP, 'i');\r\nexport const EMAIL_REG_EXP = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n// const markdownTestRegExp = /[`_*@~]/;\r\nexport const MARKDOWN_REG_EXP = /(^|\\s|\\n)(````?)([\\s\\S]+?)(````?)([\\s\\n\\.,:?!;]|$)|(^|\\s|\\x01)(`|~~|\\*\\*|__|_-_|\\|\\|)([^\\n]+?)\\7([\\x01\\s\\.,:?!;]|$)|@(\\d+)\\s*\\((.+?)\\)|(\\[(.+?)\\]\\((.+?)\\))/m;\r\nexport const SITE_HASHTAGS: {[siteName: string]: string} = {\r\n  'Telegram': 'tg://search_hashtag?hashtag={1}',\r\n  'Twitter': 'https://twitter.com/hashtag/{1}',\r\n  'Instagram': 'https://instagram.com/explore/tags/{1}/',\r\n  'Google Plus': 'https://plus.google.com/explore/{1}'\r\n};\r\n\r\n// export const SITE_MENTIONS: {[siteName in 'Telegram' | 'Twitter' | 'Instagram' | 'GitHub']: string} = {\r\n//   Telegram: '#{1}',\r\n//   Twitter: 'https://twitter.com/{1}',\r\n//   Instagram: 'https://instagram.com/{1}/',\r\n//   GitHub: 'https://github.com/{1}'\r\n// };\r\n\r\nexport const MARKDOWN_ENTITIES: {[markdown: string]: MessageEntity['_']} = {\r\n  '`': 'messageEntityCode',\r\n  '``': 'messageEntityPre',\r\n  '**': 'messageEntityBold',\r\n  '__': 'messageEntityItalic',\r\n  '~~': 'messageEntityStrike',\r\n  '_-_': 'messageEntityUnderline',\r\n  '||': 'messageEntitySpoiler'\r\n};\r\n\r\nexport const PASS_CONFLICTING_ENTITIES: Set<MessageEntity['_']> = new Set([\r\n  'messageEntityEmoji',\r\n  'messageEntityLinebreak',\r\n  'messageEntityCaret'\r\n]);\r\nfor(const i in MARKDOWN_ENTITIES) {\r\n  PASS_CONFLICTING_ENTITIES.add(MARKDOWN_ENTITIES[i]);\r\n}\r\n\r\nexport const PHONE_NUMBER_REG_EXP = /^\\+\\d+$/;\r\n\r\n/* export function parseEmojis(text: string) {\r\n  return text.replace(/:([a-z0-9\\-\\+\\*_]+?):/gi, function (all, shortcut) {\r\n    var emojiCode = EmojiHelper.shortcuts[shortcut]\r\n    if (emojiCode !== undefined) {\r\n      return EmojiHelper.emojis[emojiCode][0]\r\n    }\r\n    return all\r\n  })\r\n} */\r\n\r\n\r\n/* export function replaceUrlEncodings(urlWithEncoded: string) {\r\n  return urlWithEncoded.replace(/(%[A-Z\\d]{2})+/g, (str) => {\r\n    try {\r\n      return decodeURIComponent(str);\r\n    } catch (e) {\r\n      return str;\r\n    }\r\n  });\r\n} */\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { MOUNT_CLASS_TO } from '../config/debug';\r\nimport type { State } from '../config/state';\r\nimport { IS_WORKER } from '../helpers/context';\r\nimport EventListenerBase from '../helpers/eventListenerBase';\r\nimport type { Config, GroupCall, GroupCallParticipant, Message, NotifyPeer, PeerNotifySettings, PhoneCall, Poll, PollResults, Reaction, ReactionCount, StickerSet, Update, WebPage } from '../layer';\r\nimport type { CallId } from './appManagers/appCallsManager';\r\nimport type { MyDocument } from './appManagers/appDocsManager';\r\nimport type { Progress } from './appManagers/appDownloadManager';\r\nimport type { MyDraftMessage } from './appManagers/appDraftsManager';\r\nimport type { GroupCallId } from './appManagers/appGroupCallsManager';\r\nimport type { Dialog, MessagesStorageKey, MyMessage } from './appManagers/appMessagesManager';\r\nimport type { UserTyping } from './appManagers/appProfileManager';\r\nimport type { AppManagers } from './appManagers/managers';\r\nimport { MTAppConfig } from './mtproto/appConfig';\r\nimport type { ConnectionStatusChange } from './mtproto/connectionStatus';\r\nimport MTProtoMessagePort from './mtproto/mtprotoMessagePort';\r\nimport { NULL_PEER_ID, UserAuth } from './mtproto/mtproto_config';\r\nimport type { Folder } from './storages/dialogs';\r\nimport type { MyDialogFilter } from './storages/filters';\r\n\r\nexport type BroadcastEvents = {\r\n  'chat_full_update': ChatId,\r\n  'chat_update': ChatId,\r\n\r\n  'channel_update': ChatId,\r\n\r\n  'user_update': UserId,\r\n  'user_auth': UserAuth,\r\n  'user_full_update': UserId,\r\n\r\n  'peer_pinned_messages': { peerId: PeerId, mids?: number[], pinned?: boolean, unpinAll?: true },\r\n  'peer_pinned_hidden': { peerId: PeerId, maxId: number },\r\n  'peer_typings': { peerId: PeerId, typings: UserTyping[] },\r\n  'peer_block': { peerId: PeerId, blocked: boolean },\r\n  'peer_title_edit': PeerId,\r\n  'peer_bio_edit': PeerId,\r\n  'peer_deleted': PeerId, // left chat, deleted user dialog, left channel\r\n  'peer_full_update': PeerId,\r\n\r\n  'filter_delete': MyDialogFilter,\r\n  'filter_update': MyDialogFilter,\r\n  'filter_new': MyDialogFilter,\r\n  'filter_order': number[],\r\n\r\n  'folder_unread': Omit<Folder, 'dialogs' | 'dispatchUnreadTimeout'>,\r\n\r\n  'dialog_draft': { peerId: PeerId, dialog: Dialog, drop: boolean, draft: MyDraftMessage | undefined },\r\n  'dialog_unread': { peerId: PeerId, dialog: Dialog },\r\n  'dialog_flush': { peerId: PeerId, dialog: Dialog },\r\n  'dialog_drop': { peerId: PeerId, dialog?: Dialog },\r\n  'dialog_migrate': { migrateFrom: PeerId, migrateTo: PeerId },\r\n  // 'dialog_top': Dialog,\r\n  'dialog_notify_settings': Dialog,\r\n  // 'dialog_order': {dialog: Dialog, pos: number},\r\n  'dialogs_multiupdate': Map<PeerId, Dialog>,\r\n\r\n  'history_append': { storageKey: MessagesStorageKey, message: Message.message },\r\n  'history_update': { storageKey: MessagesStorageKey, message: MyMessage, sequential?: boolean },\r\n  'history_reply_markup': { peerId: PeerId },\r\n  'history_multiappend': MyMessage,\r\n  'history_delete': { peerId: PeerId, msgs: Set<number> },\r\n  'history_forbidden': PeerId,\r\n  'history_reload': PeerId,\r\n  // 'history_request': void,\r\n\r\n  'message_edit': { storageKey: MessagesStorageKey, peerId: PeerId, mid: number, message: MyMessage },\r\n  'message_sent': { storageKey: MessagesStorageKey, tempId: number, tempMessage: any, mid: number, message: MyMessage },\r\n  'message_error': { storageKey: MessagesStorageKey, tempId: number, error: ApiError },\r\n  'messages_views': { peerId: PeerId, mid: number, views: number }[],\r\n  'messages_reactions': { message: Message.message, changedResults: ReactionCount[] }[],\r\n  'messages_pending': void,\r\n  'messages_read': void,\r\n  'messages_downloaded': { peerId: PeerId, mids: number[] },\r\n  'messages_media_read': { peerId: PeerId, mids: number[] },\r\n\r\n  'replies_updated': Message.message,\r\n\r\n  'scheduled_new': Message.message,\r\n  'scheduled_delete': { peerId: PeerId, mids: number[] },\r\n\r\n  'album_edit': { peerId: PeerId, groupId: string, deletedMids: number[], messages: Message.message[] },\r\n\r\n  'stickers_installed': StickerSet.stickerSet,\r\n  'stickers_deleted': StickerSet.stickerSet,\r\n  'stickers_updated': { type: 'recent' | 'faved', stickers: MyDocument[] },\r\n  'stickers_top': Long,\r\n  'sticker_updated': { type: 'recent' | 'faved', document: MyDocument, faved: boolean },\r\n\r\n  'state_cleared': void,\r\n  'state_synchronized': ChatId | void,\r\n  'state_synchronizing': ChatId | void,\r\n\r\n  'contacts_update': UserId,\r\n  'avatar_update': PeerId,\r\n  'poll_update': { poll: Poll, results: PollResults },\r\n  'invalidate_participants': ChatId,\r\n  // 'channel_settings': {channelId: number},\r\n  'webpage_updated': { id: WebPage.webPage['id'], msgs: { peerId: PeerId, mid: number, isScheduled: boolean }[] },\r\n\r\n  'connection_status_change': ConnectionStatusChange,\r\n  'settings_updated': { key: string, value: any, settings: State['settings'] },\r\n  'draft_updated': { peerId: PeerId, threadId: number, draft: MyDraftMessage | undefined, force?: boolean },\r\n\r\n  'background_change': void,\r\n\r\n  'privacy_update': Update.updatePrivacy,\r\n\r\n  'notify_settings': Update.updateNotifySettings,\r\n  'notify_peer_type_settings': { key: Exclude<NotifyPeer['_'], 'notifyPeer'>, settings: PeerNotifySettings },\r\n\r\n  'notification_reset': string,\r\n  'notification_cancel': string,\r\n\r\n  'language_change': string,\r\n\r\n  'theme_change': void,\r\n\r\n  'media_play': void,\r\n\r\n  'emoji_recent': AppEmoji,\r\n\r\n  'download_progress': Progress,\r\n  'document_downloading': DocId,\r\n  'document_downloaded': DocId,\r\n\r\n  'choosing_sticker': boolean\r\n\r\n  'group_call_update': GroupCall,\r\n  'group_call_participant': { groupCallId: GroupCallId, participant: GroupCallParticipant },\r\n  // 'group_call_video_track_added': {instance: GroupCallInstance}\r\n\r\n  'call_update': PhoneCall,\r\n  'call_signaling': { callId: CallId, data: Uint8Array },\r\n\r\n  'quick_reaction': Reaction,\r\n\r\n  'service_notification': Update.updateServiceNotification,\r\n\r\n  'logging_out': void,\r\n\r\n  'payment_sent': { peerId: PeerId, mid: number, receiptMessage: Message.messageService }\r\n\r\n  'premium_toggle': boolean,\r\n\r\n  'config': Config,\r\n  'app_config': MTAppConfig,\r\n  'dialog_element_create': any\r\n};\r\n\r\nexport type BroadcastEventsListeners = {\r\n  [name in keyof BroadcastEvents]: (e: BroadcastEvents[name]) => void\r\n};\r\n\r\nexport class RootScope extends EventListenerBase<BroadcastEventsListeners> {\r\n  public myId: PeerId;\r\n  private connectionStatus: { [name: string]: ConnectionStatusChange };\r\n  public settings: State['settings'];\r\n  public managers: AppManagers;\r\n  public premium: boolean;\r\n  public dialogRoot: any;\r\n  public allDispatch: any;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.myId = NULL_PEER_ID;\r\n    this.connectionStatus = {};\r\n    this.premium = false;\r\n    this.allDispatch = {}\r\n\r\n    this.addEventListener('user_auth', ({ id }) => {\r\n      this.myId = id.toPeerId();\r\n    });\r\n\r\n    this.addEventListener('premium_toggle', (isPremium) => {\r\n      this.premium = isPremium;\r\n    });\r\n\r\n    this.addEventListener('connection_status_change', (status) => {\r\n      this.connectionStatus[status.name] = status;\r\n    });\r\n\r\n    this.dispatchEvent = (e, ...args) => {\r\n      super.dispatchEvent(e, ...args);\r\n      MTProtoMessagePort.getInstance().invokeVoid('event', { name: e as string, args });\r\n    };\r\n\r\n    if (!IS_WORKER) {\r\n      this.addEventListener('settings_updated', ({ settings }) => {\r\n        this.settings = settings;\r\n      });\r\n    }\r\n  }\r\n\r\n  public getConnectionStatus() {\r\n    return this.connectionStatus;\r\n  }\r\n\r\n  public getPremium() {\r\n    return this.premium;\r\n  }\r\n\r\n  public dispatchEventSingle(...args: any[]) {\r\n    // @ts-ignore\r\n    super.dispatchEvent(...args);\r\n  }\r\n}\r\n\r\nconst rootScope = new RootScope();\r\nMOUNT_CLASS_TO.rootScope = rootScope;\r\nexport default rootScope;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {MOUNT_CLASS_TO} from '../../config/debug';\r\nimport deferredPromise, {CancellablePromise} from '../../helpers/cancellablePromise';\r\nimport {WorkerTaskVoidTemplate} from '../../types';\r\n\r\nexport interface ConvertWebPTask extends WorkerTaskVoidTemplate {\r\n  type: 'convertWebp',\r\n  payload: {\r\n    fileName: string,\r\n    bytes: Uint8Array\r\n  }\r\n};\r\n\r\nexport class WebpWorkerController {\r\n  private worker: Worker;\r\n  private convertPromises: {[fileName: string]: CancellablePromise<Uint8Array>} = {};\r\n\r\n  private init() {\r\n    this.worker = new Worker(new URL('./webp.worker.ts', import.meta.url));\r\n    this.worker.addEventListener('message', (e) => {\r\n      const task = e.data as ConvertWebPTask;\r\n      const payload = task.payload;\r\n\r\n      const promise = this.convertPromises[payload.fileName];\r\n      if(promise) {\r\n        payload.bytes ? promise.resolve(payload.bytes) : promise.reject();\r\n        delete this.convertPromises[payload.fileName];\r\n      }\r\n    });\r\n  }\r\n\r\n  private postMessage(data: ConvertWebPTask) {\r\n    if(this.init) {\r\n      this.init();\r\n      this.init = null;\r\n    }\r\n\r\n    this.worker.postMessage(data);\r\n  }\r\n\r\n  public convert(fileName: string, bytes: Uint8Array) {\r\n    if(this.convertPromises.hasOwnProperty(fileName)) {\r\n      return this.convertPromises[fileName];\r\n    }\r\n\r\n    const convertPromise = deferredPromise<Uint8Array>();\r\n\r\n    this.postMessage({type: 'convertWebp', payload: {fileName, bytes}});\r\n\r\n    return this.convertPromises[fileName] = convertPromise;\r\n  }\r\n}\r\n\r\nconst webpWorkerController = new WebpWorkerController();\r\nMOUNT_CLASS_TO.webpWorkerController = webpWorkerController;\r\nexport default webpWorkerController;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + ({\"555\":\"npm.react-transition-group\",\"589\":\"crypto.worker\",\"630\":\"npm.qr-code-styling\",\"670\":\"sw\",\"678\":\"mtproto.worker\",\"816\":\"npm.mui\",\"931\":\"npm.emotion\"}[chunkId] || chunkId) + \".\" + {\"8\":\"4d2f8190984c39ac5615\",\"51\":\"5cf3b581f83b9c80afb5\",\"53\":\"c0f6c089aa7f81969738\",\"61\":\"f696022e017b02e834ad\",\"63\":\"05491dd20f1796f84123\",\"77\":\"808c5b447b007ee7aa9d\",\"86\":\"41e19953b8dca88e30fe\",\"104\":\"46e7ae1fdf315ac520f2\",\"231\":\"57d6c4f86b86fae5ce2d\",\"301\":\"2620ea5241c74ef20a38\",\"339\":\"177b854bf4f4abdf9126\",\"392\":\"2726c413162a11775c49\",\"436\":\"35688df64b1a9c7812fd\",\"442\":\"d8027beef220dd531151\",\"508\":\"a435d6eebbcead0382dc\",\"555\":\"9de5bc5550a3f36df88c\",\"589\":\"2b4b53dedec3af983de7\",\"630\":\"5c8af6e9c411419a66e1\",\"641\":\"3818aba2cdd743940ccb\",\"642\":\"ca5e436ec51c6b231f81\",\"651\":\"2d863b28039c2f67fb24\",\"670\":\"154100979c6d8f407028\",\"678\":\"24d8a176ea08f19f683a\",\"709\":\"a11acdcd75355784a161\",\"774\":\"dfe0b53616e2851cc297\",\"776\":\"e80b67ab56f3074efcce\",\"781\":\"fadb94e64d6d62cb011b\",\"783\":\"58fbb98fd912c9c91f41\",\"810\":\"882ecb5e67a178faa2df\",\"813\":\"4c7be59434f2542b82c2\",\"816\":\"92b284db8782167299c3\",\"931\":\"773b5c44fc0aef0bbe58\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = this[\"webpackChunktweb\"] = this[\"webpackChunktweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [105,437,570], () => (__webpack_require__(6873)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","leafPrototypes","getProto","inProgress","dataWebpackPrefix","oldGetScript","oldLoadScript","queryMap","countMap","l","Symbol","for","n","p","q","r","t","u","v","w","x","y","z","iterator","B","isMounted","enqueueForceUpdate","enqueueReplaceState","enqueueSetState","C","Object","assign","D","E","a","b","e","this","props","context","refs","updater","F","G","prototype","isReactComponent","setState","Error","forceUpdate","H","constructor","isPureReactComponent","I","Array","isArray","J","hasOwnProperty","K","current","L","key","ref","__self","__source","M","d","c","k","h","call","g","arguments","length","children","f","m","defaultProps","$$typeof","type","_owner","O","P","Q","replace","escape","toString","R","N","push","A","next","done","value","String","keys","join","S","T","_status","_result","then","default","U","V","transition","W","ReactCurrentDispatcher","ReactCurrentBatchConfig","ReactCurrentOwner","exports","Children","map","forEach","apply","count","toArray","only","Component","Fragment","Profiler","PureComponent","StrictMode","Suspense","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","cloneElement","createContext","_currentValue","_currentValue2","_threadCount","Provider","Consumer","_defaultValue","_globalName","_context","createElement","createFactory","bind","createRef","forwardRef","render","isValidElement","lazy","_payload","_init","memo","compare","startTransition","unstable_act","useCallback","useContext","useDebugValue","useDeferredValue","useEffect","useId","useImperativeHandle","useInsertionEffect","useLayoutEffect","useMemo","useReducer","useRef","useState","useSyncExternalStore","useTransition","version","module","pop","sortIndex","id","performance","now","unstable_now","Date","setTimeout","clearTimeout","setImmediate","callback","startTime","expirationTime","priorityLevel","navigator","scheduling","isInputPending","MessageChannel","port2","port1","onmessage","postMessage","unstable_IdlePriority","unstable_ImmediatePriority","unstable_LowPriority","unstable_NormalPriority","unstable_Profiling","unstable_UserBlockingPriority","unstable_cancelCallback","unstable_continueExecution","unstable_forceFrameRate","console","error","Math","floor","unstable_getCurrentPriorityLevel","unstable_getFirstCallbackNode","unstable_next","unstable_pauseExecution","unstable_requestPaint","unstable_runWithPriority","unstable_scheduleCallback","delay","unstable_shouldYield","unstable_wrapCallback","STATE_VERSION","BUILD","STATE_INIT","allDialogsLoaded","pinnedOrders","contactsListCachedTime","updates","filtersArr","maxSeenMsgId","stateCreatedTime","recentEmoji","recentCustomEmoji","topPeersCache","recentSearch","build","authState","_","IS_MOBILE","hiddenPinnedMessages","settings","messagesTextSize","distanceUnit","sendShortcut","animationsEnabled","autoDownload","photo","contacts","private","groups","channels","video","file","autoDownloadNew","file_size_max","pFlags","video_preload_large","audio_preload_next","photo_size_max","video_size_max","video_upload_maxbitrate","autoPlay","gifs","videos","stickers","suggest","loop","emoji","big","themes","name","background","blur","slug","color","highlightningColor","intensity","theme","notifications","sound","timeFormat","toLocaleString","match","playbackParams","volume","muted","playbackRate","playbackRates","voice","audio","round","keepSigned","chatContextMenuHintWasShown","stateId","notifySettings","IS_APPLE_MX","ctx","document","getContext","extension","getExtension","renderer","getParameter","UNMASKED_RENDERER_WEBGL","getSupportedExtensions","indexOf","err","CAN_USE_TRANSFERABLES","IS_SAFARI","userAgent","search","geolocation","getCurrentPosition","IMAGE_MIME_TYPES_SUPPORTED","Set","add","arr","concat","canPlayType","IS_APPLE_MOBILE","IS_FIREFOX","mediaDevices","window","DocumentTouch","USER_AGENT","IS_APPLE","IS_ANDROID","toLowerCase","IS_CHROMIUM","test","vendor","platform","maxTouchPoints","IS_MOBILE_SAFARI","vibrate","VIDEO_MIME_TYPES_SUPPORTED","toDataURL","startsWith","rgbaToHsla","max","min","s","hslaToRgba","hue2rgb","hexaToRgba","hexa","offset","slice","i","parseInt","hexToRgb","hex","hexaToHsla","rgba","rgbaToHexa","hslaStringToHex","hsla","splitted","split","alpha","val","endsWith","hslaStringToRgba","hslaStringToHexa","compareVersion","v1","v2","s1","s2","blurActiveElement","activeElement","cancelEvent","event","originalEvent","stopPropagation","preventDefault","returnValue","cancelBubble","findUpClassName","el","className","closest","fixSafariStickyInput","input","style","transform","focus","IS_STICKY_INPUT_BUGGED","startY","o","capture","passive","onTouchMove","touch","touches","scrollable","target","scrolled","scrollTop","scrollHeight","clientHeight","nextScrollTop","lastFocusOutTimeStamp","addEventListener","classList","contains","timeStamp","touchStart","removeEventListener","fixSafariStickyInputFocusing","texts","cache","fonts","text","icons","monospace","loadFonts","types","undefined","Promise","resolve","promises","_texts","font","weights","weight","_promises","load","race","all","catch","FOCUS_EVENT_NAME","IdleController","super","_isIdle","focusPromise","focusResolve","isIdle","once","idle","getFocusPromise","dispatchEvent","OverlayCounter","overlaysActive","isOverlayActive","fastRafCallbacks","fastRaf","requestAnimationFrame","currentCallbacks","cb","fastRafConventionalCallbacks","rafPromise","processing","fastRafConventional","fastRafPromise","doubleRaf","parseUriParams","uri","params","item","decodeURIComponent","themeController","setTheme","themeColorElem","_themeColorElem","head","querySelector","setThemeColor","themeColor","isNight","setAttribute","setThemeListener","darkModeMediaQuery","matchMedia","checkDarkMode","systemTheme","matches","addListener","applyHighlightningColor","getTheme","documentElement","setProperty","removeProperty","colorScheme","toggle","workerHandler","construct","args","url","location","Worker","SharedWorker","filter","Boolean","Proxy","setWorkerProxy","Element","toggleAttribute","force","hasAttribute","removeAttribute","Node","replaceChildren","nodes","textContent","append","rootScope","getProxiedManagers","div","body","getElementById","href","singleInstance","visualViewport","lastVH","setViewportVH","setVH","vh","overlayCounter","height","innerHeight","toggleResizeMode","tabId","onImTabChange","wasTabId","tagName","appMediaViewer","perf","langPromise","stateResult","langPack","fadeInWhenFontsReady","elem","promise","opacity","state","isPremium","appVersion","lang_code","log","hash","tgWebAuthToken","data","token","dcId","tgWebAuthDcId","userId","tgWebAuthUserId","toUserId","isTest","tgWebAuthTest","tgAddr","tgaddr","urlSearchParams","URLSearchParams","set","delete","pagePromise","placeholder","prepend","cloneNode","meModule","pushModule","setAuthorized","forceUnsubscribe","mount","sentCode","authCode","pause","ready","reload","close","DEBUG_MANAGER_REQUESTS","createProxyProxy","proxied","ack","get","receiver","method","has","warn","createProxy","acknowledged","IDB","db","storageIsAvailable","openDatabase","INSTANCES","isAvailable","createNew","openDbPromise","createIndexes","os","store","indexNames","from","indexName","deleteIndex","indexes","index","createIndex","keyPath","objectParameters","request","indexedDB","open","reject","message","finished","onerror","onsuccess","result","calledNew","onclose","onabort","transaction","onversionchange","onupgradeneeded","oldVersion","newVersion","stores","objectStoreNames","objectStore","createObjectStore","static","find","instance","preserve","storage","IDBStorage","storeName","idb","create","entryName","getObjectStore","clear","save","idx","put","mode","onError","timeout","onComplete","results","requests","waitForTransactionComplete","oncomplete","callbackResult","left","onRequestFinished","getAll","UNSUPPORTED_LANG_PACK_KEY","I18n","pluralRules","cacheLangPackPromise","setLangCode","langCode","lastRequestedLangCode","lastRequestedNormalizedLangCode","updateAmPm","dateTimeFormat","getDateTimeFormat","hour","minute","hour12","date","setHours","amText","format","amPmCache","am","pmText","pm","loadLocalLangPack","defaultCode","lang","langSign","countries","strings","formatLocalStrings","saveLangPack","from_version","local","loadLangPack","web","requestedServerLanguage","managers","apiManager","invokeApiCacheable","lang_pack","polyfillPromise","pushTo","applyLangPack","currentLangCode","Intl","PluralRules","string","countriesList","country","langPackKey","default_name","lastAppliedLangCode","cachedDateTimeFormats","querySelectorAll","element","weakMap","update","superFormatter","indexHolder","out","lastIndex","p1","p2","p3","p4","lastIndexOf","wrappedUrl","onclick","DocumentFragment","firstChild","arg","pushNextArgument","plain","str","select","Map","getCacheLangPack","finally","setTimeFormat","haveToUpdate","IntlDateElement","getStrings","getLangPack","langPack1","langPack2","localLangPack1","localLangPack2","_Intl","WeakMap","IntlElementBase","options","property","IntlElement","formatted","dataset","compareAndUpdate","json","JSON","stringify","DateTimeFormat","hours","getHours","getMinutes","i18n","i18n_","_i18n","joinElementsWith","elements","joiner","isLast","useLast","joined","NULL_PEER_ID","REPLIES_PEER_ID","REPLIES_HIDDEN_CHANNEL_ID","SERVICE_PEER_ID","MUTE_UNTIL","BOT_START_PARAM","MAX_FILE_SAVE_SIZE","THUMB_TYPE_FULL","FOLDER_ID_ALL","FOLDER_ID_ARCHIVE","REAL_FOLDERS","IS_CALL_SUPPORTED","IS_CANVAS_FILTER_SUPPORTED","IS_EMOJI_SUPPORTED","IS_GEOLOCATION_SUPPORTED","IS_GROUP_CALL_SUPPORTED","IS_MOV_SUPPORTED","IS_PARALLAX_SUPPORTED","IS_SCREEN_SHARING_SUPPORTED","IS_TOUCH_SUPPORTED","IS_VIBRATE_SUPPORTED","IS_OPUS_SUPPORTED","IS_SHARED_WORKER_SUPPORTED","IS_WEBM_SUPPORTED","IS_WEBP_SUPPORTED","IS_WEBRTC_SUPPORTED","MEDIA_MIME_TYPES_SUPPORTED","ALL_KEYS","REFRESH_KEYS","loadStateInner","logger","totalPerf","recordPromise","stateStorage","sessionStorage","pushedKeys","pushToState","copy","splice","auth","shift","sessionBuild","shiftedWebKAuth","values","dcID","toPeerId","obj","resetStorages","chats","dialogs","users","_state","state_id","time","nightTheme","autoDownloadSettings","oldTypes","mediaType","peerTypeSettings","peerType","validateInitObject","missingKey","migrated","newTheme","k_build","ApiManagerProxy","onMirrorTask","payload","mirrors","mirror","tabState","chatPeerIds","idleStartTime","registerWorker","registerServiceWorker","registerCryptoWorker","addMultipleEventsListeners","convertWebp","fileName","bytes","webpWorkerController","convertOpus","opusDecodeController","localStorageProxy","storageTask","language","toggleStorages","telegramMeWebManager","webPushApiManager","cacheName","caches","appRuntimeManager","idleController","updateTabStateIdle","invoke","pingServiceWorkerWithIframe","pingServiceWorkerPromise","iframe","hidden","onLoad","remove","src","random","attachServiceWorker","serviceWorker","lastServiceWorker","serviceMessagePort","detachPort","attachSendPort","invokeVoid","_registerServiceWorker","register","URL","scope","registration","active","controller","unregister","installing","waiting","worker","attachListenPort","port","source","ports","hello","resendLockTask","originals","originalUrl","createWorker","attachWorkerToPort","cryptoMessagePort","blob","fetch","response","pathnameSplitted","pathname","origin","Blob","onWorkerFirstMessage","messagePort","attachPort","loadState","sendState","invokeCrypto","enabled","clearWrite","getMirror","getState","updateTabState","apiManagerProxy","IS_MULTIPLE_TABS_SUPPORTED","SingleInstance","clearInstance","masterInstance","deactivated","checkInstance","newInstance","instanceId","curInstance","deactivateInstance","xt_instance","clearDeactivateTimeout","deactivateTimeout","deactivatedReason","start","reset","started","setInterval","activateInstance","reason","TelegramMeWebManager","disabled","hostname","canRedirect","curValue","ts","tsNow","tgme_sync","path","encodeURIComponent","script","onload","appendChild","loadScript","WebPushApiManager","isPushEnabled","localNotificationsAvailable","isFirefox","userVisibleOnly","subscribe","reg","pushManager","subscription","pushSubscriptionNotify","Notification","permission","isAliveNotify","baseUrl","ACTIONS_LANG_MAP","push_action_mute1d","push_action_settings","push_message_nopreview","action","localNotifications","isAliveTO","getSubscription","setUpServiceWorkerChannel","setLocalNotificationsDisabled","unsubscribe","successful","setSettings","newSettings","hidePushNotifications","subscriptionObj","toJSON","endpoint","p256dh","tokenType","tokenValue","sampleRate","tasks","keepAlive","isPlaySupported","loadWavWorker","wavWorker","page","onTaskEnd","loadWorker","command","waveform","buffers","typedArray","buffer","setKeepAlive","terminateWorkers","task","executeNewTask","kill","terminate","decoderSampleRate","outputBufferSampleRate","wavBitDepth","wavSampleRate","pages","withWaveform","pushDecodeTask","decode","dataBlob","ALPHA_CHARS_REG_EXP","URL_ALPHANUMERIC_REG_EXP_PART","URL_PROTOCOL_REG_EXP_PART","URL_REG_EXP","URL_ANY_PROTOCOL_REG_EXP","RegExp","FULL_REG_EXP","EMAIL_REG_EXP","MARKDOWN_REG_EXP","SITE_HASHTAGS","MARKDOWN_ENTITIES","PASS_CONFLICTING_ENTITIES","PHONE_NUMBER_REG_EXP","RootScope","myId","connectionStatus","premium","allDispatch","status","getConnectionStatus","getPremium","dispatchEventSingle","convertPromises","init","convert","convertPromise","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","getter","__esModule","getPrototypeOf","ns","def","getOwnPropertyNames","definition","defineProperty","enumerable","chunkId","reduce","miniCssF","globalThis","Function","prop","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","onScriptComplete","prev","doneFns","parentNode","removeChild","toStringTag","scriptUrl","importScripts","currentScript","retries","realSrc","cacheBust","baseURI","self","installedChunks","installedChunkData","errorType","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}